{"files":[{"id":"98e8556c-48ad-4f31-9f7c-d0cceb494dad","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Singapore\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"c6f34176-4f2f-4ff9-8c94-b18bbd5c6c98","name":"CSS","type":"html","source":"\u003cstyle\u003e\nbody {\n    font-family: \u0027Poppins\u0027, Arial, sans-serif;\n    margin: 0;\n    padding: 0;\n    background-color: #f4f4f4;\n    color: #333;\n    display: flex;\n    flex-direction: column;\n    min-height: 100vh;\n}\n\nheader {\n    background-color: #ffffff;\n    padding: 1.5em 2em;\n    text-align: center;\n    height: auto;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    position: relative;\n}\n\nheader h1 {\n    margin: 0;\n    font-size: 2.2em;\n    font-weight: 300;\n    color: #2c3e50;\n    letter-spacing: 3px;\n    text-transform: uppercase;\n    text-align: center;\n    padding-left: 200px; /* Adjust this value to move the text more or less to the right */\n}\n\nheader::after {\n    content: \u0027\u0027;\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    height: 3px;\n    background: linear-gradient(to right, #3498db, #2980b9);\n}\n\nnav {\n    background-color: #2c3e50;\n    position: fixed;\n    left: 0;\n    top: 0;\n    height: 100%;\n    width: 200px;\n    padding-top: 80px; /* Adjust padding to match the header height */\n    overflow-x: hidden;\n}\n\nnav ul {\n    list-style: none;\n    padding: 0;\n    margin: 0;\n    display: flex;\n    flex-direction: column;\n}\n\nnav ul li {\n    margin: 0;\n}\n\nnav ul li a {\n    color: #ecf0f1;\n    text-decoration: none;\n    padding: 12px 15px;\n    display: block;\n    text-align: left;\n    font-size: 0.95em;\n    border-radius: 5px;\n    transition: all 0.3s ease;\n}\n\nnav ul li a:hover {\n    background-color: #34495e;\n    color: #3498db;\n}\n\n\n\nmain {\n    padding: 1em;\n    margin-left: 200px;\n    padding-top: 20px;\n    flex: 1 0 auto; /* Add top padding to make space for the header */\n}\n\nh2 {\n    color: #2c3e50;\n}\n\nh1 {\n    margin: 0;\n    font-size: 23px;\n    font-weight: 300;\n    color: #2c3e50;\n    letter-spacing: 3px;\n}\n\ntable {\n    width: 100%;\n    border-collapse: collapse;\n    margin-bottom: 1em;\n    border: 1px solid #ddd;\n    background-color: white;\n    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n    font-size: 12px;\n}\n\nth, td {\n    padding: 1em;\n    text-align: left;\n    border-bottom: 1px solid #ddd;\n}\n\nth {\n    background-color: #f4f4f4;\n    color: #333;\n    font-weight: bold;\n    text-transform: uppercase;\n}\n\ntr:nth-child(even) {\n    background-color: #f9f9f9;\n}\n\ntr:hover {\n    background-color: #f0f0f0;\n}\n.form-group {\n    margin-bottom: 1em;\n}\n\nlabel {\n    display: block;\n    margin-bottom: 0.5em;\n}\n\ninput[type\u003d\"text\"],\ninput[type\u003d\"number\"],\ninput[type\u003d\"number\"],\nbutton {\n    width: 30%;\n    padding: 0.5em;\n    margin-bottom: 1em;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n}\n\nbutton {\n    background-color: #4CAF50;\n    color: white;\n    border: none;\n    cursor: pointer;\n}\n\nbutton:hover {\n    background-color: #45a049;\n}\n\nfooter {\n    background-color: #f8f9fa;\n    color: #6c757d;\n    text-align: center;\n    padding: 0.35em 0;\n    width: 100%;\n    border-top: 1px solid #dee2e6;\n    font-size: 0.8em;\n    font-family: Arial, sans-serif;\n    flex-shrink: 0;\n}\n\nfooter a {\n    color: #007bff;\n    text-decoration: none;\n    transition: color 0.2s ease;\n}\n\nfooter a:hover {\n    color: #0056b3;\n    text-decoration: underline;\n}\n.modal-content {\n    background-color: white;\n    margin: 15% auto;\n    padding: 20px;\n    border: 1px solid #888;\n    width: 80%;\n}\n\n.close {\n    color: #aaa;\n    float: right;\n    font-size: 28px;\n    font-weight: bold;\n}\n\n.close:hover,\n.close:focus {\n    color: black;\n    text-decoration: none;\n    cursor: pointer;\n}\n\n#transaction-modal {\n    display: none;\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.5);\n    z-index: 1000;\n    overflow: auto;\n}\n\n.modal-content {\n    position: absolute;\n    top: 20%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    background-color: #fff;\n    border: 1px solid #ccc;\n    padding: 20px;\n    max-width: 80%;\n    max-height: 80%;\n    overflow-y: auto;\n}\n\n      th {\n        cursor: pointer;\n      }\n      th.sorted-asc::after {\n        content: \" \\u25B2\"; /* Up arrow */\n      }\n      th.sorted-desc::after {\n        content: \" \\u25BC\"; /* Down arrow */\n      }\n\n      /* Navigation style */\n    .tab-container {\n      display: flex;\n      border-bottom: 2px solid #ccc;\n      margin-bottom: 10px;\n    }\n\n    .tab {\n      padding: 10px 20px;\n      cursor: pointer;\n      border: 1px solid #ccc;\n      border-bottom: none;\n      background-color: #f1f1f1;\n      margin-right: 5px;\n      transition: background-color 0.3s ease;\n    }\n\n    .tab:hover {\n      background-color: #ddd;\n    }\n\n    .tab.active {\n      background-color: #fff;\n      border-bottom: 2px solid #00aaff;\n      font-weight: bold;\n    }\n\n      input[type\u003d\"date\"] {\n    font-family: Arial, sans-serif;\n    font-size: 14px;\n    padding: 8px;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    width: 200px; /* Adjust the width as needed */\n    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);\n}\n\n\n#store-in-record {\n    max-width: 600px;\n    margin: 20px auto;\n    padding: 20px;\n    background-color: #fff;\n    border: 1px solid #ccc;\n    border-radius: 5px;\n    box-shadow: 0 2px 5px rgba(0,0,0,0.1);\n    font-family: Arial, sans-serif;\n}\n\n/* Section heading */\n#store-in-record h2 {\n    font-size: 1.8em;\n    color: #333;\n    margin-bottom: 20px;\n    text-align: center;\n}\n\n/* Label for inputs */\n#store-in-record label {\n    display: block;\n    margin-top: 10px;\n    font-weight: bold;\n    color: #555;\n}\n\n/* Input fields */\n#store-in-record input[type\u003d\"date\"],\n#store-in-record input[type\u003d\"text\"],\n#store-in-record input[type\u003d\"number\"] {\n    width: calc(100% - 20px);\n    padding: 8px;\n    margin-top: 4px;\n    margin-bottom: 10px;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-sizing: border-box;\n    outline: none;\n    transition: border-color 0.2s ease-in-out;\n}\n\n/* Input field focus styling */\n#store-in-record input[type\u003d\"date\"]:focus,\n#store-in-record input[type\u003d\"text\"]:focus,\n#store-in-record input[type\u003d\"number\"]:focus {\n    border-color: #66afe9;\n}\n\n/* Button styling */\n#store-in-record button {\n    display: block;\n    width: 100%;\n    padding: 10px;\n    margin-top: 20px;\n    background-color: #4CAF50;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 1em;\n    transition: background-color 0.3s;\n}\n\n/* Button hover effect */\n#store-in-record button:hover {\n    background-color: #45a049;\n}\n\n/* Selected item details styling */\n#store-in-selected-item-details {\n    margin-top: 20px;\n    padding: 15px;\n    background-color: #f0f0f0;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n}\n\n/* Selected item heading */\n#store-in-selected-item-details h3 {\n    font-size: 1.3em;\n    color: #333;\n    margin-bottom: 10px;\n    text-align: center;\n}\n\n/* Selected item details paragraphs */\n#store-in-selected-item-details p {\n    margin: 8px 0;\n}\n/* Adding some margin to the bottom of the element */\ninput[type\u003d\"date\"] {\n    margin-bottom: 10px;\n}\n\n    textarea {\n      resize: none; /* Disable resizing */\n      width: 300px; /* Set a fixed width */\n      height: 100px; /* Set a fixed height */\n    }\n\n  #drawing-out-record {\n    max-width: 600px;\n    margin: 20px auto;\n    padding: 20px;\n    background-color: #fff;\n    border: 1px solid #ccc;\n    border-radius: 5px;\n    box-shadow: 0 2px 5px rgba(0,0,0,0.1);\n    font-family: Arial, sans-serif;\n  }\n\n  /* Section heading */\n  #drawing-out-record h2 {\n    font-size: 1.8em;\n    color: #333;\n    margin-bottom: 20px;\n    text-align: center;\n  }\n\n  /* Label for inputs */\n  #drawing-out-record label {\n    display: block;\n    margin-top: 10px;\n    font-weight: bold;\n    color: #555;\n  }\n\n  /* Input fields */\n  #drawing-out-record input[type\u003d\"date\"],\n  #drawing-out-record input[type\u003d\"number\"] {\n    width: calc(100% - 20px);\n    padding: 8px;\n    margin-top: 4px;\n    margin-bottom: 10px;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-sizing: border-box;\n    outline: none;\n    transition: border-color 0.2s ease-in-out;\n  }\n\n  /* Input field focus styling */\n  #drawing-out-record input[type\u003d\"date\"]:focus,\n  #drawing-out-record input[type\u003d\"number\"]:focus {\n    border-color: #66afe9;\n  }\n\n  /* Button styling */\n  #drawing-out-record button {\n    display: block;\n    width: 100%;\n    padding: 10px;\n    margin-top: 20px;\n    background-color: #4CAF50;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 1em;\n    transition: background-color 0.3s;\n  }\n\n  /* Button hover effect */\n  #drawing-out-record button:hover {\n    background-color: #45a049;\n  }\n\n  /* Selected item details styling */\n  #selected-item-details {\n    margin-top: 20px;\n    padding: 15px;\n    background-color: #f0f0f0;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n  }\n\n  /* Selected item heading */\n  #selected-item-details h3 {\n    font-size: 1.3em;\n    color: #333;\n    margin-bottom: 10px;\n    text-align: center;\n  }\n\n  /* Selected item details paragraphs */\n  #selected-item-details p {\n    margin: 8px 0;\n  }\n\n/* CSS for Report section */\n#report {\n    max-width: 800px;\n    margin: 20px auto;\n    padding: 20px;\n    background-color: #fff;\n    border: 1px solid #ccc;\n    border-radius: 5px;\n    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\n    font-family: Arial, sans-serif;\n}\n\n#report h2 {\n    font-size: 1.8em;\n    color: #333;\n    margin-bottom: 20px;\n    text-align: center;\n}\n\n.report-options {\n    margin-top: 20px;\n}\n\n.report-option {\n    text-align: center;\n    padding: 15px 20px;\n    background-color: #f0f0f0;\n    border: 1px solid #ccc;\n    border-radius: 5px;\n    cursor: pointer;\n    transition: background-color 0.3s;\n    display: block;\n    margin-bottom: 10px; /* Space between each option */\n}\n\n.report-option:hover {\n    background-color: #e0e0e0;\n}\n\n.report-option span {\n    font-size: 1.2em;\n    color: #555;\n    display: block;\n}\n\n.report-option:active {\n    transform: translateY(1px);\n    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n}\n\n.report-option.selected {\n            background-color: #444; /* Dark grey background for selected option */\n            color: white;\n        }\n\n        .report-option.selected span {\n            color: white;\n        }\n\n/* CSS for Store In Record section */\n#store-in-record {\n    width: 1000px;\n    margin: 20px auto;\n    padding: 20px;\n    background-color: #fff;\n    border: 1px solid #ccc;\n    border-radius: 5px;\n    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\n    font-family: Arial, sans-serif;\n}\n\n#store-in-record h2 {\n    font-size: 1.8em;\n    color: #333;\n    margin-bottom: 20px;\n    text-align: center;\n}\n\n#store-in-record h3 {\n    font-size: 1.4em;\n    color: #555;\n    margin-bottom: 10px;\n    text-align: center;\n}\n\n#store-in-record textarea {\n    width: calc(100% - 20px);\n    padding: 10px;\n    margin-top: 8px;\n    margin-bottom: 15px;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-sizing: border-box;\n    outline: none;\n    transition: border-color 0.2s ease-in-out;\n    resize: vertical;\n}\n\n#store-in-record label {\n    display: block;\n    margin-top: 10px;\n    font-weight: bold;\n    color: #555;\n}\n\n#store-in-record input[type\u003d\"date\"],\n#store-in-record input[type\u003d\"text\"] {\n    width: calc(100% - 20px);\n    padding: 10px;\n    margin-top: 8px;\n    margin-bottom: 15px;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-sizing: border-box;\n    outline: none;\n    transition: border-color 0.2s ease-in-out;\n}\n\n#store-in-record input[type\u003d\"date\"]:focus,\n#store-in-record input[type\u003d\"text\"]:focus,\n#store-in-record textarea:focus {\n    border-color: #66afe9;\n}\n\n#store-in-table-body {\n    padding: 10px;\n    background-color: #f0f0f0;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    margin-top: 15px;\n    min-height: 150px;\n    overflow-y: auto;\n}\n\n#store-in-record button {\n    display: block;\n    width: 100%;\n    padding: 10px;\n    margin-top: 20px;\n    background-color: #4CAF50;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 1em;\n    transition: background-color 0.3s;\n}\n\n#store-in-record button:hover {\n    background-color: #45a049;\n}\n\n/* CSS for Inventory section */\n#inventory {\n    width: 1000px;\n    margin: 20px auto;\n    padding: 20px;\n    background-color: #fff;\n    border: 1px solid #ccc;\n    border-radius: 5px;\n    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\n    font-family: Arial, sans-serif;\n}\n#inventory #groupButton {\n    display: inline-block; /* Change display to inline-block */\n    width: auto; /* Adjust width as needed */\n    padding: 10px 20px; /* Add padding to control button size */\n    background-color: #4CAF50;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 1em;\n    margin-bottom: 15px;\n}\n\n#inventory h2 {\n    font-size: 1.8em;\n    color: #333;\n    margin-bottom: 20px;\n    text-align: center;\n}\n\n#inventory label {\n    font-size: 1.1em;\n    color: #555;\n    margin-bottom: 10px;\n    display: block;\n}\n\n#inventory #search-input {\n    width: 100%;\n    padding: 10px;\n    margin-bottom: 15px;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-sizing: border-box;\n    font-size: 1em;\n}\n\n#inventory #groupButton {\n    display: block;\n    width: 100%;\n    padding: 10px;\n    background-color: #4CAF50;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 1em;\n    margin-bottom: 15px;\n}\n\n#inventory #groupButton:hover {\n    background-color: #45a049;\n}\n\n#inventory-table {\n    width: 100%;\n    border-collapse: collapse;\n    margin-top: 20px;\n}\n\n#inventory-table th, #inventory-table td {\n    padding: 12px;\n    text-align: left;\n    border-bottom: 1px solid #ddd;\n}\n\n#inventory-table th {\n    background-color: #f2f2f2;\n    color: #333;\n}\n\n#inventory-table tbody tr:nth-child(even) {\n    background-color: #f9f9f9;\n}\n\n#inventory-table tbody tr:hover {\n    background-color: #f0f0f0;\n}\n\n\n\n\u003c/style\u003e"},{"id":"2687ab66-53c3-41c4-a0b3-f95f379d8d81","name":"Code","type":"server_js","source":"function doGet(e) {\n  let page \u003d e \u0026\u0026 e.parameter.mode ? e.parameter.mode : \"Index\";\n  let html \u003d HtmlService.createTemplateFromFile(page).evaluate();\n  let htmlContent \u003d html.getContent();\n  let metaTag \u003d \u0027\u003cmeta name\u003d\"viewport\" content\u003d\"width\u003ddevice-width, initial-scale\u003d1.0\"\u003e\u0027;\n\n  htmlContent \u003d htmlContent.replace(\u0027\u003chead\u003e\u0027, `\u003chead\u003e${metaTag}`);\n  htmlContent \u003d htmlContent.replace(\"{{NAVBAR}}\", getNavbar(page));\n  let htmlOutput \u003d HtmlService.createHtmlOutput(htmlContent);\n  htmlOutput.setTitle(\"Inventory Management System\");\n  return htmlOutput;\n}\n\n\n\nfunction getNavbar(activePage) {\n  const scriptURLHome \u003d getScriptURL();\n  const scriptURLInventory \u003d getScriptURL(\"mode\u003dInventory\");\n  const scriptURLTransaction \u003d getScriptURL(\"mode\u003dTransaction\");\n  const scriptURLShipment \u003d getScriptURL(\"mode\u003dShipment\");\n  const scriptURLSettings \u003d getScriptURL(\"mode\u003dsettings\");\n  const scriptURLLineage \u003d getScriptURL(\"mode\u003dLineage\");\n  const scriptURLPackaging \u003d getScriptURL(\"mode\u003dPackaging\");\n  const scriptURLOrder \u003d getScriptURL(\"mode\u003dOrder\");\n  const scriptURLReport \u003d getScriptURL(\"mode\u003dReport\");\n  const scriptURLTempRcd \u003d getScriptURL(\"mode\u003dTempRcd\");\n  const scriptURLSL \u003d getScriptURL(\"mode\u003dSL\");\n  const scriptURLMaintenance \u003d getScriptURL(\"mode\u003dMaintenance\");\n\n\n  return `\n    \u003cnav\u003e\n      \u003cdiv class\u003d\"nav-container\"\u003e\n        \u003cul\u003e\n          \u003cli\u003e\u003ca href\u003d\"${scriptURLHome}\" class\u003d\"${activePage \u003d\u003d\u003d \u0027Index\u0027 ? \u0027active\u0027 : \u0027\u0027}\"\u003eDashboard\u003c/a\u003e\u003c/li\u003e\n          \u003cli\u003e\u003ca href\u003d\"${scriptURLInventory}\" class\u003d\"${activePage \u003d\u003d\u003d \u0027Inventory\u0027 ? \u0027active\u0027 : \u0027\u0027}\"\u003eInventory\u003c/a\u003e\u003c/li\u003e\n          \u003cli\u003e\u003ca href\u003d\"${scriptURLShipment}\" class\u003d\"${activePage \u003d\u003d\u003d \u0027Shipment\u0027 ? \u0027active\u0027 : \u0027\u0027}\"\u003eShipments\u003c/a\u003e\u003c/li\u003e\n          \u003cli\u003e\u003ca href\u003d\"${scriptURLOrder}\" class\u003d\"${activePage \u003d\u003d\u003d \u0027Order\u0027 ? \u0027active\u0027 : \u0027\u0027}\"\u003eOrder\u003c/a\u003e\u003c/li\u003e\n          \u003cli\u003e\u003ca href\u003d\"${scriptURLLineage}\" class\u003d\"${activePage \u003d\u003d\u003d \u0027Lineage\u0027 ? \u0027active\u0027 : \u0027\u0027}\"\u003eLineage\u003c/a\u003e\u003c/li\u003e\n          \u003cli\u003e\u003ca href\u003d\"${scriptURLSL}\" class\u003d\"${activePage \u003d\u003d\u003d \u0027SL\u0027 ? \u0027active\u0027 : \u0027\u0027}\"\u003eSing Long\u003c/a\u003e\u003c/li\u003e\n          \u003cli\u003e\u003ca href\u003d\"${scriptURLPackaging}\" class\u003d\"${activePage \u003d\u003d\u003d \u0027Packaging\u0027 ? \u0027active\u0027 : \u0027\u0027}\"\u003ePackaging Material\u003c/a\u003e\u003c/li\u003e\n          \u003cli\u003e\u003ca href\u003d\"${scriptURLTempRcd}\" class\u003d\"${activePage \u003d\u003d\u003d \u0027TempRcd\u0027 ? \u0027active\u0027 : \u0027\u0027}\"\u003eColdroom Temperature\u003c/a\u003e\u003c/li\u003e\n          \u003cli\u003e\u003ca href\u003d\"${scriptURLMaintenance}\" class\u003d\"${activePage \u003d\u003d\u003d \u0027Maintenance\u0027 ? \u0027active\u0027 : \u0027\u0027}\"\u003eService Record\u003c/a\u003e\u003c/li\u003e\n          \u003cli\u003e\u003ca href\u003d\"${scriptURLReport}\" class\u003d\"${activePage \u003d\u003d\u003d \u0027Report\u0027 ? \u0027active\u0027 : \u0027\u0027}\"\u003eReport\u003c/a\u003e\u003c/li\u003e\n        \u003c/ul\u003e\n      \u003c/div\u003e\n    \u003c/nav\u003e`;\n}\n\nfunction getScriptURL(qs \u003d null) {\n  let url \u003d ScriptApp.getService().getUrl();\n  if (qs) {\n    url +\u003d qs.indexOf(\"?\") \u003d\u003d\u003d -1 ? \"?\" + qs : qs;\n  }\n  return url;\n}\n\n\n//INCLUDE HTML PARTS, EG. JAVASCRIPT, CSS, OTHER HTML FILES\nfunction include(filename) {\n  return HtmlService.createHtmlOutputFromFile(filename).getContent();\n  \n}\n\nfunction getSheetNames() {\n  const spreadsheetId \u003d \u00271JjXIxCMKWN3Z9xhLHa4HHoxK4cx48Ex5iUz4vx4TjMs\u0027;\n  const sheets \u003d SpreadsheetApp.openById(spreadsheetId).getSheets();\n  const sheetNames \u003d sheets.map(sheet \u003d\u003e sheet.getName());\n  \n  // Get the last 30 sheet names\n  return sheetNames.slice(-30);\n}\n\nfunction getInventory(sheetName) {\n  const spreadsheetId \u003d \u00271JjXIxCMKWN3Z9xhLHa4HHoxK4cx48Ex5iUz4vx4TjMs\u0027;\n  const sheet \u003d SpreadsheetApp.openById(spreadsheetId).getSheetByName(sheetName);\n  \n  if (!sheet) {\n    throw new Error(\u0027Sheet not found: \u0027 + sheetName);\n  }\n\n  const data \u003d sheet.getRange(3, 1, sheet.getLastRow() - 2, sheet.getLastColumn()).getValues();\n  return data.map(row \u003d\u003e ({\n    id: row[1],\n    name: row[2],\n    category: row[3],\n    packing: row[5],\n    quantity: row[6]\n  }));\n}\n\nfunction getTransactions(itemId) {\n  const sheet \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027Transactions\u0027);\n  const data \u003d sheet.getDataRange().getValues();\n  const headers \u003d data[0];\n  const transactions \u003d data.slice(1).filter(row \u003d\u003e row[headers.indexOf(\u0027ItemID\u0027)] \u003d\u003d itemId);\n\n  return transactions.map(row \u003d\u003e ({\n    date: row[headers.indexOf(\u0027Date\u0027)],\n    quantity: row[headers.indexOf(\u0027Quantity\u0027)],\n    type: row[headers.indexOf(\u0027Type\u0027)]\n  }));\n}\n\n\n\n\nfunction addItem(item) {\n  const sheet \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027Inventory\u0027);\n  sheet.appendRow([item.id, item.name, item.category, item.quantity, item.price]);\n}\n\nfunction deleteItem(id) {\n  const sheet \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027Inventory\u0027);\n  const data \u003d sheet.getDataRange().getValues();\n  for (let i \u003d 1; i \u003c data.length; i++) {\n    if (data[i][0] \u003d\u003d id) {\n      sheet.deleteRow(i + 1);\n      break;\n    }\n  }\n}\n\n\nfunction getTransactions(itemId) {\n  // Replace the spreadsheet ID below with your actual spreadsheet ID\n  var spreadsheetId \u003d \u002715jj7ZQgL1fIPsHr-kl3s2Quy7TrLsjQ-sjV4-lcus8o\u0027;\n  var sheetName1 \u003d \u0027InventoryTranscationRecord\u0027;  // Existing sheet name\n  var sheetName2 \u003d \u0027CR5 transfer to PR\u0027;      // New sheet name\n\n  // Get data from the first sheet (InventoryTranscationRecord)\n  var sheet1 \u003d SpreadsheetApp.openById(spreadsheetId).getSheetByName(sheetName1);\n  var data1 \u003d sheet1.getDataRange().getValues();\n\n  // Get data from the second sheet (Blk15 unbox Carton STM)\n  var sheet2 \u003d SpreadsheetApp.openById(spreadsheetId).getSheetByName(sheetName2);\n  var data2 \u003d sheet2.getDataRange().getValues();\n  \n  // Prepare arrays to hold transactions\n  var transactions1 \u003d [];\n  var transactions2 \u003d [];\n  \n  // Helper function to format date\n  function formatDate(rawDate) {\n    // Assuming rawDate is in Singapore time\n    var singaporeTimeZone \u003d \u0027GMT+08:00\u0027;  // Singapore time zone offset\n    \n    // Convert rawDate to Date object and adjust for Singapore time zone\n    var date \u003d new Date(rawDate + \u0027 \u0027 + singaporeTimeZone);\n    \n    // Format the date\n    var formattedDate \u003d Utilities.formatDate(date, singaporeTimeZone, \u0027dd/MM/yyyy\u0027);\n    \n    return formattedDate;\n  }\n  \n  // Process transactions from the first sheet (InventoryTranscationRecord)\n  for (var i \u003d 1; i \u003c data1.length; i++) { // Start from 1 to skip header row\n    var row \u003d data1[i];\n    \n    // Check if the item ID matches in the first sheet\n    if (row[4] \u003d\u003d itemId) { // Assuming item ID is in the fifth column (E)\n      // Format the date\n      var formattedDate \u003d formatDate(row[7]); // Assuming date is in the eighth column (H)\n      \n      var transaction \u003d {\n        date: formattedDate,\n        from: row[2],       // Assuming \u0027from\u0027 is in the third column (C)\n        to: row[3],         // Assuming \u0027to\u0027 is in the fourth column (D)\n        quantity: row[1]    // Assuming \u0027quantity\u0027 is in the second column (B)\n      };\n      \n      transactions1.push(transaction);\n    }\n  }\n\n  // Process transactions from the second sheet (Blk15 unbox Carton STM)\n  for (var j \u003d 1; j \u003c data2.length; j++) { // Start from 1 to skip header row\n    var row2 \u003d data2[j];\n    \n    // Check if the item ID matches in the second sheet\n    if (row2[0] \u003d\u003d itemId) { // Assuming item ID is in the first column (A)\n      // Format the date\n      var formattedDate2 \u003d formatDate(row2[3]); // Assuming date is in the seventh column (G)\n      \n      var transaction2 \u003d {\n        date: formattedDate2,\n        quantity: row2[5]   // Assuming \u0027quantity\u0027 is in the ninth column (I)\n      };\n      \n      transactions2.push(transaction2);\n    }\n  }\n  \n  // Return both sets of transactions\n  return { transactions1: transactions1, transactions2: transactions2 };\n}\n\n\n// Load SheetJS library code directly into Apps Script\neval(UrlFetchApp.fetch(\u0027https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js\u0027).getContentText());\n\nfunction processExcel(fileData) {\n  try {\n    var bytes \u003d Utilities.base64Decode(fileData.split(\u0027,\u0027)[1]); // Decode base64 data\n    var workbook \u003d XLSX.read(bytes, { type: \u0027array\u0027 }); // Parse Excel file\n\n    // Assume the first sheet is the target\n    var firstSheetName \u003d workbook.SheetNames[0];\n    var worksheet \u003d workbook.Sheets[firstSheetName];\n\n    // Convert worksheet to JSON format starting from row 6\n    var jsonData \u003d XLSX.utils.sheet_to_json(worksheet, { header: 1, range: 5 }); // Start from row 6 (0-based index)\n\n    // Extract rows 1 to 5 separately (if needed for header/introductory information)\n\n    var rows1to5 \u003d [];\n    for (var r \u003d 0; r \u003c 5; r++) {\n      var row \u003d [];\n      for (var c in jsonData[r]) {\n        row.push({ column: c, value: jsonData[r][c] });\n      }\n      rows1to5.push(row);\n    }\n\n    return { headers: jsonData[0], data: jsonData.slice(1), rows1to5: rows1to5 }; // Return headers, data, and rows 1-5 to client-side JavaScript\n  } catch (e) {\n    Logger.log(e.stack || e.toString()); // Log error\n    throw new Error(\u0027Error processing the Excel file: \u0027 + e.message); // Throw error message\n  }\n}\n\n\nfunction updateGoogleSheet(date, itemCode, productDescription, packing, type, expiryBatchNo, grn, lineageItemCode, dateStored, containerNo, quantity, pallet) {\n  try {\n    var ss \u003d SpreadsheetApp.openById(\u00271GQUKpmn6dp0CJRz873w8x0LZf8EyA6xPQ3HPFlh99qs\u0027);\n    var drawOutSheet \u003d ss.getSheetByName(\u0027Draw Out\u0027);\n    \n    if (!drawOutSheet) {\n      throw new Error(\"Sheet \u0027Draw Out\u0027 not found in the spreadsheet\");\n    }\n    \n    // Prepare data to append, with date at the last column\n    var rowData \u003d [itemCode, productDescription, packing, type, expiryBatchNo, grn, lineageItemCode, dateStored, containerNo, quantity, pallet, date];\n    \n    // Update Draw Out sheet\n    drawOutSheet.appendRow(rowData);\n    \n    return \"Successfully updated the \u0027Draw Out\u0027 sheet\";\n  } catch (error) {\n    Logger.log(\"Error in updateGoogleSheet: \" + error.message);\n    return \"Error: \" + error.message;\n  }\n}\n\nfunction updateLineageInventory(sheet, itemCode, lineageItemCode, quantity, pallet) {\n  var data \u003d sheet.getDataRange().getValues();\n  \n  for (var i \u003d 1; i \u003c data.length; i++) {\n    if (data[i][0] \u003d\u003d itemCode \u0026\u0026 data[i][6] \u003d\u003d lineageItemCode) {\n      var balQuantity \u003d sheet.getRange(i+1, 10).getValue();\n      var balPallet \u003d sheet.getRange(i+1, 11).getValue();\n      \n      sheet.getRange(i+1, 10).setValue(balQuantity - parseFloat(quantity));\n      sheet.getRange(i+1, 11).setValue(balPallet - parseFloat(pallet));\n      \n      break;\n    }\n  }\n}\n\n\nfunction storeData(data, storedDate, containerNumber, grn) {\n  var ss \u003d SpreadsheetApp.openById(\u00271GQUKpmn6dp0CJRz873w8x0LZf8EyA6xPQ3HPFlh99qs\u0027);\n  var sheet \u003d ss.getSheetByName(\u0027Stock In\u0027);\n\n  // Check if sheet exists\n  if (!sheet) {\n    console.error(\u0027Sheet \"Stock In\" not found\u0027);\n    return;\n  }\n\n  // Append data to the sheet\n  data.forEach(function(row) {\n    var newRow \u003d [\n      row[0],           // ITEM CODE\n      row[1],           // PRODUCT DESCRIPTION\n      row[2],           // PACKING\n      row[3],           // TYPE\n      row[4],           // Expiry Date / Batch No\n      grn,              // GRN (from function parameter)\n      row[5],           // Lineage Item Code\n      storedDate,       // DATE STORED (from function parameter)\n      containerNumber,  // CONTAINER (from function parameter)\n      row[6],           // Quantity\n      row[7]            // Pallets\n    ];\n\n    sheet.appendRow(newRow);\n    Logger.log(\u0027Row appended: \u0027 + newRow); // Log the appended row for verification\n  });\n\n  Logger.log(\u0027Data stored successfully!\u0027);\n}\n"},{"id":"27a77ed8-bc8c-4d9b-9db8-59b7a7794009","name":"Index","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n    \u003c?!\u003d include(\u0027CSS\u0027); ?\u003e\n     \u003cstyle\u003e\n        body { font-family: \u0027Arial\u0027, sans-serif; margin: 0; padding: 0; background-color: #f0f4f8; }\n        .dashboard { max-width: 1200px; margin: 0 auto; padding: 20px; }\n        .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-top: 20px; }\n        .card { background-color: white; border-radius: 10px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); padding: 20px; }\n        .card h2 { margin-top: 0; color: #2c3e50; }\n        .chart-placeholder { background-color: #ecf0f1; height: 300px; display: flex; justify-content: center; align-items: center; border-radius: 5px; }\n        .metrics {\n    display: flex;\n    justify-content: space-around; /* Changed from space-between */\n    margin-bottom: 20px;\n    max-width: 800px; /* Added to limit overall width */\n    margin-left: auto; /* Center the metrics container */\n    margin-right: auto;\n}\n\n.metric {\n    text-align: center;\n    flex: 0 1 auto; /* Allow shrinking */\n    margin: 0 10px; /* Add some horizontal margin */\n}\n\n.metric-value {\n    font-size: 24px;\n    font-weight: bold;\n    color: black;\n}\n\n.metric-label {\n    font-size: 14px;\n    color: #7f8c8d;\n}\n\n.shipments-list {\n    height: 300px;\n    max-height: 300px;\n    overflow-y: auto;\n    background-color: #ecf0f1;\n    padding: 10px;\n    border-radius: 5px;\n}\n.shipment-item {\n    background-color: #ffffff;\n    border-left: 3px solid #3498db;\n    border-radius: 3px;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    margin-bottom: 10px;\n    padding: 12px;\n    font-size: 0.9em;\n}\n.shipment-header {\n    display: flex;\n    justify-content: space-between;\n    margin-bottom: 8px;\n    border-bottom: 1px solid #eee;\n    padding-bottom: 5px;\n}\n.shipment-no {\n    font-weight: bold;\n    color: #2c3e50;\n}\n.unload-date {\n    color: #e74c3c;\n    font-weight: bold;\n}\n.shipment-details {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 8px;\n}\n.shipment-label {\n    color: #34495e;\n    font-weight: 600;\n}\n.shipment-value {\n    color: #2c3e50;\n}\n@media screen and (max-width: 600px) {\n  .shipment-details {\n    display: flex;\n    flex-direction: column;\n  }\n  .shipment-details \u003e div {\n    display: flex;\n    justify-content: space-between;\n    align-items: baseline;\n    font-size: 14px;\n    margin-bottom: 5px;\n  }\n  .shipment-label {\n    flex: 0 0 auto;\n    margin-right: 10px;\n  }\n  .shipment-details \u003e div \u003e :last-child {\n    flex: 1;\n    word-break: break-word;\n  }\n}\n\n.orders-list {\n            max-height: 300px;\n            height: 300px;\n            overflow-y: auto;\n            background-color: #ecf0f1;\n            padding: 10px;\n            border-radius: 5px;\n        }\n        .order-item {\n            background-color: #ffffff;\n            border-left: 3px solid #3498db;\n            border-radius: 3px;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n            margin-bottom: 10px;\n            padding: 12px;\n            font-size: 0.9em;\n        }\n        .order-header {\n            display: flex;\n            justify-content: space-between;\n            margin-bottom: 8px;\n            border-bottom: 1px solid #eee;\n            padding-bottom: 5px;\n            align-items: center;\n        }\n\n\n.order-no {\n    font-weight: bold;\n    color: #2c3e50;\n}\n.delivery-date {\n    color: #e74c3c;\n    font-weight: bold;\n}\n        .order-details {\n            display: grid;\n            grid-template-columns: repeat(2, 1fr);\n            gap: 8px;\n        }\n        .order-label {\n            color: #34495e;\n            font-weight: 600;\n        }\n        .order-value {\n            color: #2c3e50;\n        }\n\n        .modal {\n            display: none;\n            position: fixed;\n            z-index: 1;\n            left: 0;\n            top: 0;\n            width: 100%;\n            height: 100%;\n            overflow: auto;\n            background-color: rgba(0,0,0,0.4);\n        }\n\n        .modal-content {\n            background-color: #fefefe;\n            margin: 15% auto;\n            padding: 20px;\n            border: 1px solid #888;\n            width: 80%;\n            max-width: 600px;\n        }\n\n        .close {\n            color: #aaa;\n            float: right;\n            font-size: 28px;\n            font-weight: bold;\n        }\n\n        .close:hover,\n        .close:focus {\n            color: black;\n            text-decoration: none;\n            cursor: pointer;\n        }\n\n        .modal-table {\n            width: 100%;\n            border-collapse: collapse;\n        }\n\n        .modal-table th, .modal-table td {\n            border: 1px solid #ddd;\n            padding: 8px;\n            text-align: left;\n        }\n\n        .modal-table th {\n            background-color: #f2f2f2;\n        }\n\u003c/style\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n\n\n    \u003cheader\u003e\n        \u003ch1\u003eInventory Management System\u003c/h1\u003e\n    \u003c/header\u003e\n        {{NAVBAR}}\n\u003cmain\u003e\n        \u003csection id\u003d\"dashboard\"\u003e\n\n    \u003cdiv class\u003d\"metrics\"\u003e\n            \u003cdiv class\u003d\"metric\"\u003e\n                \u003cdiv class\u003d\"metric-value\"\u003e0\u003c/div\u003e\n                \u003cdiv class\u003d\"metric-label\"\u003eIncoming Shipments\u003c/div\u003e\n            \u003c/div\u003e\n            \u003cdiv class\u003d\"metric\"\u003e\n                    \u003cdiv id\u003d\"pending-orders\" class\u003d\"metric-value\"\u003e0\u003c/div\u003e\n                    \u003cdiv class\u003d\"metric-label\"\u003ePending Delivery\u003c/div\u003e\n                \u003c/div\u003e\n            \u003cdiv class\u003d\"metric\"\u003e\n                \u003cdiv class\u003d\"metric-value\"\u003e0\u003c/div\u003e\n                \u003cdiv class\u003d\"metric-label\"\u003eLow Stock Items\u003c/div\u003e\n            \u003c/div\u003e\n            \u003cdiv class\u003d\"metric\"\u003e\n                \u003cdiv class\u003d\"metric-value\"\u003e0%\u003c/div\u003e\n                \u003cdiv class\u003d\"metric-label\"\u003eAvg Warehouse Utilization\u003c/div\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n\n        \u003cdiv class\u003d\"grid\"\u003e\n            \u003cdiv class\u003d\"card\"\u003e\n    \u003ch2\u003eIncoming Shipments\u003c/h2\u003e\n    \u003cdiv id\u003d\"shipments-container\" class\u003d\"shipments-list\"\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\n      \u003cdiv class\u003d\"card\"\u003e\n\u003ch2\u003eIncoming Orders\u003c/h2\u003e\n\u003cdiv id\u003d\"orders-container\" class\u003d\"orders-list\"\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n            \u003cdiv class\u003d\"card\"\u003e\n                \u003ch2\u003eLow Stock Items\u003c/h2\u003e\n                \u003cdiv class\u003d\"chart-placeholder\"\u003e\n\n                \u003c/div\u003e\n            \u003c/div\u003e\n            \u003cdiv class\u003d\"card\"\u003e\n                \u003ch2\u003eWarehouse Utilization\u003c/h2\u003e\n                \u003cdiv class\u003d\"chart-placeholder\"\u003e\n\n                \u003c/div\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n\n\u003cdiv id\u003d\"poModal\" class\u003d\"modal\"\u003e\n      \u003cdiv class\u003d\"modal-content\"\u003e\n        \u003cspan class\u003d\"close\"\u003e\u0026times;\u003c/span\u003e\n        \u003ch2 id\u003d\"modalTitle\"\u003e\u003c/h2\u003e\n        \u003ctable class\u003d\"modal-table\"\u003e\n          \u003cthead\u003e\n            \u003ctr\u003e\n              \u003cth\u003eDescription\u003c/th\u003e\n              \u003cth\u003eQuantity\u003c/th\u003e\n            \u003c/tr\u003e\n          \u003c/thead\u003e\n          \u003ctbody id\u003d\"modalBody\"\u003e\n          \u003c/tbody\u003e\n        \u003c/table\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\n    \u003c/main\u003e\n\n    \u003cfooter\u003e\n        \u003cp\u003e\u0026copy; 2024 Inventory Management System\u003c/p\u003e\n    \u003c/footer\u003e\n\u003c/body\u003e\n\n    \u003c?!\u003d include(\u0027IndexScripts\u0027); ?\u003e\n    \u003cscript\u003e\n\n    \u003c/script\u003e\n \n\u003c/html\u003e\n"},{"id":"41aae884-0ffb-49fb-8f1a-8441435442ef","name":"IndexScripts","type":"html","source":"\u003cscript\u003e\n\n  \n\nfunction displayShipments(shipments) {\n    const container \u003d document.getElementById(\u0027shipments-container\u0027);\n    \n    if (!shipments || shipments.length \u003c\u003d 1) {\n        container.innerHTML \u003d \u0027\u003cp\u003eNo incoming shipments found.\u003c/p\u003e\u0027;\n        updateMetric(\u0027Incoming Shipments\u0027, 0);\n        return;\n    }\n\n    container.innerHTML \u003d \u0027\u0027;\n\n    // Function to get day of week\n    function getDayOfWeek(dateStr) {\n        const days \u003d [\u0027Sun\u0027, \u0027Mon\u0027, \u0027Tue\u0027, \u0027Wed\u0027, \u0027Thu\u0027, \u0027Fri\u0027, \u0027Sat\u0027];\n        const [day, month, year] \u003d dateStr.split(\u0027/\u0027);\n        const date \u003d new Date(year, month - 1, day);\n        return days[date.getDay()];\n    }\n\n    // Skip the header row\n    for (let i \u003d 1; i \u003c shipments.length; i++) {\n        const [shipmentNo, poNo, containerNo, eta, truckingBy, unloadDate] \u003d shipments[i];\n        \n        const dayOfWeek \u003d getDayOfWeek(unloadDate);\n        const formattedUnloadDate \u003d `${unloadDate} ${dayOfWeek}`;\n\n        const shipmentItem \u003d document.createElement(\u0027div\u0027);\n        shipmentItem.className \u003d \u0027shipment-item\u0027;\n        \n        shipmentItem.innerHTML \u003d `\n            \u003cdiv class\u003d\"shipment-header\"\u003e\n                \u003cspan class\u003d\"shipment-no\"\u003e${shipmentNo}\u003c/span\u003e\n                \u003cspan class\u003d\"unload-date\"\u003eUnload Date: ${formattedUnloadDate}\u003c/span\u003e\n            \u003c/div\u003e\n            \u003cdiv class\u003d\"shipment-details\"\u003e\n                \u003cdiv\u003e\u003cspan class\u003d\"shipment-label\"\u003ePO:\u003c/span\u003e ${poNo}\u003c/div\u003e\n                \u003cdiv\u003e\u003cspan class\u003d\"shipment-label\"\u003eContainer:\u003c/span\u003e ${containerNo}\u003c/div\u003e\n                \u003cdiv\u003e\u003cspan class\u003d\"shipment-label\"\u003eETA:\u003c/span\u003e ${eta}\u003c/div\u003e\n                \u003cdiv\u003e\u003cspan class\u003d\"shipment-label\"\u003eTrucking By:\u003c/span\u003e ${truckingBy}\u003c/div\u003e\n            \u003c/div\u003e\n        `;\n        \n        container.appendChild(shipmentItem);\n    }\n\n    updateMetric(\u0027Incoming Shipments\u0027, shipments.length - 1);\n}\n\nfunction updateMetric(label, value) {\n    const metrics \u003d document.querySelectorAll(\u0027.metric\u0027);\n    for (let metric of metrics) {\n        if (metric.querySelector(\u0027.metric-label\u0027).textContent \u003d\u003d\u003d label) {\n            metric.querySelector(\u0027.metric-value\u0027).textContent \u003d value;\n            break;\n        }\n    }\n}\n\nfunction handleShipmentError(error) {\n    console.error(\u0027Error retrieving shipments:\u0027, error);\n    const container \u003d document.getElementById(\u0027shipments-container\u0027);\n    container.innerHTML \u003d \u0027\u003cp\u003eError retrieving shipments. Please try again later.\u003c/p\u003e\u0027;\n}\n\nfunction initializeShipments() {\n    console.log(\u0027Fetching incoming shipments\u0027);\n    document.getElementById(\u0027shipments-container\u0027).innerHTML \u003d \u0027\u003cp\u003eLoading shipments...\u003c/p\u003e\u0027;\n    google.script.run.withSuccessHandler(displayShipments).withFailureHandler(handleShipmentError).IncomingFunction();\n}\n\n\n//Incoming Order\nfunction displayIncomingOrders() {\n    console.log(\u0027Fetching incoming orders\u0027);\n    document.getElementById(\u0027orders-container\u0027).innerHTML \u003d \u0027\u003cp\u003eLoading orders for next 3days...\u003c/p\u003e\u0027;\n    google.script.run.withSuccessHandler(handleOrderSuccess).withFailureHandler(handleOrderError).getAllPO();\n}\n\nfunction handleOrderSuccess(data) {\n    console.log(\u0027Received data from server:\u0027, data);\n    if (data.error) {\n        handleOrderError(data.error);\n    } else {\n        processAndDisplayOrders(data);\n    }\n}\n\nfunction handleOrderError(error) {\n    console.error(\u0027Error occurred:\u0027, error);\n    document.getElementById(\u0027orders-container\u0027).innerHTML \u003d `\u003cp class\u003d\"error-message\"\u003eError fetching orders: ${error}. Please try again later.\u003c/p\u003e`;\n    document.getElementById(\u0027pending-orders\u0027).textContent \u003d \u0027N/A\u0027;\n}\n\nfunction processAndDisplayOrders(data) {\n    console.log(\u0027Processing and displaying orders\u0027);\n    const container \u003d document.getElementById(\u0027orders-container\u0027);\n    container.innerHTML \u003d \u0027\u0027; // Clear existing content\n\n    let totalOrders \u003d 0;\n    let ordersHtml \u003d \u0027\u0027;\n\n    // Combine NTUC Foodfare PO and Foodfare Catering PO\n    const combinedData \u003d {};\n\n    Object.entries(data).forEach(([sheetName, sheetData]) \u003d\u003e {\n        Object.entries(sheetData).forEach(([date, orderInfo]) \u003d\u003e {\n            if (!combinedData[date]) {\n                combinedData[date] \u003d {};\n            }\n            if (sheetName \u003d\u003d\u003d \u0027NTUC Foodfare PO\u0027 || sheetName \u003d\u003d\u003d \u0027Foodfare Catering PO\u0027) {\n                combinedData[date][\u0027NTUC PO\u0027] \u003d (combinedData[date][\u0027NTUC PO\u0027] || 0) + orderInfo.count;\n            } else {\n                combinedData[date][sheetName] \u003d orderInfo.count;\n            }\n            totalOrders +\u003d orderInfo.count;\n        });\n    });\n\n    const poTypes \u003d [\u0027SCORE PO\u0027, \u0027NTUC PO\u0027, \u0027CMM PO\u0027];\n    const poDisplayNames \u003d {\n        \u0027SCORE PO\u0027: \u0027SCORE Order\u0027,\n        \u0027NTUC PO\u0027: \u0027NTUC Order\u0027,\n        \u0027CMM PO\u0027: \u0027CMM Order\u0027\n    };\n\n    Object.entries(combinedData).sort((a, b) \u003d\u003e a[0].localeCompare(b[0])).forEach(([date, poData]) \u003d\u003e {\n        const formattedDate \u003d formatDateWithDayOfWeek(date);\n        \n        poTypes.forEach(poType \u003d\u003e {\n            if (poData[poType] \u0026\u0026 poData[poType] \u003e 0) {\n                ordersHtml +\u003d `\n                    \u003cdiv class\u003d\"order-item\" onclick\u003d\"showPODetails(\u0027${date}\u0027, \u0027${poType}\u0027)\"\u003e\n                        \u003cdiv class\u003d\"order-header\"\u003e\n                            \u003cspan class\u003d\"order-no\"\u003e${poDisplayNames[poType]}\u003c/span\u003e\n                            \u003cspan class\u003d\"delivery-date\"\u003eDelivery Date: ${formattedDate}\u003c/span\u003e\n                        \u003c/div\u003e\n                        \u003cdiv class\u003d\"order-details\"\u003e\n                            \u003cdiv\u003e\n                                \u003cspan class\u003d\"order-label\"\u003eOrders:\u003c/span\u003e \n                                \u003cspan class\u003d\"order-value\"\u003e${poData[poType]}\u003c/span\u003e\n                            \u003c/div\u003e\n                        \u003c/div\u003e\n                    \u003c/div\u003e\n                `;\n            }\n        });\n    });\n\n    if (totalOrders \u003d\u003d\u003d 0) {\n        container.innerHTML \u003d \u0027\u003cp\u003eNo incoming orders for the next 3 days.\u003c/p\u003e\u0027;\n    } else {\n        container.innerHTML \u003d ordersHtml;\n    }\n\n    // Update the pending orders metric\n    document.getElementById(\u0027pending-orders\u0027).textContent \u003d totalOrders;\n    console.log(\u0027Total pending orders:\u0027, totalOrders);\n}\n\nfunction formatDateWithDayOfWeek(dateString) {\n    const [year, month, day] \u003d dateString.split(\u0027-\u0027);\n    const date \u003d new Date(year, month - 1, day);\n    const dayOfWeek \u003d [\u0027Sun\u0027, \u0027Mon\u0027, \u0027Tue\u0027, \u0027Wed\u0027, \u0027Thu\u0027, \u0027Fri\u0027, \u0027Sat\u0027][date.getDay()];\n    return `${day}/${month}/${year} ${dayOfWeek}`;\n}\n\nfunction showPODetails(date, poType) {\n    console.log(`Fetching details for ${poType} on ${date}`);\n    const poDisplayNames \u003d {\n        \u0027SCORE PO\u0027: \u0027SCORE Order\u0027,\n        \u0027NTUC PO\u0027: \u0027NTUC Order\u0027,\n        \u0027CMM PO\u0027: \u0027CMM Order\u0027\n    };\n    document.getElementById(\u0027modalTitle\u0027).textContent \u003d `${poDisplayNames[poType]} Details for ${formatDateWithDayOfWeek(date)}`;\n    document.getElementById(\u0027modalBody\u0027).innerHTML \u003d \u0027\u003ctr\u003e\u003ctd colspan\u003d\"2\"\u003eLoading...\u003c/td\u003e\u003c/tr\u003e\u0027;\n    document.getElementById(\u0027poModal\u0027).style.display \u003d \u0027block\u0027;\n\n    google.script.run.withSuccessHandler(function(detailedData) {\n        displayPODetails(detailedData, poType);\n    }).withFailureHandler(function(error) {\n        document.getElementById(\u0027modalBody\u0027).innerHTML \u003d `\u003ctr\u003e\u003ctd colspan\u003d\"2\"\u003eError: ${error}\u003c/td\u003e\u003c/tr\u003e`;\n    }).getDetailedPOData(date, poType);\n}\n\nfunction displayPODetails(detailedData, poType) {\n    const modalBody \u003d document.getElementById(\u0027modalBody\u0027);\n    if (detailedData.length \u003d\u003d\u003d 0) {\n        modalBody.innerHTML \u003d \u0027\u003ctr\u003e\u003ctd colspan\u003d\"2\"\u003eNo details available.\u003c/td\u003e\u003c/tr\u003e\u0027;\n    } else {\n        modalBody.innerHTML \u003d detailedData.map(item \u003d\u003e `\n            \u003ctr\u003e\n                \u003ctd\u003e${item.description}\u003c/td\u003e\n                \u003ctd\u003e${item.quantity}\u003c/td\u003e\n            \u003c/tr\u003e\n        `).join(\u0027\u0027);\n    }\n}\n\n// Modal close functionality\nconst modal \u003d document.getElementById(\u0027poModal\u0027);\nconst span \u003d document.getElementsByClassName(\u0027close\u0027)[0];\nspan.onclick \u003d function() {\n    modal.style.display \u003d \u0027none\u0027;\n}\nwindow.onclick \u003d function(event) {\n    if (event.target \u003d\u003d modal) {\n        modal.style.display \u003d \u0027none\u0027;\n    }\n}\n\n// Combined initialization function\nfunction initializeDashboard() {\n    // Call the shipments initialization\n    initializeShipments();\n\n    // Call the incoming orders initialization\n    displayIncomingOrders();\n}\n\n// Set window.onload\nwindow.onload \u003d initializeDashboard;\n\u003c/script\u003e"},{"id":"b5e7f2b4-65a5-4608-8b50-485078f9ee22","name":"Indexgs","type":"server_js","source":"function IncomingFunction() {\n  try {\n    var sheet \u003d SpreadsheetApp.openById(\u00271485ut13dOQHzyosLWs7afhWVCve6asyeGSB0RI6vv4E\u0027).getSheetByName(\u0027Shipment List\u0027);\n    var data \u003d sheet.getDataRange().getValues();\n    var headers \u003d data[0];\n    var rows \u003d data.slice(1);\n\n    var today \u003d new Date();\n    var sevenDaysLater \u003d new Date(today.getTime() + 7 * 24 * 60 * 60 * 1000);\n\n    function parseDate(dateString) {\n      var parts \u003d dateString.split(\u0027/\u0027);\n      return new Date(parts[2], parts[1] - 1, parts[0]);\n    }\n\n    var filteredShipments \u003d rows.filter(function(row) {\n      var unloadDate \u003d parseDate(row[5]); // Assuming Unload Date is in column F (index 5)\n      return unloadDate \u003e\u003d today \u0026\u0026 unloadDate \u003c\u003d sevenDaysLater;\n    });\n\n    var formattedShipments \u003d filteredShipments.map(function(row) {\n      return [\n        cleanShipmentNumber(row[0]), // Shipment No (cleaned)\n        row[1], // PO No\n        row[2], // Container Number\n        formatDate(row[3]), // ETA (formatted to DD/MM/YYYY)\n        row[4], // Trucking By\n        row[5]  // Unload Date (already in correct format)\n      ];\n    });\n\n    // Add headers to the formatted shipments\n    formattedShipments.unshift(headers);\n\n    return formattedShipments;\n  } catch (error) {\n    return [headers]; // Return at least the headers if there\u0027s an error\n  }\n}\n\nfunction formatDate(date) {\n  if (typeof date \u003d\u003d\u003d \u0027string\u0027) {\n    // If the date is already a string, assume it\u0027s in the correct format\n    return date;\n  }\n  if (!(date instanceof Date) || isNaN(date)) {\n    return \u0027\u0027;\n  }\n  var day \u003d date.getDate().toString().padStart(2, \u00270\u0027);\n  var month \u003d (date.getMonth() + 1).toString().padStart(2, \u00270\u0027);\n  var year \u003d date.getFullYear();\n  return `${day}/${month}/${year}`;\n}\n\nfunction cleanShipmentNumber(shipmentNo) {\n  // Remove \"SHIPMENT: \" prefix if it exists\n  return shipmentNo.replace(/^SHIPMENT:\\s*/i, \u0027\u0027);\n}\n\n//Incoming Order\nfunction getAllPO() {\n  const SHEET_ID \u003d \u002712K9NImc1eQm-hvBbep5_9i-vQdRRo5vdR9SdqysuQ80\u0027;\n  const SHEET_NAMES \u003d [\u0027SCORE PO\u0027, \u0027Foodfare Catering PO\u0027, \u0027NTUC Foodfare PO\u0027, \u0027CMM PO\u0027];\n  \n  let allData \u003d {};\n\n  try {\n    const spreadsheet \u003d SpreadsheetApp.openById(SHEET_ID);\n\n    const spreadsheetTimeZone \u003d spreadsheet.getSpreadsheetTimeZone();\n    const today \u003d new Date();\n    const tomorrow \u003d new Date(today.getTime() + 24 * 60 * 60 * 1000);\n    const threeDaysLater \u003d new Date(today.getTime() + 4 * 24 * 60 * 60 * 1000); // 3 days after tomorrow\n\n    const tomorrowFormatted \u003d Utilities.formatDate(tomorrow, spreadsheetTimeZone, \u0027yyyy-MM-dd\u0027);\n    const threeDaysLaterFormatted \u003d Utilities.formatDate(threeDaysLater, spreadsheetTimeZone, \u0027yyyy-MM-dd\u0027);\n\n    SHEET_NAMES.forEach(sheetName \u003d\u003e {\n      const sheet \u003d spreadsheet.getSheetByName(sheetName);\n      if (!sheet) {\n        return; // Skip to next sheet\n      }\n      \n      const data \u003d sheet.getDataRange().getValues();\n\n      let sheetData \u003d {};\n      \n      data.forEach((row, index) \u003d\u003e {\n        if (index \u003d\u003d\u003d 0) return; // Skip header row\n        \n        const dateString \u003d Utilities.formatDate(new Date(row[0]), spreadsheetTimeZone, \u0027yyyy-MM-dd\u0027);\n        if (dateString \u003e\u003d tomorrowFormatted \u0026\u0026 dateString \u003c\u003d threeDaysLaterFormatted) {\n          if (!sheetData[dateString]) {\n            sheetData[dateString] \u003d { uniqueValues: new Set() };\n          }\n          sheetData[dateString].uniqueValues.add(row[1]); // Add value from column B to the Set\n        }\n      });\n      \n      // Convert Sets to counts\n      Object.keys(sheetData).forEach(date \u003d\u003e {\n        sheetData[date] \u003d { count: sheetData[date].uniqueValues.size };\n      });\n      \n      allData[sheetName] \u003d sheetData;\n    });\n\n    return allData;\n\n  } catch (error) {\n    return { error: error.message };\n  }\n}\n\nfunction getDetailedPOData(date, poType) {\n  const SHEET_ID \u003d \u002712K9NImc1eQm-hvBbep5_9i-vQdRRo5vdR9SdqysuQ80\u0027;\n  let sheetNames, descriptionColumn, quantityColumn, unit;\n  \n  switch(poType) {\n    case \u0027SCORE PO\u0027:\n      sheetNames \u003d [\u0027SCORE PO\u0027];\n      descriptionColumn \u003d \u0027C\u0027;\n      quantityColumn \u003d \u0027F\u0027;\n      unit \u003d \u0027Pkts\u0027;\n      break;\n    case \u0027NTUC PO\u0027:\n      sheetNames \u003d [\u0027NTUC Foodfare PO\u0027, \u0027Foodfare Catering PO\u0027];\n      descriptionColumn \u003d \u0027C\u0027;\n      quantityColumn \u003d \u0027E\u0027;\n      unit \u003d \u0027Ctns\u0027;\n      break;\n    case \u0027CMM PO\u0027:\n      sheetNames \u003d [\u0027CMM PO\u0027];\n      descriptionColumn \u003d \u0027C\u0027;\n      quantityColumn \u003d \u0027E\u0027;\n      unit \u003d \u0027Ctns\u0027;\n      break;\n    default:\n      throw new Error(\u0027Invalid PO Type\u0027);\n  }\n  \n  let detailedData \u003d {};\n  \n  sheetNames.forEach(sheetName \u003d\u003e {\n    const sheet \u003d SpreadsheetApp.openById(SHEET_ID).getSheetByName(sheetName);\n    const data \u003d sheet.getDataRange().getValues();\n    \n    data.forEach((row, index) \u003d\u003e {\n      if (index \u003d\u003d\u003d 0) return; // Skip header row\n      const rowDate \u003d new Date(row[0]);\n      if (Utilities.formatDate(rowDate, sheet.getParent().getSpreadsheetTimeZone(), \u0027yyyy-MM-dd\u0027) \u003d\u003d\u003d date) {\n        const description \u003d row[descriptionColumn.charCodeAt(0) - 65]; // Convert column letter to index\n        const quantity \u003d parseFloat(row[quantityColumn.charCodeAt(0) - 65]) || 0;\n        \n        if (detailedData[description]) {\n          detailedData[description] +\u003d quantity;\n        } else {\n          detailedData[description] \u003d quantity;\n        }\n      }\n    });\n  });\n  \n  // Convert the object to an array of objects, round the quantity, and add the unit\n  return Object.entries(detailedData).map(([description, quantity]) \u003d\u003e ({\n    description,\n    quantity: `${Math.round(quantity)} ${unit}`\n  }));\n}"},{"id":"fb32aee7-e47b-4f5c-9124-397d8ebc4297","name":"Inventory","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n\u003chead\u003e\n  \u003cbase target\u003d\"_top\"\u003e\n  \u003c?!\u003d include(\u0027CSS\u0027); ?\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\n\u003cheader\u003e\n  \u003ch1\u003eInventory Management System\u003c/h1\u003e\n\u003c/header\u003e\n{{NAVBAR}}\n\n\u003cmain\u003e\n  \u003csection id\u003d\"inventory\"\u003e\n    \u003ch2\u003eInventory\u003c/h2\u003e\n\n    \u003c!-- Dropdown to select sheet name --\u003e\n    \u003clabel for\u003d\"sheet-select\"\u003eSelect Sheet:\u003c/label\u003e\n    \u003cselect id\u003d\"sheet-select\" onchange\u003d\"fetchInventory()\"\u003e\n      \u003c!-- Options will be populated dynamically --\u003e\n    \u003c/select\u003e\n\n    \u003c!-- Search input field --\u003e\n    \u003clabel for\u003d\"search-input\"\u003eSearch by Name or ID:\u003c/label\u003e\n    \u003cinput type\u003d\"text\" id\u003d\"search-input\" oninput\u003d\"filterInventory()\" placeholder\u003d\"Search...\"\u003e\n\n    \u003ctable\u003e\n      \u003cthead\u003e\n        \u003ctr\u003e\n          \u003cth\u003eID\u003c/th\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eCategory\u003c/th\u003e\n          \u003cth\u003ePacking\u003c/th\u003e\n          \u003cth\u003eQuantity\u003c/th\u003e\n          \u003cth\u003eAction\u003c/th\u003e\n        \u003c/tr\u003e\n      \u003c/thead\u003e\n      \u003ctbody id\u003d\"inventory-table-body\"\u003e\n        \u003c!-- Inventory data will be inserted here --\u003e\n      \u003c/tbody\u003e\n    \u003c/table\u003e\n  \u003c/section\u003e\n\u003c/main\u003e\n\n\u003cdiv id\u003d\"transaction-modal\" onclick\u003d\"closeModal()\"\u003e\n  \u003cdiv class\u003d\"modal-content\" onclick\u003d\"event.stopPropagation()\"\u003e\n    \u003cspan class\u003d\"close\" onclick\u003d\"closeModal()\"\u003e\u0026times;\u003c/span\u003e\n    \u003ch2\u003eTransactions for Item: \u003cspan id\u003d\"item-name\"\u003e\u003c/span\u003e\u003c/h2\u003e\n    \u003ctable\u003e\n      \u003cthead\u003e\n        \u003ctr\u003e\n          \u003cth\u003eDate\u003c/th\u003e\n          \u003cth\u003eFrom\u003c/th\u003e\n          \u003cth\u003eTo\u003c/th\u003e\n          \u003cth\u003eQuantity\u003c/th\u003e\n        \u003c/tr\u003e\n      \u003c/thead\u003e\n      \u003ctbody id\u003d\"transaction-table-body1\"\u003e\n        \u003c!-- Transaction data for sheet 1 will be inserted here --\u003e\n      \u003c/tbody\u003e\n    \u003c/table\u003e\n    \u003ctable\u003e\n      \u003cthead\u003e\n        \u003ctr\u003e\n          \u003cth\u003eDate\u003c/th\u003e\n          \u003cth\u003eQuantity\u003c/th\u003e\n        \u003c/tr\u003e\n      \u003c/thead\u003e\n      \u003ctbody id\u003d\"transaction-table-body2\"\u003e\n        \u003c!-- Transaction data for sheet 2 will be inserted here --\u003e\n      \u003c/tbody\u003e\n    \u003c/table\u003e\n  \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cscript\u003e\n  let inventoryData \u003d [];\n\n  document.addEventListener(\u0027DOMContentLoaded\u0027, function() {\n    console.log(\u0027Document loaded, fetching sheet names...\u0027);\n    fetchSheetNames();\n  });\n\n  function fetchSheetNames() {\n    console.log(\u0027Fetching sheet names...\u0027);\n    google.script.run.withSuccessHandler(populateSheetDropdown).getSheetNames();\n  }\n\n  function populateSheetDropdown(sheetNames) {\n    console.log(\u0027Sheet names fetched:\u0027, sheetNames);\n    const sheetSelect \u003d document.getElementById(\u0027sheet-select\u0027);\n    sheetSelect.innerHTML \u003d \u0027\u0027; // Clear existing options\n\n    sheetNames.forEach(sheetName \u003d\u003e {\n      const option \u003d document.createElement(\u0027option\u0027);\n      option.value \u003d sheetName;\n      option.textContent \u003d sheetName;\n      sheetSelect.appendChild(option);\n    });\n\n    // Set the last sheet as the selected option\n    sheetSelect.selectedIndex \u003d sheetNames.length - 1;\n    fetchInventory(); // Fetch inventory for the last sheet by default\n  }\n\n  function fetchInventory() {\n    const sheetSelect \u003d document.getElementById(\u0027sheet-select\u0027).value;\n    console.log(\u0027Fetching inventory for sheet:\u0027, sheetSelect);\n    google.script.run.withSuccessHandler(updateInventoryTable).withFailureHandler(showError).getInventory(sheetSelect);\n  }\n\n  function updateInventoryTable(inventory) {\n    console.log(\u0027Inventory data fetched:\u0027, inventory);\n    inventoryData \u003d inventory;\n    displayInventory(inventoryData); // Display the initial data\n  }\n\n  function displayInventory(data) {\n    const inventoryTableBody \u003d document.getElementById(\u0027inventory-table-body\u0027);\n    inventoryTableBody.innerHTML \u003d \u0027\u0027;\n\n    data.forEach(item \u003d\u003e {\n      const row \u003d document.createElement(\u0027tr\u0027);\n      row.innerHTML \u003d `\n        \u003ctd\u003e${item.id}\u003c/td\u003e\n        \u003ctd\u003e${item.name}\u003c/td\u003e\n        \u003ctd\u003e${item.category}\u003c/td\u003e\n        \u003ctd\u003e${item.packing}\u003c/td\u003e\n        \u003ctd\u003e${item.quantity}\u003c/td\u003e\n        \u003ctd\u003e\u003cbutton onclick\u003d\"deleteItem(\u0027${item.id}\u0027)\"\u003eDelete\u003c/button\u003e\u003c/td\u003e\n      `;\n      row.onclick \u003d function() {\n        showTransactions(item.id, item.name);\n      };\n      inventoryTableBody.appendChild(row);\n    });\n  }\n\n  function filterInventory() {\n    const searchInput \u003d document.getElementById(\u0027search-input\u0027).value.toLowerCase();\n    console.log(\u0027Filtering inventory with search input:\u0027, searchInput);\n    \n    const filteredInventory \u003d inventoryData.filter(item \u003d\u003e {\n      const id \u003d String(item.id).toLowerCase();\n      const name \u003d String(item.name).toLowerCase();\n      return id.includes(searchInput) || name.includes(searchInput);\n    });\n    \n    displayInventory(filteredInventory); // Display the filtered data\n  }\n\n  function showTransactions(itemId, itemName) {\n    const modal \u003d document.getElementById(\u0027transaction-modal\u0027);\n    const itemNameSpan \u003d document.getElementById(\u0027item-name\u0027);\n    itemNameSpan.textContent \u003d itemName;\n    modal.style.display \u003d \u0027block\u0027;\n\n    google.script.run.withSuccessHandler(updateTransactionTables).withFailureHandler(showError).getTransactions(itemId);\n  }\n\n  function updateTransactionTables(transactions) {\n    const transactionTableBody1 \u003d document.getElementById(\u0027transaction-table-body1\u0027);\n    const transactionTableBody2 \u003d document.getElementById(\u0027transaction-table-body2\u0027);\n    \n    transactionTableBody1.innerHTML \u003d \u0027\u0027;\n    transactionTableBody2.innerHTML \u003d \u0027\u0027;\n\n    transactions.transactions1.forEach(transaction \u003d\u003e {\n      const row \u003d document.createElement(\u0027tr\u0027);\n      row.innerHTML \u003d `\n        \u003ctd\u003e${transaction.date}\u003c/td\u003e\n        \u003ctd\u003e${transaction.from}\u003c/td\u003e\n        \u003ctd\u003e${transaction.to}\u003c/td\u003e\n        \u003ctd\u003e${transaction.quantity}\u003c/td\u003e\n      `;\n      transactionTableBody1.appendChild(row);\n    });\n\n    transactions.transactions2.forEach(transaction \u003d\u003e {\n      const row \u003d document.createElement(\u0027tr\u0027);\n      row.innerHTML \u003d `\n        \u003ctd\u003e${transaction.date}\u003c/td\u003e\n        \u003ctd\u003e${transaction.quantity}\u003c/td\u003e\n      `;\n      transactionTableBody2.appendChild(row);\n    });\n  }\n\n  function deleteItem(id) {\n    console.log(\u0027Delete item with ID:\u0027, id);\n    // Your code to delete the item\n  }\n\n  function showError(error) {\n    console.error(\u0027Error:\u0027, error);\n    alert(\u0027Failed to fetch data: \u0027 + error.message);\n  }\n\n  function closeModal() {\n    const modal \u003d document.getElementById(\u0027transaction-modal\u0027);\n    modal.style.display \u003d \u0027none\u0027;\n  }\n\u003c/script\u003e\n\n\u003cfooter\u003e\n  \u003cp\u003e\u0026copy; 2024 Inventory Management System\u003c/p\u003e\n\u003c/footer\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},{"id":"c9f147c5-4cdb-4b05-8fa7-02f704b92361","name":"JavaScript","type":"html","source":"\u003cscript\u003e\n\n  function addItem(event) {\n    event.preventDefault();\n    const itemName \u003d document.getElementById(\u0027item-name\u0027).value;\n    const itemCategory \u003d document.getElementById(\u0027item-category\u0027).value;\n    const itemQuantity \u003d document.getElementById(\u0027item-quantity\u0027).value;\n    const itemPrice \u003d document.getElementById(\u0027item-price\u0027).value;\n\n    const itemId \u003d Date.now();\n    const item \u003d { id: itemId, name: itemName, category: itemCategory, quantity: itemQuantity, price: itemPrice };\n\n    google.script.run.withSuccessHandler(fetchInventory).addItem(item);\n    document.getElementById(\u0027add-item-form\u0027).reset();\n  }\n\n  function deleteItem(id) {\n    google.script.run.withSuccessHandler(fetchInventory).deleteItem(id);\n  }\n\n  function updateDashboardStats(inventory) {\n    document.getElementById(\u0027total-items\u0027).textContent \u003d inventory.length;\n    document.getElementById(\u0027out-of-stock\u0027).textContent \u003d inventory.filter(item \u003d\u003e item.quantity \u003d\u003d 0).length;\n    const categories \u003d [...new Set(inventory.map(item \u003d\u003e item.category))];\n    document.getElementById(\u0027categories\u0027).textContent \u003d categories.length;\n  }\n\n  document.addEventListener(\u0027DOMContentLoaded\u0027, () \u003d\u003e {\n    document.getElementById(\u0027add-item-form\u0027).addEventListener(\u0027submit\u0027, addItem);\n    const fetchInventoryButton \u003d document.getElementById(\u0027fetch-inventory-button\u0027);\n    if (fetchInventoryButton) {\n      fetchInventoryButton.addEventListener(\u0027click\u0027, fetchInventory);\n    }\n  });\n\u003c/script\u003e\n"},{"id":"94ccda0f-f6c3-493b-b094-bf8006be4ce4","name":"Lineage","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n    \u003c?!\u003d include(\u0027CSS\u0027); ?\u003e\n    \u003cstyle\u003e\n      .modal {\n        display: none; \n        position: fixed; \n        top: 0; \n        left: 0; \n        width: 100%; \n        height: 100%; \n        background-color: rgba(0, 0, 0, 0.5); \n        z-index: 1000; \n        overflow: auto;\n      }\n      .modal-content {\n        position: absolute; \n        top: 20%; \n        left: 50%; \n        transform: translate(-50%, -50%); \n        background-color: #fff; \n        border: 1px solid #ccc; \n        padding: 20px; \n        max-width: 80%; \n        max-height: 80%; \n        overflow-y: auto;\n      }\n      .close {\n        float: right; \n        font-size: 28px; \n        font-weight: bold;\n      }\n      .close:hover, .close:focus {\n        color: #000;\n        text-decoration: none;\n        cursor: pointer;\n      }\n      .hidden {\n        display: none;\n      }\n    \u003c/style\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n    \u003cheader\u003e\n      \u003ch1\u003eInventory Management System\u003c/h1\u003e\n    \u003c/header\u003e\n    {{NAVBAR}}\n    \u003cmain\u003e\n    \u003cdiv class\u003d\"tab-container\"\u003e\n    \u003cdiv class\u003d\"tab active\" onclick\u003d\"activateTab(this, \u0027inventory\u0027)\"\u003eLineage Inventory Summary\u003c/div\u003e\n    \u003cdiv class\u003d\"tab\" onclick\u003d\"activateTab(this, \u0027drawing-out-record\u0027)\"\u003eDrawing Out Record\u003c/div\u003e\n    \u003cdiv class\u003d\"tab\" onclick\u003d\"activateTab(this, \u0027store-in-record\u0027)\"\u003eStore In Record\u003c/div\u003e\n    \u003cdiv class\u003d\"tab\" onclick\u003d\"activateTab(this, \u0027report\u0027)\"\u003eReport\u003c/div\u003e\n  \u003c/div\u003e\n      \u003csection id\u003d\"inventory\" class\u003d\"tab-content active\"\u003e\n  \u003ch2\u003eLineage Inventory Summary\u003c/h2\u003e\n  \u003clabel for\u003d\"search-input\"\u003eSearch by Name or ID:\u003c/label\u003e\n  \u003cinput type\u003d\"text\" id\u003d\"search-input\" oninput\u003d\"filterInventory()\" placeholder\u003d\"Search...\"\u003e\n  \u003cbutton id\u003d\"groupButton\" onclick\u003d\"groupInventory()\"\u003eGroup\u003c/button\u003e\n\n  \u003ctable id\u003d\"inventory-table\"\u003e\n    \u003cthead\u003e\n      \u003ctr\u003e\n        \u003cth\u003eItem Code\u003c/th\u003e\n        \u003cth\u003eProduct Description\u003c/th\u003e\n        \u003cth\u003ePacking\u003c/th\u003e\n        \u003cth\u003eType\u003c/th\u003e\n        \u003cth\u003eExpiry Date / Batch No\u003c/th\u003e\n        \u003cth\u003eGRN\u003c/th\u003e\n        \u003cth\u003eLineage Item Code\u003c/th\u003e\n        \u003cth\u003eDate Stored\u003c/th\u003e\n        \u003cth\u003eContainer\u003c/th\u003e\n        \u003cth\u003eQuantity\u003c/th\u003e\n        \u003cth\u003ePallets\u003c/th\u003e\n      \u003c/tr\u003e\n    \u003c/thead\u003e\n    \u003ctbody id\u003d\"inventory-table-body\"\u003e\n      \u003c!-- Inventory data will be inserted here --\u003e\n    \u003c/tbody\u003e\n  \u003c/table\u003e\n\u003c/section\u003e\n      \n      \u003csection id\u003d\"drawing-out-record\" class\u003d\"tab-content\"\u003e\n        \u003ch2\u003eDraw Out\u003c/h2\u003e\n        \u003clabel for\u003d\"drawOutDate\"\u003eDate:\u003c/label\u003e\n        \u003cinput type\u003d\"date\" id\u003d\"drawOutDate\"\u003e\u003cbr\u003e\n        \u003cbutton id\u003d\"drawOutItemButton\" onclick\u003d\"showInventoryModal()\"\u003eSelect Item\u003c/button\u003e\u003cbr\u003e\n        \u003cdiv id\u003d\"selected-item-details\"\u003e\n          \u003ch3\u003eSelected Item\u003c/h3\u003e\n          \u003cp\u003eItem Code: \u003cspan id\u003d\"selected-item-code\"\u003e\u003c/span\u003e\u003c/p\u003e\n          \u003cp\u003eProduct Description: \u003cspan id\u003d\"selected-product-description\"\u003e\u003c/span\u003e\u003c/p\u003e\n          \u003cp\u003ePacking: \u003cspan id\u003d\"selected-packing\"\u003e\u003c/span\u003e\u003c/p\u003e\n          \u003cp\u003eType: \u003cspan id\u003d\"selected-type\"\u003e\u003c/span\u003e\u003c/p\u003e\n          \u003cp\u003eExpiry Date/Batch No: \u003cspan id\u003d\"selected-expiry-batch\"\u003e\u003c/span\u003e\u003c/p\u003e\n          \u003cp\u003eGRN: \u003cspan id\u003d\"selected-grn\"\u003e\u003c/span\u003e\u003c/p\u003e\n          \u003cp\u003eLineage Item Code: \u003cspan id\u003d\"selected-lineage-item-code\"\u003e\u003c/span\u003e\u003c/p\u003e\n          \u003cp\u003eDate Stored: \u003cspan id\u003d\"selected-date-stored\"\u003e\u003c/span\u003e\u003c/p\u003e\n          \u003cp\u003eContainer No: \u003cspan id\u003d\"selected-container-no\"\u003e\u003c/span\u003e\u003c/p\u003e\n          \u003cp\u003eBal. Quantity: \u003cspan id\u003d\"selected-bal-quantity\"\u003e\u003c/span\u003e\u003c/p\u003e\n          \u003cp\u003eBal. Pallet: \u003cspan id\u003d\"selected-bal-pallet\"\u003e\u003c/span\u003e\u003c/p\u003e\n          \u003clabel for\u003d\"input-quantity\"\u003eQuantity:\u003c/label\u003e\n          \u003cinput type\u003d\"number\" id\u003d\"input-quantity\" min\u003d\"1\"\u003e\u003cbr\u003e\n          \u003clabel for\u003d\"input-pallet\"\u003ePallet:\u003c/label\u003e\n          \u003cinput type\u003d\"number\" id\u003d\"input-pallet\" min\u003d\"1\"\u003e\u003cbr\u003e\n        \u003c/div\u003e\n        \u003cbutton onclick\u003d\"drawOutStock()\"\u003eDraw Out Stock\u003c/button\u003e\n      \u003c/section\u003e\n      \n \u003csection id\u003d\"store-in-record\" class\u003d\"tab-content\"\u003e\n    \u003ch2\u003eStore In Record\u003c/h2\u003e\n    \u003ch3\u003ePaste Data from Excel\u003c/h3\u003e\n    \u003ctextarea onpaste\u003d\"handlePaste(event)\" rows\u003d\"5\" cols\u003d\"20\" placeholder\u003d\"Paste your Excel data here...\"\u003e\u003c/textarea\u003e\n    \n    \u003c!-- New input fields for additional columns --\u003e\n    \u003cdiv\u003e\n        \u003clabel for\u003d\"stored-date\"\u003eStored Date:\u003c/label\u003e\n          \u003cinput type\u003d\"date\" id\u003d\"stored-date\" name\u003d\"stored-date\" value\u003d\"\"\u003e\n    \u003c/div\u003e\n    \u003cdiv\u003e\n        \u003clabel for\u003d\"container-number\"\u003eContainer Number:\u003c/label\u003e\n        \u003cinput type\u003d\"text\" id\u003d\"container-number\" name\u003d\"container-number\"\u003e\n    \u003c/div\u003e\n    \u003cdiv\u003e\n        \u003clabel for\u003d\"grn\"\u003eGRN:\u003c/label\u003e\n        \u003cinput type\u003d\"text\" id\u003d\"grn\" name\u003d\"grn\"\u003e\n    \u003c/div\u003e\n    \n    \u003cdiv id\u003d\"store-in-table-body\"\u003e\n        \u003c!-- Pasted data will be displayed here --\u003e\n    \u003c/div\u003e\n    \n    \u003cbutton onclick\u003d\"storeInStock()\"\u003eStore In Stock\u003c/button\u003e\n\u003c/section\u003e\n\n\n\u003csection id\u003d\"report\" class\u003d\"tab-content\"\u003e\n  \u003ch2\u003eReport\u003c/h2\u003e\n  \u003cdiv class\u003d\"report-options\"\u003e\n    \u003cdiv class\u003d\"report-option\" onclick\u003d\"generateAndDownloadPdf(\u0027endMonth\u0027)\"\u003e\n      \u003cspan\u003eGenerate End Month Report\u003c/span\u003e\n    \u003c/div\u003e\n    \u003cdiv class\u003d\"report-option\" onclick\u003d\"generateAndDownloadPdf(\u0027byItem\u0027)\"\u003e\n      \u003cspan\u003eGenerate Report By Item\u003c/span\u003e\n    \u003c/div\u003e\n    \u003cdiv class\u003d\"report-option\" onclick\u003d\"generateAndDownloadPdf(\u0027byGroup\u0027)\"\u003e\n      \u003cspan\u003eGenerate Report By Group Item\u003c/span\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n\u003c/section\u003e\n\n      \u003cdiv id\u003d\"myModal\" class\u003d\"modal\"\u003e\n        \u003cdiv class\u003d\"modal-content\"\u003e\n          \u003cspan class\u003d\"close\" onclick\u003d\"closeModal()\"\u003e\u0026times;\u003c/span\u003e\n          \u003ch2\u003eSelect an Item\u003c/h2\u003e\n          \u003cinput type\u003d\"text\" id\u003d\"modal-search-input\" oninput\u003d\"filterModalInventory()\" placeholder\u003d\"Search by item code or description\"\u003e\n          \u003ctable id\u003d\"modal-inventory-table\"\u003e\n            \u003cthead\u003e\n              \u003ctr\u003e\n                \u003cth\u003eItem Code\u003c/th\u003e\n                \u003cth\u003eProduct Description\u003c/th\u003e\n                \u003cth\u003ePacking\u003c/th\u003e\n                \u003cth\u003eType\u003c/th\u003e\n                \u003cth\u003eExpiry Date/Batch No\u003c/th\u003e\n                \u003cth\u003eGRN\u003c/th\u003e\n                \u003cth\u003eLineage Item Code\u003c/th\u003e\n                \u003cth\u003eDate Stored\u003c/th\u003e\n                \u003cth\u003eContainer No\u003c/th\u003e\n                \u003cth\u003eBal.Quantity\u003c/th\u003e\n                \u003cth\u003eBal.Pallet\u003c/th\u003e\n              \u003c/tr\u003e\n            \u003c/thead\u003e\n            \u003ctbody id\u003d\"modal-inventory-table-body\"\u003e\n              \u003c!-- Inventory data will be inserted here --\u003e\n            \u003c/tbody\u003e\n          \u003c/table\u003e\n        \u003c/div\u003e\n      \u003c/div\u003e\n    \u003c/main\u003e\n\n    \u003c?!\u003d include(\u0027Script\u0027); ?\u003e\n\n     \u003cscript\u003e\n    function generateAndDownloadPdf() {\n      google.script.run.withSuccessHandler(function(url) {\n        window.open(url, \u0027_blank\u0027);\n      }).generateEndMonthReport();\n    }\n  \u003c/script\u003e \n\n\n    \u003cfooter\u003e\n      \u003cp\u003e\u0026copy; 2024 Inventory Management System\u003c/p\u003e\n    \u003c/footer\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n"},{"id":"c5fe91b0-8fa2-4734-8b72-157de070adfd","name":"Lineagegs","type":"server_js","source":"function createInventorySummary() {\n  var ss \u003d SpreadsheetApp.openById(\u00271GQUKpmn6dp0CJRz873w8x0LZf8EyA6xPQ3HPFlh99qs\u0027);\n  var openingStockSheet \u003d ss.getSheetByName(\u0027Jun 2024\u0027);\n  var stockInSheet \u003d ss.getSheetByName(\u0027Stock In\u0027);\n  var drawOutSheet \u003d ss.getSheetByName(\u0027Draw Out\u0027);\n  var summarySheet \u003d ss.getSheetByName(\u0027Inventory Summary\u0027);\n  var timezone \u003d ss.getSpreadsheetTimeZone();\n\n  // If the Inventory Summary sheet doesn\u0027t exist, create it\n  if (!summarySheet) {\n    summarySheet \u003d ss.insertSheet(\u0027Inventory Summary\u0027);\n  } else {\n    summarySheet.clear(); // Clear existing data\n  }\n\n  function formatDates(data) {\n    return data.map(row \u003d\u003e \n      row.map(cell \u003d\u003e \n        cell instanceof Date \n          ? Utilities.formatDate(cell, timezone, \"dd/MM/yyyy\") \n          : cell\n      )\n    );\n  }\n\n  var openingStock \u003d formatDates(openingStockSheet.getRange(\u0027A2:K\u0027).getValues());\n  var stockIn \u003d formatDates(stockInSheet.getRange(\u0027A2:K\u0027).getValues());\n  var drawOut \u003d formatDates(drawOutSheet.getRange(\u0027A2:K\u0027).getValues());\n\n  var summaryData \u003d [];\n  summaryData.push([\u0027ITEM CODE\u0027, \u0027PRODUCT DESCRIPTION\u0027, \u0027PACKING\u0027, \u0027TYPE\u0027, \u0027Expiry Date / Batch No\u0027, \u0027GRN\u0027, \u0027Lineage Item Code\u0027, \u0027DATE STORED\u0027, \u0027CONTAINER\u0027, \u0027Opening BAL. CTNS\u0027, \u0027Opening BAL. Plt\u0027, \u0027Stock In BAL. CTNS\u0027, \u0027Stock In Pallet\u0027, \u0027Draw Out BAL. CTNS\u0027, \u0027Draw Out Pallet\u0027, \u0027Summary Ctns\u0027, \u0027Summary Plt\u0027]);\n\n  var stockMap \u003d {};\n\n  function generateKey(entry) {\n    return entry.map(item \u003d\u003e String(item).trim()).join(\u0027_\u0027);\n  }\n\n  // Process opening stock\n  for (var i \u003d 0; i \u003c openingStock.length; i++) {\n    var itemCode \u003d openingStock[i][0];\n    if (itemCode) {\n      var key \u003d generateKey(openingStock[i].slice(0, 9));\n      if (!stockMap[key]) {\n        stockMap[key] \u003d {\n          details: openingStock[i].slice(0, 9),\n          openingCtns: 0,\n          openingPlts: 0,\n          stockInCtns: 0,\n          stockInPlts: 0,\n          drawOutCtns: 0,\n          drawOutPlts: 0,\n          summaryCtns: 0,\n          summaryPlts: 0\n        };\n      }\n      stockMap[key].openingCtns +\u003d openingStock[i][9] || 0;\n      stockMap[key].openingPlts +\u003d openingStock[i][10] || 0;\n      stockMap[key].summaryCtns +\u003d openingStock[i][9] || 0;\n      stockMap[key].summaryPlts +\u003d openingStock[i][10] || 0;\n    }\n  }\n\n  // Process stock in\n  for (var j \u003d 0; j \u003c stockIn.length; j++) {\n    var itemCodeIn \u003d stockIn[j][0];\n    if (itemCodeIn) {\n      var keyIn \u003d generateKey(stockIn[j].slice(0, 9));\n      if (!stockMap[keyIn]) {\n        stockMap[keyIn] \u003d {\n          details: stockIn[j].slice(0, 9),\n          openingCtns: 0,\n          openingPlts: 0,\n          stockInCtns: 0,\n          stockInPlts: 0,\n          drawOutCtns: 0,\n          drawOutPlts: 0,\n          summaryCtns: 0,\n          summaryPlts: 0\n        };\n      }\n      stockMap[keyIn].stockInCtns +\u003d stockIn[j][9] || 0;\n      stockMap[keyIn].stockInPlts +\u003d stockIn[j][10] || 0;\n      stockMap[keyIn].summaryCtns +\u003d stockIn[j][9] || 0;\n      stockMap[keyIn].summaryPlts +\u003d stockIn[j][10] || 0;\n    }\n  }\n\n  // Process draw out\n  for (var k \u003d 0; k \u003c drawOut.length; k++) {\n    var itemCodeOut \u003d drawOut[k][0];\n    if (itemCodeOut) {\n      var keyOut \u003d generateKey(drawOut[k].slice(0, 9));\n      if (stockMap[keyOut]) {\n        stockMap[keyOut].drawOutCtns +\u003d drawOut[k][9] || 0;\n        stockMap[keyOut].drawOutPlts +\u003d drawOut[k][10] || 0;\n        stockMap[keyOut].summaryCtns -\u003d drawOut[k][9] || 0;\n        stockMap[keyOut].summaryPlts -\u003d drawOut[k][10] || 0;\n      }\n    }\n  }\n\n  // Prepare summary data\n  for (var item in stockMap) {\n    summaryData.push([\n      ...stockMap[item].details, \n      stockMap[item].openingCtns, \n      stockMap[item].openingPlts, \n      stockMap[item].stockInCtns, \n      stockMap[item].stockInPlts, \n      stockMap[item].drawOutCtns, \n      stockMap[item].drawOutPlts, \n      stockMap[item].summaryCtns, \n      stockMap[item].summaryPlts\n    ]);\n  }\n\n  // Set summary data to the sheet\n  summarySheet.getRange(1, 1, summaryData.length, summaryData[0].length).setValues(summaryData);\n}\n\n\nfunction getInventoryData() {\n  const sheet \u003d SpreadsheetApp.openById(\u00271GQUKpmn6dp0CJRz873w8x0LZf8EyA6xPQ3HPFlh99qs\u0027).getSheetByName(\u0027Inventory Summary\u0027);\n  const dataRange \u003d sheet.getDataRange();\n  const numRows \u003d dataRange.getNumRows();\n  const numCols \u003d dataRange.getNumColumns();\n  const values \u003d dataRange.getValues();\n\n  // Array to hold the filtered data\n  let filteredData \u003d [];\n\n  // Loop through each row and extract columns 0-8 and 15-16\n  for (let i \u003d 0; i \u003c numRows; i++) {\n    let row \u003d [];\n    let shouldIncludeRow \u003d true; // Flag to determine if row should be included\n\n    for (let j \u003d 0; j \u003c numCols; j++) {\n      if (j \u003e\u003d 0 \u0026\u0026 j \u003c\u003d 8) {\n        // Include columns 0-8\n        row.push(values[i][j]);\n      } else if (j \u003d\u003d\u003d 15 || j \u003d\u003d\u003d 16) {\n        // Include columns 15 and 16\n        row.push(values[i][j]);\n        // Check if column 15 is 0; if so, set shouldIncludeRow to false\n        if (j \u003d\u003d\u003d 15 \u0026\u0026 values[i][j] \u003d\u003d\u003d 0) {\n          shouldIncludeRow \u003d false;\n        }\n      }\n    }\n\n    // Format dates in columns 4 (index 3) and 7 (index 6) to \"DD/MM/YYYY\"\n    if (row[3] instanceof Date) {\n      row[3] \u003d Utilities.formatDate(row[3], Session.getScriptTimeZone(), \"dd/MM/yyyy\");\n    }\n    if (row[6] instanceof Date) {\n      row[6] \u003d Utilities.formatDate(row[6], Session.getScriptTimeZone(), \"dd/MM/yyyy\");\n    }\n\n    // Add row to filteredData if shouldIncludeRow is true\n    if (shouldIncludeRow) {\n      filteredData.push(row);\n    }\n  }\n\n  // Convert all dates to formatted strings before stringifying\n  filteredData \u003d filteredData.map(row \u003d\u003e \n    row.map(cell \u003d\u003e \n      cell instanceof Date ? Utilities.formatDate(cell, Session.getScriptTimeZone(), \"dd/MM/yyyy\") : cell\n    )\n  );\n\n  return JSON.stringify(filteredData);\n}\n\n\n// Report\nfunction generateEndMonthReport() {\n  var spreadsheet \u003d SpreadsheetApp.openById(\u00271GQUKpmn6dp0CJRz873w8x0LZf8EyA6xPQ3HPFlh99qs\u0027);\n  var sheet \u003d spreadsheet.getSheetByName(\u0027Inventory Summary\u0027);\n  var data \u003d sheet.getDataRange().getValues();\n\n  var filteredData \u003d [];\n  for (var i \u003d 1; i \u003c data.length; i++) {\n    if (data[i][15] !\u003d\u003d 0) { // Index 15 (column P) check\n      filteredData.push([\n        data[i][0], \n        data[i][1], \n        data[i][2], \n        data[i][3], \n        formatDate(data[i][4]), // Format date in column 4 (index 4)\n        data[i][5], \n        data[i][6], \n        formatDate(data[i][7]), // Format date in column 7 (index 7)\n        data[i][8], \n        data[i][15], \n        data[i][16]\n      ]);\n    }\n  }\n\n  // Generate HTML content for PDF\n  var monthName \u003d getMonthName(new Date().getMonth() + 1);\n  var htmlContent \u003d generateHtmlContent(filteredData, monthName);\n\n  // Create PDF\n  var pdf \u003d createPdf(htmlContent);\n\n  // Save the PDF to Drive and generate download link\n  var pdfFile \u003d DriveApp.createFile(pdf).setName(\u0027EndMonthReport.pdf\u0027);\n  var pdfUrl \u003d pdfFile.getDownloadUrl();\n  Logger.log(\u0027PDF URL: \u0027 + pdfUrl);\n  return pdfUrl;\n}\n\nfunction formatDate(date) {\n  if (date instanceof Date) {\n    return Utilities.formatDate(date, Session.getScriptTimeZone(), \u0027dd/MM/yyyy\u0027);\n  }\n  return date;\n}\n\nfunction generateHtmlContent(data, monthName) {\n  var rowsPerPage \u003d 15; // Adjust this number based on your needs\n  var totalPages \u003d Math.ceil(data.length / rowsPerPage);\n\n  var html \u003d \u0027\u003chtml\u003e\u003chead\u003e\u003cstyle\u003e\u0027;\n  html +\u003d \u0027@page { size: A4; margin: 0; }\u0027;\n  html +\u003d \u0027body { margin: 0; padding: 20mm 20mm 40mm 20mm; }\u0027;\n  html +\u003d \u0027table { width: 100%; border-collapse: collapse; margin-top: 120px; }\u0027; // Added margin-top\n  html +\u003d \u0027th, td { border: 1px solid black; padding: 5px; text-align: left; }\u0027;\n  html +\u003d \u0027header { position: fixed; top: 0; left: 0; right: 0; height: 100px; text-align: center; background: white; }\u0027;\n  html +\u003d \u0027footer { position: fixed; bottom: 0; left: 0; right: 0; height: 30px; text-align: center; background: white; }\u0027;\n  html +\u003d \u0027.page-break { page-break-before: always; }\u0027;\n  html +\u003d \u0027\u003c/style\u003e\u003c/head\u003e\u003cbody\u003e\u0027;\n\n  for (var page \u003d 1; page \u003c\u003d totalPages; page++) {\n    if (page \u003e 1) {\n      html +\u003d \u0027\u003cdiv class\u003d\"page-break\"\u003e\u003c/div\u003e\u0027;\n    }\n\n    html +\u003d \u0027\u003cheader\u003e\u003ch1\u003eLi Chuan Food Product Pte Ltd\u003c/h1\u003e\u003ch2\u003e\u0027 + monthName + \u0027 Report\u003c/h2\u003e\u003c/header\u003e\u0027;\n    html +\u003d \u0027\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u0027;\n    html +\u003d \u0027\u003cth\u003eItem Code\u003c/th\u003e\u003cth\u003eProduct Description\u003c/th\u003e\u003cth\u003ePacking\u003c/th\u003e\u003cth\u003eType\u003c/th\u003e\u003cth\u003eExpiry Date / Batch No\u003c/th\u003e\u003cth\u003eGRN\u003c/th\u003e\u003cth\u003eLineage Item Code\u003c/th\u003e\u003cth\u003eDate Stored\u003c/th\u003e\u003cth\u003eContainer\u003c/th\u003e\u003cth\u003eBAL. CTNS\u003c/th\u003e\u003cth\u003eBAL. PLTS\u003c/th\u003e\u0027;\n    html +\u003d \u0027\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u0027;\n\n    var startRow \u003d (page - 1) * rowsPerPage;\n    var endRow \u003d Math.min(page * rowsPerPage, data.length);\n\n    for (var i \u003d startRow; i \u003c endRow; i++) {\n      html +\u003d \u0027\u003ctr\u003e\u0027;\n      for (var j \u003d 0; j \u003c data[i].length; j++) {\n        html +\u003d \u0027\u003ctd\u003e\u0027 + data[i][j] + \u0027\u003c/td\u003e\u0027;\n      }\n      html +\u003d \u0027\u003c/tr\u003e\u0027;\n    }\n\n    html +\u003d \u0027\u003c/tbody\u003e\u003c/table\u003e\u0027;\n    html +\u003d \u0027\u003cfooter\u003ePage \u0027 + page + \u0027 of \u0027 + totalPages + \u0027\u003c/footer\u003e\u0027;\n  }\n\n  html +\u003d \u0027\u003c/body\u003e\u003c/html\u003e\u0027;\n  return html;\n}\nfunction createPdf(htmlContent) {\n  var blob \u003d Utilities.newBlob(htmlContent, \u0027text/html\u0027).getAs(\u0027application/pdf\u0027);\n  return blob;\n}\n\nfunction getMonthName(monthIndex) {\n  var monthNames \u003d [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n  return monthNames[monthIndex - 1];\n}\n\n"},{"id":"cf86b11b-92c3-4596-b280-7adb64d45315","name":"Maintenance","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n    \u003c?!\u003d include(\u0027CSS\u0027); ?\u003e\n\n        \u003cstyle\u003e\n        button {\n            margin: 2px;\n        }\n            .tab-container {\n        display: flex;\n        border-bottom: 1px solid #ccc;\n        margin-bottom: 20px;\n    }\n\n    /* Tab styles */\n    .tab {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 10px 15px;\n    cursor: pointer;\n    border: 1px solid #ccc;\n    border-bottom: none;\n    background-color: #f0f0f0;\n    margin-right: 5px;\n    border-radius: 5px 5px 0 0;\n}\n\n    /* Tab content styles (similar to your report CSS) */\n    .tab-content {\n        display: none;\n        padding: 20px;\n        background-color: #fff;\n        border: 1px solid #ccc;\n        border-radius: 5px;\n        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\n    }\n\n    .tab-content.active {\n        display: block;\n    }\n\n    .tab-content h2 {\n        font-size: 1.8em;\n        color: #333;\n        margin-bottom: 20px;\n        text-align: center;\n    }  display: block;\n\n\n.tab .close-tab:hover {\n    color: #000;\n}\n\n  #AddRecord {\n    max-width: 600px;\n    margin: 20px auto;\n    padding: 20px;\n    background-color: #fff;\n    border: 1px solid #ccc;\n    border-radius: 5px;\n    box-shadow: 0 2px 5px rgba(0,0,0,0.1);\n    font-family: Arial, sans-serif;\n  }\n\n  #AddRecord h2 {\n    font-size: 1.8em;\n    color: #333;\n    margin-bottom: 20px;\n    text-align: center;\n  }\n\n  #addRecordForm label {\n    display: block;\n    margin-top: 10px;\n    font-weight: bold;\n    color: #555;\n  }\n\n  #addRecordForm input[type\u003d\"date\"],\n  #addRecordForm input[type\u003d\"text\"],\n  #addRecordForm input[type\u003d\"number\"],\n  #addRecordForm select,\n  #addRecordForm textarea {\n    width: calc(100% - 20px);\n    padding: 8px;\n    margin-top: 4px;\n    margin-bottom: 10px;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-sizing: border-box;\n    outline: none;\n    transition: border-color 0.2s ease-in-out;\n  }\n\n  #addRecordForm input[type\u003d\"date\"]:focus,\n  #addRecordForm input[type\u003d\"text\"]:focus,\n  #addRecordForm input[type\u003d\"number\"]:focus,\n  #addRecordForm select:focus,\n  #addRecordForm textarea:focus {\n    border-color: #66afe9;\n  }\n\n  #addRecordForm button {\n    display: block;\n    width: 100%;\n    padding: 10px;\n    margin-top: 20px;\n    background-color: #4CAF50;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 1em;\n    transition: background-color 0.3s;\n  }\n\n  #addRecordForm button:hover {\n    background-color: #45a049;\n  }\n        \n    \u003c/style\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n    \u003cheader\u003e\n        \u003ch1\u003eInventory Management System\u003c/h1\u003e\n    \u003c/header\u003e\n        {{NAVBAR}}\n\n    \u003cmain\u003e\n      \u003cdiv class\u003d\"tab-container\"\u003e\n        \u003cdiv class\u003d\"tab active\" onclick\u003d\"activateTab(this, \u0027MaintenanceSection\u0027)\"\u003eMaintenance and Repair Log\u003c/div\u003e\n        \u003cdiv class\u003d\"tab\" onclick\u003d\"activateTab(this, \u0027AddRecord\u0027)\"\u003eAdd Record\u003c/div\u003e\n      \u003c/div\u003e\n\n      \u003cdiv id\u003d\"MaintenanceSection\" class\u003d\"tab-content active\"\u003e\n        \u003ch2\u003eMaintenance and Repair Log\u003c/h2\u003e\n        \u003ctable id\u003d\"maintenanceLogTable\"\u003e\u003c/table\u003e\n      \u003c/div\u003e\n\n      \u003cdiv id\u003d\"AddRecord\" class\u003d\"tab-content\"\u003e\n        \u003ch2\u003eAdd Record\u003c/h2\u003e\n        \u003cform id\u003d\"addRecordForm\"\u003e\n          \u003cdiv\u003e\n            \u003clabel for\u003d\"date\"\u003eDate:\u003c/label\u003e\n            \u003cinput type\u003d\"date\" id\u003d\"date\" name\u003d\"date\" required\u003e\n          \u003c/div\u003e\n          \u003cdiv\u003e\n            \u003clabel for\u003d\"type\"\u003eType:\u003c/label\u003e\n            \u003cselect id\u003d\"type\" name\u003d\"type\" required\u003e\n              \u003coption value\u003d\"\"\u003e--Select--\u003c/option\u003e\n              \u003coption value\u003d\"Forklift\"\u003eForklift\u003c/option\u003e\n              \u003coption value\u003d\"Truck\"\u003eTruck\u003c/option\u003e\n              \u003coption value\u003d\"Coldroom\"\u003eColdroom\u003c/option\u003e\n              \u003coption value\u003d\"Another\"\u003eAnother\u003c/option\u003e\n            \u003c/select\u003e\n          \u003c/div\u003e\n          \u003cdiv\u003e\n            \u003clabel for\u003d\"equipment\"\u003eEquipment:\u003c/label\u003e\n            \u003cselect id\u003d\"equipment\" name\u003d\"equipment\" required\u003e\n              \u003coption value\u003d\"\"\u003e--Select Type First--\u003c/option\u003e\n            \u003c/select\u003e\n            \u003cinput type\u003d\"text\" id\u003d\"equipmentText\" name\u003d\"equipmentText\" style\u003d\"display: none;\"\u003e\n          \u003c/div\u003e\n          \u003cdiv\u003e\n            \u003clabel for\u003d\"downTime\"\u003eDown Time:\u003c/label\u003e\n            \u003cinput type\u003d\"number\" id\u003d\"downTime\" name\u003d\"downTime\" required\u003e\n          \u003c/div\u003e\n          \u003cdiv\u003e\n            \u003clabel for\u003d\"serviceCompany\"\u003eService Company:\u003c/label\u003e\n            \u003cinput type\u003d\"text\" id\u003d\"serviceCompany\" name\u003d\"serviceCompany\" required\u003e\n          \u003c/div\u003e\n          \u003cdiv\u003e\n            \u003clabel for\u003d\"serviceNo\"\u003eService No:\u003c/label\u003e\n            \u003cinput type\u003d\"text\" id\u003d\"serviceNo\" name\u003d\"serviceNo\" required\u003e\n          \u003c/div\u003e\n          \u003cdiv\u003e\n            \u003clabel for\u003d\"remark\"\u003eRemark:\u003c/label\u003e\n            \u003ctextarea id\u003d\"remark\" name\u003d\"remark\"\u003e\u003c/textarea\u003e\n          \u003c/div\u003e\n          \u003cbutton type\u003d\"submit\"\u003eSubmit\u003c/button\u003e\n        \u003c/form\u003e\n      \u003c/div\u003e\n    \u003c/main\u003e\n    \n    \u003cscript\u003e\n      function activateTab(tabElement, sectionId) {\n        document.querySelectorAll(\u0027.tab\u0027).forEach(tab \u003d\u003e tab.classList.remove(\u0027active\u0027));\n        document.querySelectorAll(\u0027.tab-content\u0027).forEach(content \u003d\u003e content.classList.remove(\u0027active\u0027));\n        \n        tabElement.classList.add(\u0027active\u0027);\n        document.getElementById(sectionId).classList.add(\u0027active\u0027);\n      }\n\n      const equipmentLists \u003d {\n        Truck: [\"YN4970\"],\n        Coldroom: [\"Coldroom 1\", \"Coldroom 2\", \"Coldroom 3\", \"Coldroom 5\", \"Coldroom 6\", \"Coldroom 3A\", \"Coldroom 3B\", \"Blk 15\"],\n        Forklift: [\n          \"B15 FD20T(F180-00472)\",\n          \"CR5 7FBR10 - 51326(48V)\",\n          \"CR6 6FBR J9-10232(24V)\",\n          \"Orange : 8FBN 25(48V)\",\n          \"White : BRA10-50S-400(24V)\"\n        ]\n      };\n\n      function updateEquipmentOptions() {\n        const typeSelect \u003d document.getElementById(\u0027type\u0027);\n        const equipmentSelect \u003d document.getElementById(\u0027equipment\u0027);\n        const equipmentText \u003d document.getElementById(\u0027equipmentText\u0027);\n\n        if (typeSelect.value \u003d\u003d\u003d \u0027Another\u0027) {\n          equipmentSelect.style.display \u003d \u0027none\u0027;\n          equipmentText.style.display \u003d \u0027inline-block\u0027;\n          equipmentText.required \u003d true;\n          equipmentSelect.required \u003d false;\n        } else {\n          equipmentSelect.style.display \u003d \u0027inline-block\u0027;\n          equipmentText.style.display \u003d \u0027none\u0027;\n          equipmentSelect.required \u003d true;\n          equipmentText.required \u003d false;\n\n          equipmentSelect.innerHTML \u003d \u0027\u003coption value\u003d\"\"\u003e--Select Equipment--\u003c/option\u003e\u0027;\n\n          const equipmentList \u003d equipmentLists[typeSelect.value] || [];\n          equipmentList.forEach(function(equipment) {\n            const option \u003d document.createElement(\u0027option\u0027);\n            option.value \u003d equipment;\n            option.textContent \u003d equipment;\n            equipmentSelect.appendChild(option);\n          });\n        }\n      }\n\n      function formatDate(date) {\n        const d \u003d new Date(date);\n        return `${d.getDate().toString().padStart(2, \u00270\u0027)}/${(d.getMonth() + 1).toString().padStart(2, \u00270\u0027)}/${d.getFullYear()}`;\n      }\n\n      function submitForm(e) {\n        e.preventDefault();\n        const form \u003d document.getElementById(\u0027addRecordForm\u0027);\n        const formData \u003d new FormData(form);\n        const data \u003d Object.fromEntries(formData.entries());\n\n        data.date \u003d formatDate(data.date);\n\n        if (data.type \u003d\u003d\u003d \u0027Another\u0027) {\n          data.equipment \u003d data.equipmentText;\n        }\n        delete data.equipmentText;\n\n        google.script.run.withSuccessHandler(function() {\n          alert(\u0027Record added successfully!\u0027);\n          form.reset();\n          loadMaintenanceLog();\n        }).withFailureHandler(function(error) {\n          alert(\u0027Error: \u0027 + error.message);\n        }).addRecord(data);\n      }\n\n      function loadMaintenanceLog() {\n        google.script.run.withSuccessHandler(function(logData) {\n          const logTable \u003d document.getElementById(\u0027maintenanceLogTable\u0027);\n          logTable.innerHTML \u003d \u0027\u0027;\n\n          const header \u003d logTable.createTHead();\n          const headerRow \u003d header.insertRow(0);\n          [\u0027Date\u0027, \u0027Type\u0027, \u0027Equipment\u0027, \u0027Down Time\u0027, \u0027Service Company\u0027, \u0027Service No\u0027, \u0027Remark\u0027].forEach(text \u003d\u003e {\n            const th \u003d document.createElement(\u0027th\u0027);\n            th.textContent \u003d text;\n            headerRow.appendChild(th);\n          });\n\n          const body \u003d logTable.createTBody();\n          logData.forEach(row \u003d\u003e {\n            const tr \u003d body.insertRow();\n            row.forEach(cell \u003d\u003e {\n              const td \u003d tr.insertCell();\n              td.textContent \u003d cell;\n            });\n          });\n        }).getMaintenanceLog();\n      }\n\n      document.addEventListener(\u0027DOMContentLoaded\u0027, function() {\n        document.getElementById(\u0027type\u0027).addEventListener(\u0027change\u0027, updateEquipmentOptions);\n        document.getElementById(\u0027addRecordForm\u0027).addEventListener(\u0027submit\u0027, submitForm);\n        loadMaintenanceLog();\n      });\n    \u003c/script\u003e\n\n    \u003cfooter\u003e\n      \u003cp\u003e\u0026copy; 2024 Inventory Management System\u003c/p\u003e\n    \u003c/footer\u003e\n  \u003c/body\u003e\n\u003c/html\u003e"},{"id":"02b389da-674d-4832-83b7-d71ed503b0e6","name":"Maintenancegs","type":"server_js","source":"function getMaintenanceLog() {\n  const sheet \u003d SpreadsheetApp.openById(\u00271lUAufwyaiuHbq3cL7DveCQo6vgRLhtOhjVgZutdspDw\u0027).getSheetByName(\u0027Service Record\u0027);\n  const data \u003d sheet.getDataRange().getValues();\n  \n  // Remove header row, format date, and sort in descending order\n  return data.slice(1).map(row \u003d\u003e {\n    // Format the date as DD/MM/YYYY\n    const formattedDate \u003d Utilities.formatDate(new Date(row[0]), Session.getScriptTimeZone(), \"dd/MM/yyyy\");\n    return [formattedDate, ...row.slice(1)];\n  }).sort((a, b) \u003d\u003e {\n    const dateA \u003d parseDate(a[0]);\n    const dateB \u003d parseDate(b[0]);\n    return dateB - dateA;\n  });\n}\n\nfunction parseDate(dateString) {\n  const [day, month, year] \u003d dateString.split(\u0027/\u0027);\n  return new Date(year, month - 1, day); // month is 0-indexed in JavaScript Date\n}\n\nfunction addRecord(data) {\n  const sheet \u003d SpreadsheetApp.openById(\u00271lUAufwyaiuHbq3cL7DveCQo6vgRLhtOhjVgZutdspDw\u0027).getSheetByName(\u0027Service Record\u0027);\n  const newRow \u003d [\n    data.date,\n    data.type,\n    data.equipment,\n    data.downTime,\n    data.serviceCompany,\n    data.serviceNo,\n    data.remark\n  ];\n  sheet.insertRows(2, 1); // Insert a new row after the header\n  sheet.getRange(2, 1, 1, newRow.length).setValues([newRow]);\n}"},{"id":"e64f5850-c9b1-4751-b27c-493fbcfe0884","name":"Order","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n\u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n    \u003c?!\u003d include(\u0027CSS\u0027); ?\u003e\n    \u003cstyle\u003e\n\n      .tab-content {\n    max-width: 1000px;\n    margin: 20px auto;\n    padding: 20px;\n    background-color: #fff;\n    border: 1px solid #ccc;\n    border-radius: 5px;\n    box-shadow: 0 2px 5px rgba(0,0,0,0.1);\n    font-family: Arial, sans-serif;\n}\n\n/* Section heading */\n.tab-content h2 {\n    font-size: 1.8em;\n    color: #333;\n    margin-bottom: 20px;\n    text-align: center;\n}\n\n/* Label for inputs */\n.tab-content label {\n    display: block;\n    margin-top: 10px;\n    font-weight: bold;\n    color: #555;\n}\n\n/* Input fields */\n.tab-content input[type\u003d\"date\"],\n.tab-content input[type\u003d\"number\"],\n.tab-content input[type\u003d\"text\"],\n.tab-content select {\n    width: calc(100% - 20px);\n    padding: 8px;\n    margin-top: 4px;\n    margin-bottom: 10px;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-sizing: border-box;\n    outline: none;\n    transition: border-color 0.2s ease-in-out;\n}\n\n/* Input field focus styling */\n.tab-content input[type\u003d\"date\"]:focus,\n.tab-content input[type\u003d\"number\"]:focus,\n.tab-content input[type\u003d\"text\"]:focus,\n.tab-content select:focus {\n    border-color: #66afe9;\n}\n\n/* Button styling */\n.tab-content button {\n    display: block;\n    width: 100%;\n    padding: 10px;\n    margin-top: 20px;\n    background-color: #4CAF50;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 1em;\n    transition: background-color 0.3s;\n}\n\n/* Button hover effect */\n.tab-content button:hover {\n    background-color: #45a049;\n}\n\n/* Table styling */\n.tab-content table {\n    width: 100%;\n    border-collapse: collapse;\n    margin-top: 20px;\n    margin-bottom: 20px;\n}\n\n.tab-content th,\n.tab-content td {\n    border: 1px solid #ddd;\n    padding: 10px;\n    text-align: left;\n}\n\n.tab-content th {\n    background-color: #f0f0f0;\n    font-weight: bold;\n}\n\n.tab-content table input[type\u003d\"number\"] {\n    width: 80px;\n}\n.tab-content th {\n            text-transform: none;\n            text-align: center;  /* Center the text horizontally */\n            vertical-align: middle;  /* Center the text vertically */\n        }\n\n        /* Additional style for better visual separation */\n        .tab-content th, .tab-content td {\n            padding: 10px;\n            border: 1px solid #ddd;\n        }\n\n#cateringTable {\n    width: 100%;\n    border-collapse: collapse;\n}\n\n#cateringTable th, #cateringTable td {\n    border: 1px solid #ddd;\n    padding: 8px;\n    text-align: center; /* Center-align all cells by default */\n}\n\n#cateringTable th {\n    background-color: #f2f2f2;\n    font-size: 14px; /* Set font size for table headers to 14px */\n}\n\n/* Left-align product name cells */\n#cateringTable td:first-child,\n#cateringTable td:nth-child(5) {\n    text-align: left;\n}\n\n#cateringTable .editable {\n    min-width: 100px;\n}\n\n#cateringTable .editable:focus {\n    outline: none;\n    background-color: #e8f0fe;\n}\n\n/* Center-align table headers */\n#cateringTable th {\n    text-align: center;\n}\n        @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n        }\n\n    \u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n  \u003cbody onload\u003d\"activateTab(document.querySelector(\u0027.tab\u0027), \u0027SCORESection\u0027)\"\u003e\n    \u003cheader\u003e\n        \u003ch1\u003eInventory Management System\u003c/h1\u003e\n    \u003c/header\u003e\n    \u003cnav\u003e\n        {{NAVBAR}}\n    \u003c/nav\u003e\n    \u003cmain\u003e\n        \u003cdiv class\u003d\"tab-container\"\u003e\n            \u003cdiv class\u003d\"tab\" onclick\u003d\"activateTab(this, \u0027SCORESection\u0027)\"\u003eYellow Ribbon (SCORE)\u003c/div\u003e\n            \u003cdiv class\u003d\"tab\" onclick\u003d\"activateTab(this, \u0027CateringSection\u0027)\"\u003eFoodfare Catering \u0026 NTUC FoodFare\u003c/div\u003e\n            \u003cdiv class\u003d\"tab\" onclick\u003d\"activateTab(this, \u0027CMMSection\u0027)\"\u003eCMM\u003c/div\u003e\n        \u003c/div\u003e\n\n        \u003cdiv id\u003d\"loadingIndicator\" style\u003d\"display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: rgba(255,255,255,0.8); padding: 20px; border-radius: 5px; box-shadow: 0 0 10px rgba(0,0,0,0.1); z-index: 1000;\"\u003e\n            \u003cdiv style\u003d\"text-align: center;\"\u003e\n                \u003cdiv class\u003d\"spinner\" style\u003d\"border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto;\"\u003e\u003c/div\u003e\n                \u003cp style\u003d\"margin-top: 10px;\"\u003eLoading...\u003c/p\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n\n        \u003cdiv id\u003d\"SCORESection\" class\u003d\"tab-content\"\u003e\n    \u003ch2\u003eYellow Ribbon (SCORE)\u003c/h2\u003e\n    \u003cbutton id\u003d\"printReportBtn\" style\u003d\"margin-bottom: 20px;\"\u003ePrint Order\u003c/button\u003e\n    \u003ctable id\u003d\"scoreTable\"\u003e\n        \u003cthead\u003e\n            \u003ctr\u003e\n                \u003cth\u003eDelivery Date\u003c/th\u003e\n                \u003cth\u003eBOILED FISH BALL 鱼丸\u003c/th\u003e\n                \u003cth\u003eFRIED FISH CAKE 鱼饼\u003c/th\u003e\n                \u003cth\u003eSLICED FISH CAKE 切片\u003c/th\u003e\n                \u003cth\u003e结冰大鱼香 (20\u0027s) FISH NGOH HIANG (L)\u003c/th\u003e\n                \u003cth\u003e结冰炸云吞(50\u0027s) FRIED WANTON - (Frozen)\u003c/th\u003e\n            \u003c/tr\u003e\n        \u003c/thead\u003e\n        \u003ctbody\u003e\n            \u003c!-- Data will be populated here --\u003e\n        \u003c/tbody\u003e\n    \u003c/table\u003e\n\u003c/div\u003e\n  \n   \u003cdiv id\u003d\"CateringSection\" class\u003d\"tab-content\"\u003e\n            \u003ch2\u003eFoodfare Catering \u0026 NTUC FoodFare\u003c/h2\u003e\n            \u003cdiv id\u003d\"dateSelector\"\u003e\n                \u003clabel for\u003d\"selectedDate\"\u003eSelect Date:\u003c/label\u003e\n                \u003cinput type\u003d\"date\" id\u003d\"selectedDate\" onchange\u003d\"fetchCateringData()\"\u003e\n            \u003c/div\u003e\n            \u003cbutton id\u003d\"printCateringTable\" onclick\u003d\"printCateringTable()\"\u003ePrint Table\u003c/button\u003e\n            \u003ctable id\u003d\"cateringTable\"\u003e\n                \u003cthead\u003e\n                    \u003ctr\u003e\n                        \u003cth colspan\u003d\"4\" class\u003d\"main-header\"\u003eMei Peng - Foodfare Catering\u003c/th\u003e\n                        \u003cth colspan\u003d\"2\" class\u003d\"main-header\"\u003eXin Yi - NTUC Foodfare\u003c/th\u003e\n                    \u003c/tr\u003e\n                    \u003ctr class\u003d\"sub-header\"\u003e\n                    \u003cth\u003e产品名称\u003c/th\u003e\n                    \u003cth\u003e数量\u003c/th\u003e\n                    \u003cth\u003e生产批号\u003c/th\u003e\n                    \u003cth\u003e有效日期\u003c/th\u003e\n                    \u003cth\u003e产品名称\u003c/th\u003e\n                    \u003cth\u003e数量\u003c/th\u003e\n                    \u003c/tr\u003e\n                \u003c/thead\u003e\n                \u003ctbody\u003e\n                    \u003c!-- Data will be populated here --\u003e\n                \u003c/tbody\u003e\n            \u003c/table\u003e\n        \u003cbutton id\u003d\"submitCateringData\"\u003eSubmit\u003c/button\u003e\n    \u003c/div\u003e\n\n\n \u003c/main\u003e\n    \u003cfooter\u003e\n        \u003cp\u003e\u0026copy; 2024 Inventory Management System\u003c/p\u003e\n    \u003c/footer\u003e\n\n    \u003c?!\u003d include(\u0027OrderScript\u0027); ?\u003e\n        \u003cscript\u003e\n        \n    \u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e"},{"id":"2d68ca2e-00e1-44a9-a4eb-6ed82ef5170f","name":"OrderGS","type":"server_js","source":"function getSCOREData() {\n  const ss \u003d SpreadsheetApp.openById(\u002712K9NImc1eQm-hvBbep5_9i-vQdRRo5vdR9SdqysuQ80\u0027);\n  const sheet \u003d ss.getSheetByName(\u0027SCORE PO\u0027);\n  const data \u003d sheet.getDataRange().getValues();\n\n  // Remove header row\n  data.shift();\n\n  // Get current date\n  const currentDate \u003d new Date();\n  \n  // Calculate date ranges\n  const tenDaysAgo \u003d new Date(currentDate.getTime() - 10 * 24 * 60 * 60 * 1000);\n  const twentyDaysLater \u003d new Date(currentDate.getTime() + 20 * 24 * 60 * 60 * 1000);\n\n  // Format dates and filter data\n  const formattedData \u003d data\n    .map(row \u003d\u003e {\n      const date \u003d row[0];\n      const formattedDate \u003d Utilities.formatDate(date, \u0027GMT+8\u0027, \u0027yyyy-MM-dd\u0027);\n      return [formattedDate, ...row.slice(1)];\n    })\n    .filter(row \u003d\u003e {\n      const rowDate \u003d new Date(row[0]);\n      return rowDate \u003e\u003d tenDaysAgo \u0026\u0026 rowDate \u003c\u003d twentyDaysLater;\n    });\n\n  formattedData.sort((a, b) \u003d\u003e new Date(a[0]) - new Date(b[0]));\n\n  return formattedData;\n}\n\n//Catering and foodfare\nfunction getCateringData(selectedDate) {\n  try {\n    const ss \u003d SpreadsheetApp.openById(\u002712K9NImc1eQm-hvBbep5_9i-vQdRRo5vdR9SdqysuQ80\u0027);\n    \n    const foodfareCateringSheet \u003d ss.getSheetByName(\u0027Foodfare Catering PO\u0027);\n    const ntucFoodfareSheet \u003d ss.getSheetByName(\u0027NTUC Foodfare PO\u0027);\n    const foodfareCateringDateSheet \u003d ss.getSheetByName(\u0027Foodfare Catering Date\u0027);\n\n    if (!foodfareCateringSheet || !ntucFoodfareSheet || !foodfareCateringDateSheet) {\n      throw new Error(\u0027One or more required sheets not found\u0027);\n    }\n\n    const foodfareCateringData \u003d getDataFromSheet(foodfareCateringSheet, selectedDate, \u0027Foodfare Catering PO\u0027);\n    const ntucFoodfareData \u003d getDataFromSheet(ntucFoodfareSheet, selectedDate, \u0027NTUC Foodfare PO\u0027);\n    const previouslySubmittedData \u003d getPreviouslySubmittedData(foodfareCateringDateSheet, selectedDate);\n\n    let mergedFoodfareCateringData \u003d foodfareCateringData.map(item \u003d\u003e {\n      const previousData \u003d previouslySubmittedData.find(prev \u003d\u003e prev.productName \u003d\u003d\u003d item.productName);\n      return {\n        ...item,\n        batchNo: previousData ? previousData.batchNo : \u0027\u0027,\n        expDate: previousData ? previousData.expDate : \u0027\u0027\n      };\n    });\n\n    previouslySubmittedData.forEach(prevItem \u003d\u003e {\n      if (!mergedFoodfareCateringData.some(item \u003d\u003e item.productName \u003d\u003d\u003d prevItem.productName)) {\n        mergedFoodfareCateringData.push({\n          source: \u0027Foodfare Catering PO\u0027,\n          productName: prevItem.productName,\n          quantity: \u0027Not in current PO\u0027,\n          batchNo: prevItem.batchNo,\n          expDate: prevItem.expDate\n        });\n      }\n    });\n\n    const combinedData \u003d mergedFoodfareCateringData.concat(ntucFoodfareData);\n\n    return combinedData.length \u003e 0 ? combinedData : [];\n  } catch (error) {\n    return [];\n  }\n}\n\nfunction formatDateString(dateString) {\n  if (dateString instanceof Date) {\n    return Utilities.formatDate(dateString, Session.getScriptTimeZone(), \u0027dd/MM/yyyy\u0027);\n  } else if (typeof dateString \u003d\u003d\u003d \u0027string\u0027) {\n    if (/^\\d{2}\\/\\d{2}\\/\\d{4}$/.test(dateString)) {\n      return dateString;\n    }\n    const date \u003d new Date(dateString);\n    if (!isNaN(date.getTime())) {\n      return Utilities.formatDate(date, Session.getScriptTimeZone(), \u0027dd/MM/yyyy\u0027);\n    }\n  }\n  return dateString;\n}\n\nfunction getPreviouslySubmittedData(sheet, selectedDate) {\n  const data \u003d sheet.getDataRange().getValues();\n  const headers \u003d data[0];\n  \n  const dateColumnIndex \u003d headers.indexOf(\u0027Date\u0027);\n  const productNameColumnIndex \u003d headers.indexOf(\u0027Product Name\u0027);\n  const batchNoColumnIndex \u003d headers.indexOf(\u0027Batch No\u0027);\n  const expDateColumnIndex \u003d headers.indexOf(\u0027Exp Date\u0027);\n\n  if (dateColumnIndex \u003d\u003d\u003d -1 || productNameColumnIndex \u003d\u003d\u003d -1 || batchNoColumnIndex \u003d\u003d\u003d -1 || expDateColumnIndex \u003d\u003d\u003d -1) {\n    return [];\n  }\n\n  const [day, month, year] \u003d selectedDate.split(\u0027/\u0027);\n  const formattedSelectedDate \u003d `${year}-${month.padStart(2, \u00270\u0027)}-${day.padStart(2, \u00270\u0027)}`;\n\n  const filteredData \u003d data.slice(1)\n    .filter(row \u003d\u003e {\n      const rowDate \u003d row[dateColumnIndex];\n      if (rowDate instanceof Date \u0026\u0026 !isNaN(rowDate)) {\n        const formattedRowDate \u003d Utilities.formatDate(rowDate, Session.getScriptTimeZone(), \u0027yyyy-MM-dd\u0027);\n        return formattedRowDate \u003d\u003d\u003d formattedSelectedDate;\n      }\n      return false;\n    });\n\n  return filteredData.map(row \u003d\u003e ({\n    productName: row[productNameColumnIndex],\n    batchNo: row[batchNoColumnIndex].toString(),\n    expDate: formatDateString(row[expDateColumnIndex])\n  }));\n}\n\nfunction getDataFromSheet(sheet, selectedDate, source) {\n  const data \u003d sheet.getDataRange().getValues();\n  const headers \u003d data[0];\n  \n  const dateColumnIndex \u003d headers.indexOf(\u0027Delivery Date\u0027);\n  const productNameColumnIndex \u003d headers.indexOf(\u0027Product Description\u0027);\n  const quantityColumnIndex \u003d headers.indexOf(\u0027Quantity\u0027);\n\n  if (dateColumnIndex \u003d\u003d\u003d -1 || productNameColumnIndex \u003d\u003d\u003d -1 || quantityColumnIndex \u003d\u003d\u003d -1) {\n    return [];\n  }\n\n  const [day, month, year] \u003d selectedDate.split(\u0027/\u0027);\n  const formattedSelectedDate \u003d `${year}-${month.padStart(2, \u00270\u0027)}-${day.padStart(2, \u00270\u0027)}`;\n\n  const filteredData \u003d data.slice(1)\n    .filter(row \u003d\u003e {\n      const rowDate \u003d row[dateColumnIndex];\n      if (rowDate instanceof Date \u0026\u0026 !isNaN(rowDate)) {\n        const formattedRowDate \u003d Utilities.formatDate(rowDate, Session.getScriptTimeZone(), \u0027yyyy-MM-dd\u0027);\n        return formattedRowDate \u003d\u003d\u003d formattedSelectedDate;\n      }\n      return false;\n    });\n\n  return filteredData.map(row \u003d\u003e ({\n    source: source,\n    productName: row[productNameColumnIndex],\n    quantity: row[quantityColumnIndex].toString()\n  }));\n}\n\nfunction parseDateString(dateString) {\n  const [day, month, year] \u003d dateString.split(\u0027/\u0027).map(Number);\n  return new Date(year, month - 1, day); // month is 0-indexed in JavaScript Date\n}\n\n\nfunction saveCateringData(data) {\n  const ss \u003d SpreadsheetApp.openById(\u002712K9NImc1eQm-hvBbep5_9i-vQdRRo5vdR9SdqysuQ80\u0027);\n  const sheet \u003d ss.getSheetByName(\u0027Foodfare Catering Date\u0027);\n  \n  if (!sheet) {\n    throw new Error(\u0027Sheet \"Foodfare Catering Date\" not found\u0027);\n  }\n\n  // Prepare the data with headers\n  const dataWithHeaders \u003d [[\u0027Date\u0027, \u0027Product Name\u0027, \u0027Quantity\u0027, \u0027Batch No\u0027, \u0027Exp Date\u0027]].concat(data);\n\n  // Clear existing content and write new data\n  sheet.clear();\n  const range \u003d sheet.getRange(1, 1, dataWithHeaders.length, 5);\n  range.setValues(dataWithHeaders);\n\n  // Set the batch number column to text format\n  const batchNoColumn \u003d range.offset(0, 3, dataWithHeaders.length, 1);\n  batchNoColumn.setNumberFormat(\u0027@\u0027);\n}"},{"id":"7dacd272-5724-46e4-a2ca-5b57d1e41023","name":"OrderScript","type":"html","source":"\u003cscript\u003e\n\n\nfunction activateTab(selectedTab, contentId) {\n  // Hide all tab contents\n  var tabContents \u003d document.getElementsByClassName(\"tab-content\");\n  for (var i \u003d 0; i \u003c tabContents.length; i++) {\n    tabContents[i].style.display \u003d \"none\";\n  }\n\n  // Show the selected tab content\n  document.getElementById(contentId).style.display \u003d \"block\";\n\n  // Update active tab styling\n  var tabs \u003d document.getElementsByClassName(\"tab\");\n  for (var i \u003d 0; i \u003c tabs.length; i++) {\n    tabs[i].classList.remove(\"active\");\n  }\n  selectedTab.classList.add(\"active\");\n}\n//SCORE\ndocument.addEventListener(\u0027DOMContentLoaded\u0027, function() {\n    initializeTabs();\n    fetchSCOREData();\n\n    const printReportBtn \u003d document.getElementById(\u0027printReportBtn\u0027);\n    if (printReportBtn) {\n        printReportBtn.addEventListener(\u0027click\u0027, showPrintDialog);\n    }\n\n    const submitCateringDataBtn \u003d document.getElementById(\u0027submitCateringData\u0027);\n    if (submitCateringDataBtn) {\n        submitCateringDataBtn.addEventListener(\u0027click\u0027, submitCateringData);\n    }\n});\n\nfunction fetchSCOREData() {\n    google.script.run.withSuccessHandler(processSCOREData).getSCOREData();\n}\n\nfunction processSCOREData(data) {\n    const table \u003d document.getElementById(\u0027scoreTable\u0027).getElementsByTagName(\u0027tbody\u0027)[0];\n    table.innerHTML \u003d \u0027\u0027; // Clear existing data\n\n    const productNames \u003d [\n        \u0027YR - BOILED FISH BALL (1kg/pkt)\u0027,\n        \u0027YR - FRIED FISH CAKE (1kg/pkt)\u0027,\n        \u0027YR - SLICED FISH CAKE (1kg/pkt)\u0027,\n        \u0027结冰大鱼香 (20\\\u0027s) FISH NGOH HIANG (L) (Frozen)\u0027,\n        \u0027结冰炸云吞(50\\\u0027s) FRIED WANTON - (Frozen)\u0027\n    ];\n\n    // Sort data by date in descending order\n    data.sort((a, b) \u003d\u003e new Date(b[0]) - new Date(a[0]));\n\n    let currentDate \u003d null;\n    let currentRow \u003d null;\n    let quantities \u003d new Array(productNames.length).fill(0);\n\n    data.forEach(row \u003d\u003e {\n        const date \u003d new Date(row[0]);\n        const formattedDate \u003d `${date.getDate().toString().padStart(2, \u00270\u0027)}/${(date.getMonth() + 1).toString().padStart(2, \u00270\u0027)}/${date.getFullYear()}`;\n        \n        if (formattedDate !\u003d\u003d currentDate) {\n            if (currentRow) {\n                currentRow.innerHTML +\u003d quantities.map((q, index) \u003d\u003e `\u003ctd\u003e${formatQuantity(q, index)}\u003c/td\u003e`).join(\u0027\u0027);\n                table.appendChild(currentRow);\n                \n                // Add separator row\n                const separatorRow \u003d document.createElement(\u0027tr\u0027);\n                separatorRow.innerHTML \u003d \u0027\u003ctd colspan\u003d\"6\" style\u003d\"height: 10px; background-color: #f0f0f0;\"\u003e\u003c/td\u003e\u0027;\n                table.appendChild(separatorRow);\n            }\n            currentDate \u003d formattedDate;\n            currentRow \u003d document.createElement(\u0027tr\u0027);\n            currentRow.innerHTML \u003d `\u003ctd\u003e${currentDate}\u003c/td\u003e`;\n            quantities \u003d new Array(productNames.length).fill(0);\n        }\n\n        const productIndex \u003d productNames.indexOf(row[2]);\n        if (productIndex !\u003d\u003d -1) {\n            quantities[productIndex] +\u003d Number(row[5]) || 0;\n        }\n    });\n\n    if (currentRow) {\n        currentRow.innerHTML +\u003d quantities.map((q, index) \u003d\u003e `\u003ctd\u003e${formatQuantity(q, index)}\u003c/td\u003e`).join(\u0027\u0027);\n        table.appendChild(currentRow);\n    }\n}\n\nfunction formatQuantity(quantity, productIndex) {\n    if (quantity \u003d\u003d\u003d 0) {\n        return \u0027\u0027; // Return empty string for zero quantities\n    }\n\n    let ctnDivisor, pktDivisor;\n    if (productIndex \u003c\u003d 2) { // First three products\n        ctnDivisor \u003d 10;\n        pktDivisor \u003d 1;\n    } else if (productIndex \u003d\u003d\u003d 3) { // 结冰大鱼香\n        ctnDivisor \u003d 8;\n        pktDivisor \u003d 1;\n    } else { // 结冰炸云吞\n        ctnDivisor \u003d 4;\n        pktDivisor \u003d 1;\n    }\n\n    const ctns \u003d Math.floor(quantity / ctnDivisor);\n    const pkts \u003d quantity % ctnDivisor;\n\n    if (ctns \u003e 0) {\n        if (pkts \u003e 0) {\n            return `${ctns} Ctns ${pkts} Pkts`;\n        } else {\n            return `${ctns} Ctns`;\n        }\n    } else if (pkts \u003e 0) {\n        return `${pkts} Pkts`;\n    }\n}\n\nfunction showPrintDialog() {\n    const dates \u003d Array.from(document.querySelectorAll(\u0027#scoreTable tbody tr\u0027))\n        .filter(row \u003d\u003e {\n            // Filter out separator rows\n            if (row.getAttribute(\u0027style\u0027)?.includes(\u0027background-color\u0027)) {\n                return false;\n            }\n            // Check if any cell other than the date cell has content\n            for (let i \u003d 1; i \u003c row.cells.length; i++) {\n                if (row.cells[i].textContent.trim() !\u003d\u003d \u0027\u0027) {\n                    return true;\n                }\n            }\n            return false;\n        })\n        .map(row \u003d\u003e row.cells[0].textContent);\n    \n    const dialog \u003d document.createElement(\u0027div\u0027);\n    dialog.style.position \u003d \u0027fixed\u0027;\n    dialog.style.top \u003d \u002750%\u0027;\n    dialog.style.left \u003d \u002750%\u0027;\n    dialog.style.transform \u003d \u0027translate(-50%, -50%)\u0027;\n    dialog.style.backgroundColor \u003d \u0027white\u0027;\n    dialog.style.padding \u003d \u002720px\u0027;\n    dialog.style.border \u003d \u00271px solid black\u0027;\n    dialog.style.zIndex \u003d \u00271000\u0027;\n    \n    dialog.innerHTML \u003d `\n        \u003ch3\u003eSelect a date to print:\u003c/h3\u003e\n        \u003cselect id\u003d\"dateToPrint\"\u003e\n            ${dates.map(date \u003d\u003e `\u003coption value\u003d\"${date}\"\u003e${date}\u003c/option\u003e`).join(\u0027\u0027)}\n        \u003c/select\u003e\n        \u003cbutton onclick\u003d\"printReport()\"\u003ePrint\u003c/button\u003e\n        \u003cbutton onclick\u003d\"this.parentNode.remove()\"\u003eCancel\u003c/button\u003e\n    `;\n    \n    document.body.appendChild(dialog);\n}\n\nfunction printReport() {\n    const selectedDate \u003d document.getElementById(\u0027dateToPrint\u0027).value;\n    const row \u003d Array.from(document.querySelectorAll(\u0027#scoreTable tbody tr\u0027))\n        .filter(row \u003d\u003e !row.getAttribute(\u0027style\u0027)?.includes(\u0027background-color\u0027))\n        .find(row \u003d\u003e row.cells[0].textContent \u003d\u003d\u003d selectedDate);\n    \n    if (!row) return;\n\n    const printWindow \u003d window.open(\u0027\u0027, \u0027_blank\u0027, \u0027fullscreen\u003dyes,scrollbars\u003dyes\u0027);\n    \n    printWindow.document.write(\u0027\u003chtml\u003e\u003chead\u003e\u003ctitle\u003eSCORE Report\u003c/title\u003e\u0027);\n    printWindow.document.write(\u0027\u003cstyle\u003e\u0027);\n    printWindow.document.write(`\n    @page { size: Landscape; }\n        body { \n            font-family: Arial, sans-serif; \n            margin: 0;\n            padding: 20px;\n            box-sizing: border-box;\n            min-height: 100vh;\n            display: flex;\n            flex-direction: column;\n        }\n        .title { \n            font-size: 35px; \n            text-align: center; \n            margin-bottom: 20px; \n            font-weight: bold;\n        }\n        .content {\n            flex-grow: 1;\n        }\n        .item { \n            margin: 20px 0; \n        }\n        .item-name {\n            display: block;\n            margin-bottom: 10px;\n        }\n        .item-quantity {\n            display: block;\n            text-align: right;\n            font-weight: bold;\n        }\n        .footer { \n            font-size: 60px; \n            text-align: right; \n            position: fixed;\n            bottom: 5px;\n            right: 5px;\n        }\n        @media print {\n            @page { size: auto; margin: 10mm; }\n            body { \n                min-height: 0;\n                height: auto;\n            }\n            .footer {\n                position: fixed;\n                bottom: 10mm;\n                right: 10mm;\n            }\n        }\n    `);\n    printWindow.document.write(\u0027\u003c/style\u003e\u003c/head\u003e\u003cbody\u003e\u0027);\n    printWindow.document.write(\u0027\u003cdiv class\u003d\"title\"\u003eSCORE\u003c/div\u003e\u0027);\n    printWindow.document.write(\u0027\u003cdiv class\u003d\"content\"\u003e\u0027);\n\n    const items \u003d Array.from(row.cells).slice(1).filter(cell \u003d\u003e cell.textContent.trim() !\u003d\u003d \u0027\u0027);\n    const itemCount \u003d items.length;\n    \n    let fontSize;\n    if (itemCount \u003d\u003d\u003d 1) fontSize \u003d \u002780px\u0027;\n    else if (itemCount \u003d\u003d\u003d 2) fontSize \u003d \u002755px\u0027;\n    else if (itemCount \u003d\u003d\u003d 3) fontSize \u003d \u002745px\u0027;\n    else fontSize \u003d \u002740px\u0027;\n\n    let currentItemCount \u003d 1;\n    for (let i \u003d 1; i \u003c row.cells.length; i++) {\n        if (row.cells[i].textContent.trim() !\u003d\u003d \u0027\u0027) {\n            let itemName \u003d document.querySelector(\u0027#scoreTable thead th:nth-child(\u0027 + (i+1) + \u0027)\u0027).textContent;\n            let itemQuantity \u003d row.cells[i].textContent;\n            let additionalInfo \u003d \u0027\u0027;\n            \n            if ([\u0027BOILED FISH BALL 鱼丸\u0027, \u0027FRIED FISH CAKE 鱼饼\u0027, \u0027SLICED FISH CAKE 切片\u0027].includes(itemName)) {\n                additionalInfo \u003d \u00271kg x 10p\u0027;\n            } else if (itemName \u003d\u003d\u003d \u0027结冰大鱼香 (20\\\u0027s) FISH NGOH HIANG (L)\u0027) {\n                additionalInfo \u003d \u002720\\\u0027s x 8p\u0027;\n            } else if (itemName \u003d\u003d\u003d \u0027结冰炸云吞(50\\\u0027s) FRIED WANTON - (Frozen)\u0027) {\n                additionalInfo \u003d \u002750s x 4p\u0027;\n            }\n            \n            printWindow.document.write(`\u003cdiv class\u003d\"item\" style\u003d\"font-size: ${fontSize};\"\u003e`);\n            printWindow.document.write(`\u003cspan class\u003d\"item-name\"\u003e${currentItemCount}. ${itemName} ${additionalInfo}\u003c/span\u003e`);\n            printWindow.document.write(`\u003cspan class\u003d\"item-quantity\"\u003e${itemQuantity}\u003c/span\u003e`);\n            printWindow.document.write(`\u003c/div\u003e`);\n            \n            currentItemCount++;\n        }\n    }\n\n    printWindow.document.write(\u0027\u003c/div\u003e\u0027); // Close content div\n    printWindow.document.write(`\u003cdiv class\u003d\"footer\"\u003eDelivery Date: ${selectedDate}\u003c/div\u003e`);\n    printWindow.document.write(\u0027\u003c/body\u003e\u003c/html\u003e\u0027);\n    printWindow.document.close();\n\n    printWindow.moveTo(0, 0);\n    printWindow.resizeTo(screen.width, screen.height);\n\n    setTimeout(() \u003d\u003e {\n        printWindow.focus();\n        printWindow.print();\n        printWindow.close();\n    }, 250);\n\n    document.querySelector(\u0027div[style*\u003d\"position: fixed\"]\u0027).remove();\n}\n\n//Catering\nfunction fetchCateringData() {\n    const selectedDate \u003d document.getElementById(\u0027selectedDate\u0027).value;\n    if (!selectedDate) {\n        return;\n    }\n\n    const loadingIndicator \u003d document.getElementById(\u0027loadingIndicator\u0027);\n    if (loadingIndicator) {\n        loadingIndicator.style.display \u003d \u0027block\u0027;\n    }\n    \n    // Convert date to DD/MM/YYYY format\n    const [year, month, day] \u003d selectedDate.split(\u0027-\u0027);\n    const formattedDate \u003d `${day}/${month}/${year}`;\n\n    google.script.run\n        .withSuccessHandler(displayCateringData)\n        .withFailureHandler(handleError)\n        .getCateringData(formattedDate);\n}\n\nfunction displayCateringData(data) {\n    console.log(\u0027Displaying catering data:\u0027, data);\n    const tableBody \u003d document.querySelector(\u0027#cateringTable tbody\u0027);\n    if (!tableBody) {\n        console.error(\u0027Catering table body not found\u0027);\n        return;\n    }\n    tableBody.innerHTML \u003d \u0027\u0027;\n\n    const foodfareCatering \u003d combineProducts(data.filter(item \u003d\u003e item.source \u003d\u003d\u003d \u0027Foodfare Catering PO\u0027));\n    const ntucFoodfare \u003d combineProducts(data.filter(item \u003d\u003e item.source \u003d\u003d\u003d \u0027NTUC Foodfare PO\u0027));\n\n    console.log(\u0027Combined Foodfare Catering data:\u0027, foodfareCatering);\n    console.log(\u0027Combined NTUC Foodfare data:\u0027, ntucFoodfare);\n\n    const maxRows \u003d Math.max(foodfareCatering.length, ntucFoodfare.length);\n\n    for (let i \u003d 0; i \u003c maxRows; i++) {\n        const row \u003d tableBody.insertRow();\n        \n        if (i \u003c foodfareCatering.length) {\n            const item \u003d foodfareCatering[i];\n            const productCell \u003d row.insertCell(0);\n            productCell.textContent \u003d convertProductName(item.productName);\n            productCell.dataset.originalName \u003d item.productName;\n            \n            row.insertCell(1).textContent \u003d item.quantity;\n            \n            const batchNoCell \u003d row.insertCell(2);\n            batchNoCell.className \u003d \u0027editable\u0027;\n            batchNoCell.contentEditable \u003d true;\n            batchNoCell.textContent \u003d item.batchNo || \u0027\u0027;\n            \n            const expiryDateCell \u003d row.insertCell(3);\n            expiryDateCell.className \u003d \u0027editable\u0027;\n            expiryDateCell.contentEditable \u003d true;\n            expiryDateCell.textContent \u003d item.expDate || \u0027\u0027;\n        } else {\n            for (let j \u003d 0; j \u003c 4; j++) {\n                row.insertCell(j);\n            }\n        }\n\n        if (i \u003c ntucFoodfare.length) {\n            const item \u003d ntucFoodfare[i];\n            const productCell \u003d row.insertCell(4);\n            productCell.textContent \u003d convertProductName(item.productName);\n            productCell.dataset.originalName \u003d item.productName;\n            \n            row.insertCell(5).textContent \u003d item.quantity;\n        } else {\n            row.insertCell(4);\n            row.insertCell(5);\n        }\n    }\n\n    const loadingIndicator \u003d document.getElementById(\u0027loadingIndicator\u0027);\n    if (loadingIndicator) {\n        loadingIndicator.style.display \u003d \u0027none\u0027;\n    }\n}\n// Helper function to ensure convertProductName exists\nfunction convertProductName(name) {\n    const nameMap \u003d {\n        \"FOODFARE - ROUND FISH CAKE (10kg/ctn)\": \"圆饼\",\n        \"FOODFARE - SLICED FISH CAKE (10kg/ctn)\": \"切片饼\",\n        \"FOODFARE - LOBSTER BALL (10kg/ctn)\": \"龙虾丸\",\n        \"FOODFARE - MUSHROOM BALL (10kg/ctn)\": \"香菇丸\",\n        \"FOODFARE - PRAWN BALL (10kg/ctn)\": \"虾丸\",\n        \"FOODFARE - SEAFOOD STICK (10kg/ctn)\": \"海鲜条\",\n        \"FOODFARE - THAI FISH CAKE (10kg/ctn)\": \"(泰)饼\",\n        \"FOODFARE - CHUNKY FISH NUGGET (10kg/ctn)\": \"香脆鱼块\",\n        \"FOODFARE - BREADED FISH CHIP [FISH PATTY] (10kg/ctn)\": \"香脆鱼片\",\n        \"FOODFARE - CRAB MEAT CAKE (10kg/ctn)\": \"蟹肉饼\",\n        \"FOODFARE - NGOH HIANG (10kg/ctn)\": \"五香\",\n        \"FOODFARE - CUTTLEFISH BALL (10kg/ctn)\": \"苏东丸\",\n        \"FOODFARE - VEGETABLE FISH CAKE (CHILLI) (10kg/ctn)\": \"菜饼\",\n        \"FOODFARE - FISH BALL (10kg/ctn)\": \"鱼丸\",\n        \"FOODFARE - NGOH HIANG BALL (8pkts x 50pcs)\": \"五香粒\",\n        \"炸鱼丸(50\u0027s) FRIED FISH BALL\": \"炸丸(3A Chill)\"\n    };\n    return nameMap[name] || name;\n}\n\n// Ensure combineProducts function exists\nfunction combineProducts(products) {\n    const combinedProducts \u003d {};\n    products.forEach(product \u003d\u003e {\n        if (combinedProducts[product.productName]) {\n            combinedProducts[product.productName].quantity +\u003d product.quantity;\n        } else {\n            combinedProducts[product.productName] \u003d {...product};\n        }\n    });\n    return Object.values(combinedProducts);\n}\n\n        function handleError(error) {\n    console.error(\u0027Error:\u0027, error);\n    alert(\u0027An error occurred while fetching data. Please try again.\u0027);\n    const loadingIndicator \u003d document.getElementById(\u0027loadingIndicator\u0027);\n    if (loadingIndicator) {\n        loadingIndicator.style.display \u003d \u0027none\u0027;\n    }\n}\n\n// Add this function to ensure proper tab switching\nfunction initializeTabs() {\n    const tabs \u003d document.querySelectorAll(\u0027.tab\u0027);\n    tabs.forEach(tab \u003d\u003e {\n        tab.addEventListener(\u0027click\u0027, function() {\n            const contentId \u003d this.getAttribute(\u0027onclick\u0027).match(/\u0027(\\w+)\u0027/)[1];\n            activateTab(this, contentId);\n        });\n    });\n}\nfunction submitCateringData() {\n    const selectedDate \u003d document.getElementById(\u0027selectedDate\u0027)?.value;\n    if (!selectedDate) {\n        alert(\u0027Please select a date before submitting.\u0027);\n        return;\n    }\n\n    const tableRows \u003d document.querySelectorAll(\u0027#cateringTable tbody tr\u0027);\n    const dataToSubmit \u003d [];\n\n    tableRows.forEach(row \u003d\u003e {\n        const cells \u003d row.cells;\n        if (cells.length \u003c 4) return; // Skip rows with insufficient cells\n\n        const foodfareProductCell \u003d cells[0];\n        const foodfareProduct \u003d foodfareProductCell?.dataset?.originalName || foodfareProductCell?.textContent?.trim();\n        const foodfareQuantity \u003d cells[1]?.textContent?.trim();\n        const batchNo \u003d cells[2]?.textContent?.trim();\n        const expDate \u003d cells[3]?.textContent?.trim();\n\n        // Only save if either batch number or expiry date (or both) have a value\n        if (foodfareProduct \u0026\u0026 (batchNo || expDate)) {\n            // Preserve leading zeros by adding a single quote\n            const formattedBatchNo \u003d batchNo ? \"\u0027\" + batchNo : \u0027\u0027;\n            dataToSubmit.push([selectedDate, foodfareProduct, foodfareQuantity, formattedBatchNo, expDate]);\n        }\n    });\n\n    if (dataToSubmit.length \u003d\u003d\u003d 0) {\n        alert(\u0027No data to submit. Please fill in at least one batch number or expiry date.\u0027);\n        return;\n    }\n\n    const loadingIndicator \u003d document.getElementById(\u0027loadingIndicator\u0027);\n    if (loadingIndicator) {\n        loadingIndicator.style.display \u003d \u0027block\u0027;\n    }\n\n    google.script.run\n        .withSuccessHandler(onSubmitSuccess)\n        .withFailureHandler(handleSubmitError)\n        .saveCateringData(dataToSubmit);\n}\n\nfunction onSubmitSuccess() {\n    const loadingIndicator \u003d document.getElementById(\u0027loadingIndicator\u0027);\n    if (loadingIndicator) {\n        loadingIndicator.style.display \u003d \u0027none\u0027;\n    }\n    \n    // Convert all input fields to table-like text\n    const inputFields \u003d document.querySelectorAll(\u0027#cateringTable input\u0027);\n    inputFields.forEach(input \u003d\u003e {\n        const cellContent \u003d input.value;\n        const cell \u003d input.parentElement;\n        if (cell) {\n            cell.textContent \u003d cellContent;\n            cell.style.padding \u003d \u00278px\u0027; // Add some padding for better appearance\n        }\n    });\n\n    // Disable the submit button\n    const submitButton \u003d document.getElementById(\u0027submitCateringData\u0027);\n    if (submitButton) {\n        submitButton.disabled \u003d true;\n    }\n\n    alert(\u0027Data submitted successfully! The table has been updated.\u0027);\n}\n\nfunction handleSubmitError(error) {\n    const loadingIndicator \u003d document.getElementById(\u0027loadingIndicator\u0027);\n    if (loadingIndicator) {\n        loadingIndicator.style.display \u003d \u0027none\u0027;\n    }\n    console.error(\u0027Error:\u0027, error);\n    alert(\u0027An error occurred while submitting data. Please try again.\u0027);\n}\n\nfunction printCateringTable() {\n    const selectedDate \u003d document.getElementById(\u0027selectedDate\u0027).value;\n    if (!selectedDate) {\n        alert(\u0027Please select a date before printing.\u0027);\n        return;\n    }\n\n    const printWindow \u003d window.open(\u0027\u0027, \u0027_blank\u0027);\n    printWindow.document.write(\u0027\u003chtml\u003e\u003chead\u003e\u003ctitle\u003eFoodfare Catering \u0026 NTUC FoodFare\u003c/title\u003e\u0027);\n    printWindow.document.write(\u0027\u003cstyle\u003e\u0027);\n    printWindow.document.write(`\n        @page { size: Portrait; }\n        body { \n            font-family: Arial, sans-serif;\n            margin: 0;\n            padding: 20px;\n        }\n        table { \n            width: 100%; \n            border-collapse: collapse; \n            margin-top: 20px;\n        }\n        th, td { \n            border: 1px solid black; \n            padding: 8px; \n            text-align: left; \n        }\n        th { background-color: #f2f2f2; }\n        .header { \n            text-align: center; \n            margin-bottom: 20px; \n            font-size: 24px;\n            font-weight: bold;\n        }\n        .date { \n            text-align: center; \n            margin-bottom: 20px; \n            font-size: 16px;\n        }\n    `);\n    printWindow.document.write(\u0027\u003c/style\u003e\u003c/head\u003e\u003cbody\u003e\u0027);\n\n    // Add header\n    printWindow.document.write(\u0027\u003cdiv class\u003d\"header\"\u003eFoodfare Catering \u0026 NTUC FoodFare\u003c/div\u003e\u0027);\n\n    // Format date as DD/MM/YYYY\n    const [year, month, day] \u003d selectedDate.split(\u0027-\u0027);\n    const formattedDate \u003d `${day}/${month}/${year}`;\n    printWindow.document.write(`\u003cdiv class\u003d\"date\"\u003eDate: ${formattedDate}\u003c/div\u003e`);\n\n    // Get the table content\n    const table \u003d document.getElementById(\u0027cateringTable\u0027).cloneNode(true);\n    \n    // Remove any input fields and make cells editable\n    table.querySelectorAll(\u0027input\u0027).forEach(input \u003d\u003e {\n        const cell \u003d input.parentElement;\n        cell.textContent \u003d input.value;\n        cell.contentEditable \u003d true;\n    });\n\n    printWindow.document.write(table.outerHTML);\n    printWindow.document.write(\u0027\u003c/body\u003e\u003c/html\u003e\u0027);\n    printWindow.document.close();\n\n    printWindow.onload \u003d function() {\n        printWindow.focus();\n        printWindow.print();\n        printWindow.close();\n    };\n}\n\n    \u003c/script\u003e"},{"id":"e3d29e21-9394-4c77-93b2-4dc55bf99dde","name":"Packaging","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n    \u003c?!\u003d include(\u0027CSS\u0027); ?\u003e\n    \u003cstyle\u003e\n      .modal {\n        display: none; \n        position: fixed; \n        top: 0; \n        left: 0; \n        width: 100%; \n        height: 100%; \n        background-color: rgba(0, 0, 0, 0.5); \n        z-index: 1000; \n        overflow: auto;\n      }\n      .modal-content {\n        position: absolute; \n        top: 20%; \n        left: 50%; \n        transform: translate(-50%, -50%); \n        background-color: #fff; \n        border: 1px solid #ccc; \n        padding: 20px; \n        max-width: 80%; \n        max-height: 80%; \n        overflow-y: auto;\n      }\n      .close {\n        float: right; \n        font-size: 28px; \n        font-weight: bold;\n      }\n      .close:hover, .close:focus {\n        color: #000;\n        text-decoration: none;\n        cursor: pointer;\n      }\n      .hidden {\n        display: none;\n      }\n\n      #Adjustment {\n  padding: 20px;\n  background-color: #f9f9f9;\n  border-radius: 8px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n#Adjustment {\n    max-width: 1200px;  /* Increased width to accommodate the table */\n    margin: 20px auto;\n    padding: 20px;\n    background-color: #fff;\n    border: 1px solid #ccc;\n    border-radius: 5px;\n    box-shadow: 0 2px 5px rgba(0,0,0,0.1);\n    font-family: Arial, sans-serif;\n}\n\n/* Section heading */\n#Adjustment h2 {\n    font-size: 1.8em;\n    color: #333;\n    margin-bottom: 20px;\n    text-align: center;\n}\n\n/* Table styling */\n#adjustment-table {\n    width: 100%;\n    border-collapse: collapse;\n    margin-top: 20px;\n}\n\n#adjustment-table th,\n#adjustment-table td {\n    padding: 10px;\n    border: 1px solid #ddd;\n    text-align: left;\n}\n\n#adjustment-table th {\n    background-color: #f2f2f2;\n    font-weight: bold;\n    color: #333;\n}\n\n/* Input fields in table */\n#adjustment-table input[type\u003d\"number\"],\n#adjustment-table input[type\u003d\"text\"] {\n    width: calc(100% - 10px);\n    padding: 5px;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-sizing: border-box;\n    outline: none;\n    transition: border-color 0.2s ease-in-out;\n}\n\n#adjustment-table input[type\u003d\"number\"]:focus,\n#adjustment-table input[type\u003d\"text\"]:focus {\n    border-color: #66afe9;\n}\n\n/* Button styling */\n#Adjustment button {\n    display: block;\n    width: 100%;\n    padding: 10px;\n    margin-top: 20px;\n    background-color: #4CAF50;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 1em;\n    transition: background-color 0.3s;\n}\n\n/* Button hover effect */\n#Adjustment button:hover {\n    background-color: #45a049;\n}\n\n.table-resizer-container {\n            position: relative;\n            width: 100%;\n            overflow-x: auto;\n        }\n\n        .column-resizer {\n            position: absolute;\n            top: 0;\n            height: 100%;\n            width: 10px;\n            background: transparent;\n            cursor: col-resize;\n            z-index: 10;\n        }\n\n        .column-resizer:hover {\n            background: rgba(0, 0, 0, 0.1);\n        }\n\n        /* Prevent text selection during resize */\n        .no-select {\n            user-select: none;\n            -moz-user-select: none;\n            -webkit-user-select: none;\n            -ms-user-select: none;\n        }\n    \u003c/style\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n    \u003cscript src\u003d\"https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js\"\u003e\u003c/script\u003e\n\u003cscript src\u003d\"https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.20/jspdf.plugin.autotable.min.js\"\u003e\u003c/script\u003e\n    \n    \u003cheader\u003e\n      \u003ch1\u003eInventory Management System\u003c/h1\u003e\n    \u003c/header\u003e\n    {{NAVBAR}}\n\n    \u003cmain\u003e\n      \u003c!-- Navigation tabs --\u003e\n      \u003cdiv class\u003d\"tab-container\"\u003e\n        \u003cdiv class\u003d\"tab active\" onclick\u003d\"activateTab(this, \u0027inventory\u0027)\"\u003ePackaging Materials Summary\u003c/div\u003e\n        \u003cdiv class\u003d\"tab\" onclick\u003d\"activateTab(this, \u0027drawing-out-record\u0027)\"\u003eStock Out -\u003c/div\u003e\n        \u003cdiv class\u003d\"tab\" onclick\u003d\"activateTab(this, \u0027store-in-record\u0027)\"\u003eStock In +\u003c/div\u003e\n        \u003cdiv class\u003d\"tab\" onclick\u003d\"activateTab(this, \u0027Adjustment\u0027)\"\u003eAdjustment\u003c/div\u003e\n        \u003cdiv class\u003d\"tab\" onclick\u003d\"activateTab(this, \u0027report\u0027)\"\u003eReport\u003c/div\u003e\n      \u003c/div\u003e\n      \n      \u003c!-- Sections --\u003e\n      \u003csection id\u003d\"inventory\" class\u003d\"tab-content active\"\u003e\n        \u003ch2\u003ePackaging Materials Inventory Summary\u003c/h2\u003e\n        \u003clabel for\u003d\"search-input\"\u003eSearch by Name or ID:\u003c/label\u003e\n        \u003cinput type\u003d\"text\" id\u003d\"search-input\" oninput\u003d\"filterPackagingInventory()\" placeholder\u003d\"Search...\"\u003e\n        \u003ctable id\u003d\"inventory-table\"\u003e\n          \u003cthead\u003e\n            \u003ctr\u003e\n              \u003cth\u003eItem Code\u003c/th\u003e\n              \u003cth\u003eDescription\u003c/th\u003e\n              \u003cth\u003ePacking\u003c/th\u003e\n              \u003cth\u003eCatergory\u003c/th\u003e\n              \u003cth\u003eQuantity\u003c/th\u003e\n              \u003cth\u003eUOM\u003c/th\u003e\n            \u003c/tr\u003e\n          \u003c/thead\u003e\n          \u003ctbody id\u003d\"packaging-inventory\"\u003e\n            \u003c!-- Inventory data will be inserted here --\u003e\n          \u003c/tbody\u003e\n        \u003c/table\u003e\n      \u003c/section\u003e\n\n      \u003csection id\u003d\"drawing-out-record\" class\u003d\"tab-content\"\u003e\n        \u003ch2\u003eStock Out -\u003c/h2\u003e\n        \u003clabel for\u003d\"drawOutDate\"\u003eDate:\u003c/label\u003e\n        \u003cinput type\u003d\"date\" id\u003d\"drawOutDate\"\u003e\u003cbr\u003e\n        \u003cbutton id\u003d\"drawOutItemButton\" onclick\u003d\"showPackagingInventoryModal()\"\u003eSelect Item\u003c/button\u003e\u003cbr\u003e\n        \u003cdiv id\u003d\"selected-item-details\"\u003e\n          \u003ch3\u003eSelected Item\u003c/h3\u003e\n          \u003cp\u003eItem Code: \u003cspan id\u003d\"selected-item-code\"\u003e\u003c/span\u003e\u003c/p\u003e\n          \u003cp\u003eProduct Description: \u003cspan id\u003d\"selected-product-description\"\u003e\u003c/span\u003e\u003c/p\u003e\n          \u003cp\u003ePacking: \u003cspan id\u003d\"selected-packing\"\u003e\u003c/span\u003e\u003c/p\u003e\n          \u003cp\u003eCategory: \u003cspan id\u003d\"selected-Category\"\u003e\u003c/span\u003e\u003c/p\u003e\n          \u003cp\u003eQuantity: \u003cspan id\u003d\"selected-Quantity\"\u003e\u003c/span\u003e\u003c/p\u003e\n          \u003cp\u003eUOM: \u003cspan id\u003d\"selected-UOM\"\u003e\u003c/span\u003e\u003c/p\u003e\n          \u003clabel for\u003d\"input-quantity\"\u003eQuantity:\u003c/label\u003e\n          \u003cinput type\u003d\"number\" id\u003d\"input-quantity\" min\u003d\"1\"\u003e\u003cbr\u003e\n        \u003c/div\u003e\n        \u003cbutton onclick\u003d\"drawOutPackagingStock()\"\u003eDraw Out Stock\u003c/button\u003e\n      \u003c/section\u003e\n\n\n\n  \u003csection id\u003d\"store-in-record\" class\u003d\"tab-content\"\u003e\n  \u003ch2\u003eStock In +\u003c/h2\u003e\n  \u003clabel for\u003d\"storeInDate\"\u003eDate:\u003c/label\u003e\n  \u003cinput type\u003d\"date\" id\u003d\"storeInDate\"\u003e\u003cbr\u003e\n  \u003cbutton onclick\u003d\"showStoreInInventoryModal()\"\u003eSelect Item\u003c/button\u003e\u003cbr\u003e\n  \u003cdiv id\u003d\"store-in-selected-item-details\"\u003e\n    \u003ch3 id\u003d\"store-in-item-header\"\u003eSelected Item\u003c/h3\u003e\n    \u003cp\u003eItem Code: \u003cspan id\u003d\"store-in-selected-item-code\"\u003e\u003c/span\u003e\u003cinput type\u003d\"text\" id\u003d\"store-in-input-item-code\" class\u003d\"hidden\"\u003e\u003c/p\u003e\n    \u003cp\u003eProduct Description: \u003cspan id\u003d\"store-in-selected-product-description\"\u003e\u003c/span\u003e\u003cinput type\u003d\"text\" id\u003d\"store-in-input-product-description\" class\u003d\"hidden\"\u003e\u003c/p\u003e\n    \u003cp\u003ePacking: \u003cspan id\u003d\"store-in-selected-packing\"\u003e\u003c/span\u003e\u003cinput type\u003d\"text\" id\u003d\"store-in-input-packing\" class\u003d\"hidden\"\u003e\u003c/p\u003e\n    \u003cp\u003eCategory: \u003cspan id\u003d\"store-in-selected-category\"\u003e\u003c/span\u003e\u003cinput type\u003d\"text\" id\u003d\"store-in-input-category\" class\u003d\"hidden\"\u003e\u003c/p\u003e\n    \u003cp\u003eUOM: \u003cspan id\u003d\"store-in-selected-uom\"\u003e\u003c/span\u003e\u003cinput type\u003d\"text\" id\u003d\"store-in-input-uom\" class\u003d\"hidden\"\u003e\u003c/p\u003e\n    \u003clabel for\u003d\"store-in-input-quantity\"\u003eQuantity:\u003c/label\u003e\n    \u003cinput type\u003d\"number\" id\u003d\"store-in-input-quantity\" min\u003d\"1\"\u003e\u003cbr\u003e\n  \u003c/div\u003e\n  \u003cbutton onclick\u003d\"storeInPackagingStock()\"\u003eStock In\u003c/button\u003e\n\u003c/section\u003e\n\n\u003csection id\u003d\"Adjustment\" class\u003d\"tab-content\"\u003e\n  \u003ch2\u003eInventory Adjustment\u003c/h2\u003e\n  \u003ctable id\u003d\"adjustment-table\"\u003e\n    \u003cthead\u003e\n      \u003ctr\u003e\n        \u003cth\u003eItem Code\u003c/th\u003e\n        \u003cth\u003eProduct Description\u003c/th\u003e\n        \u003cth\u003eCurrent Quantity\u003c/th\u003e\n        \u003cth\u003eActual Count\u003c/th\u003e\n        \u003cth\u003eDifference\u003c/th\u003e\n        \u003cth\u003eReason for Discrepancy\u003c/th\u003e\n      \u003c/tr\u003e\n    \u003c/thead\u003e\n    \u003ctbody id\u003d\"adjustment-inventory\"\u003e\n      \u003c!-- Adjustment data will be inserted here --\u003e\n    \u003c/tbody\u003e\n  \u003c/table\u003e\n  \u003cbutton onclick\u003d\"initiateAdjustmentSubmission()\"\u003eSubmit Adjustment\u003c/button\u003e\n\u003c/section\u003e\n\n\u003csection id\u003d\"report\" class\u003d\"tab-content\"\u003e\n  \u003ch2\u003ePackaging Material Report\u003c/h2\u003e\n  \u003cdiv class\u003d\"report-options\"\u003e\n    \u003cdiv class\u003d\"report-option\" onclick\u003d\"generateAndDownloadPackagingPdf(\u0027endMonth\u0027)\"\u003e\n  \u003cspan\u003eGenerate End Month Report\u003c/span\u003e\n\u003c/div\u003e\n    \u003c/div\u003e\n\n  \u003c/div\u003e\n\u003c/section\u003e\n\n      \u003cdiv id\u003d\"myModal\" class\u003d\"modal\"\u003e\n        \u003cdiv class\u003d\"modal-content\"\u003e\n          \u003cspan class\u003d\"close\" onclick\u003d\"closePackagingModal()\"\u003e\u0026times;\u003c/span\u003e\n          \u003ch2\u003eSelect an Item\u003c/h2\u003e\n          \u003cinput type\u003d\"text\" id\u003d\"modal-search-input\" oninput\u003d\"filterPackagingModalInventory()\" placeholder\u003d\"Search by item code or description\"\u003e\n          \u003ctable id\u003d\"modal-inventory-table\"\u003e\n            \u003cthead\u003e\n              \u003ctr\u003e\n                \u003cth\u003eItem Code\u003c/th\u003e\n                \u003cth\u003eProduct Description\u003c/th\u003e\n                \u003cth\u003ePacking\u003c/th\u003e\n                \u003cth\u003eCategory\u003c/th\u003e\n                \u003cth\u003eQuantity\u003c/th\u003e\n                \u003cth\u003eUOM\u003c/th\u003e\n              \u003c/tr\u003e\n            \u003c/thead\u003e\n            \u003ctbody id\u003d\"modal-inventory-table-body\"\u003e\n              \u003c!-- Inventory data will be inserted here --\u003e\n            \u003c/tbody\u003e\n          \u003c/table\u003e\n        \u003c/div\u003e\n      \u003c/div\u003e\n\n      \u003cdiv id\u003d\"storeInModal\" class\u003d\"modal\"\u003e\n  \u003cdiv class\u003d\"modal-content\"\u003e\n    \u003cspan class\u003d\"close\" onclick\u003d\"closeStoreInModal()\"\u003e\u0026times;\u003c/span\u003e\n    \u003ch2\u003eSelect an Item for Store In\u003c/h2\u003e\n    \u003cinput type\u003d\"text\" id\u003d\"store-in-modal-search-input\" oninput\u003d\"filterStoreInModalInventory()\" placeholder\u003d\"Search by item code or description\"\u003e\n    \u003cbutton onclick\u003d\"prepareNewItem()\"\u003eNew Item\u003c/button\u003e\n    \u003ctable id\u003d\"store-in-modal-inventory-table\"\u003e\n      \u003cthead\u003e\n        \u003ctr\u003e\n          \u003cth\u003eItem Code\u003c/th\u003e\n          \u003cth\u003eProduct Description\u003c/th\u003e\n        \u003c/tr\u003e\n      \u003c/thead\u003e\n      \u003ctbody id\u003d\"store-in-modal-inventory-table-body\"\u003e\n        \u003c!-- Inventory data will be inserted here --\u003e\n      \u003c/tbody\u003e\n    \u003c/table\u003e\n  \u003c/div\u003e\n\u003c/div\u003e\n    \u003c/main\u003e\n\n    \u003cfooter\u003e\n      \u003cp\u003e\u0026copy; 2024 Inventory Management System\u003c/p\u003e\n    \u003c/footer\u003e\n\n    \u003c?!\u003d include(\u0027PackagingScript\u0027); ?\u003e\n\n\u003cscript\u003e\n\n\n\u003c/script\u003e\n\n  \u003c/body\u003e\n\u003c/html\u003e"},{"id":"23cf08a3-0be8-4298-b9fd-9cd6d3daaa3a","name":"PackagingScript","type":"html","source":"\u003cscript\u003e\nclass TableColumnResizer {\n            constructor(tableId) {\n                this.table \u003d document.getElementById(tableId);\n                this.headers \u003d this.table.querySelectorAll(\u0027thead tr th\u0027);\n                this.container \u003d null;\n                this.resizerElements \u003d [];\n                \n                this.init();\n            }\n\n            init() {\n                // Create container\n                this.container \u003d document.createElement(\u0027div\u0027);\n                this.container.className \u003d \u0027table-resizer-container\u0027;\n                \n                // Insert container before table\n                this.table.parentNode.insertBefore(this.container, this.table);\n                \n                // Move table into container\n                this.container.appendChild(this.table);\n\n                // Create resizers\n                this.headers.forEach((header, index) \u003d\u003e {\n                    const resizer \u003d this.createResizer(header, index);\n                    this.resizerElements.push(resizer);\n                    this.container.appendChild(resizer);\n                });\n\n                // Initial positioning\n                this.positionResizers();\n\n                // Reposition on window resize\n                window.addEventListener(\u0027resize\u0027, () \u003d\u003e this.positionResizers());\n            }\n\n            createResizer(header, index) {\n                const resizer \u003d document.createElement(\u0027div\u0027);\n                resizer.className \u003d \u0027column-resizer\u0027;\n                resizer.dataset.index \u003d index;\n\n                let isResizing \u003d false;\n                let startX, startWidth;\n\n                const onMouseMove \u003d (e) \u003d\u003e {\n                    if (!isResizing) return;\n                    \n                    const currentX \u003d e.clientX;\n                    const deltaX \u003d currentX - startX;\n                    \n                    // Get the current column\u0027s width\n                    const th \u003d this.headers[index];\n                    const newWidth \u003d startWidth + deltaX;\n                    \n                    // Apply width to column\n                    th.style.width \u003d `${Math.max(20, newWidth)}px`;\n                    \n                    // Optionally sync other header columns\n                    this.positionResizers();\n                };\n\n                const onMouseUp \u003d () \u003d\u003e {\n                    isResizing \u003d false;\n                    this.container.classList.remove(\u0027no-select\u0027);\n                    document.removeEventListener(\u0027mousemove\u0027, onMouseMove);\n                    document.removeEventListener(\u0027mouseup\u0027, onMouseUp);\n                };\n\n                resizer.addEventListener(\u0027mousedown\u0027, (e) \u003d\u003e {\n                    e.preventDefault();\n                    \n                    // Get header and its current width\n                    const th \u003d this.headers[index];\n                    startX \u003d e.clientX;\n                    startWidth \u003d th.offsetWidth;\n                    \n                    isResizing \u003d true;\n                    this.container.classList.add(\u0027no-select\u0027);\n                    \n                    document.addEventListener(\u0027mousemove\u0027, onMouseMove);\n                    document.addEventListener(\u0027mouseup\u0027, onMouseUp);\n                });\n\n                return resizer;\n            }\n\n            positionResizers() {\n                this.headers.forEach((header, index) \u003d\u003e {\n                    const resizer \u003d this.resizerElements[index];\n                    \n                    // Position resizer at the right edge of each header\n                    const rect \u003d header.getBoundingClientRect();\n                    const tableRect \u003d this.table.getBoundingClientRect();\n                    \n                    resizer.style.left \u003d `${rect.right - tableRect.left - 5}px`;\n                    resizer.style.height \u003d `${this.table.offsetHeight}px`;\n                });\n            }\n        }\n\n        // Initialize resizer when DOM is fully loaded\n        document.addEventListener(\u0027DOMContentLoaded\u0027, () \u003d\u003e {\n            new TableColumnResizer(\u0027inventory-table\u0027);\n        });\n  \nfunction activateTab(element, contentId) {\n  // Remove active class from all tabs\n  var tabs \u003d document.getElementsByClassName(\u0027tab\u0027);\n  for (var i \u003d 0; i \u003c tabs.length; i++) {\n    tabs[i].classList.remove(\u0027active\u0027);\n  }\n\n  // Add active class to the clicked tab\n  element.classList.add(\u0027active\u0027);\n\n  // Hide all tab content\n  var tabContents \u003d document.getElementsByClassName(\u0027tab-content\u0027);\n  for (var i \u003d 0; i \u003c tabContents.length; i++) {\n    tabContents[i].style.display \u003d \u0027none\u0027;\n  }\n\n  // Show the selected tab content\n  document.getElementById(contentId).style.display \u003d \u0027block\u0027;\n\n  // If the Adjustment tab is activated, call handleAdjustmentTab()\n  if (contentId \u003d\u003d\u003d \u0027Adjustment\u0027) {\n    handleAdjustmentTab();\n  }\n}\n\n      function initializeTabs() {\n        // Hide all tab contents except the first one\n        var tabContents \u003d document.getElementsByClassName(\u0027tab-content\u0027);\n        for (var i \u003d 0; i \u003c tabContents.length; i++) {\n          if (i \u003d\u003d\u003d 0) {\n            tabContents[i].style.display \u003d \u0027block\u0027;\n          } else {\n            tabContents[i].style.display \u003d \u0027none\u0027;\n          }\n        }\n        \n        // Activate the first tab\n        var firstTab \u003d document.querySelector(\u0027.tab\u0027);\n        if (firstTab) {\n          firstTab.classList.add(\u0027active\u0027);\n        }\n      }\n\n      document.addEventListener(\u0027DOMContentLoaded\u0027, function() {\n        var today \u003d new Date().toISOString().substr(0, 10);\n        document.getElementById(\u0027drawOutDate\u0027).value \u003d today;\n        document.getElementById(\u0027storeInDate\u0027).value \u003d today;\n        \n        // Initialize tabs\n        initializeTabs();\n      });\n\n      function loadpackagingInventoryData() {\n        google.script.run.withSuccessHandler(function(rowData) {\n          var tbody \u003d document.getElementById(\u0027packaging-inventory\u0027);\n          var html \u003d \"\";\n          \n          // Define the indices for each column\n          var columnIndices \u003d {\n            itemCode: 1,\n            description: 2,\n            packing: 3,\n            category: 0,\n            quantity: 4,\n            uom: 5\n          };\n          \n          for (var i \u003d 0; i \u003c rowData.length; i++) {\n            html +\u003d \"\u003ctr\u003e\";\n            html +\u003d \"\u003ctd\u003e\" + rowData[i][columnIndices.itemCode] + \"\u003c/td\u003e\";\n            html +\u003d \"\u003ctd\u003e\" + rowData[i][columnIndices.description] + \"\u003c/td\u003e\";\n            html +\u003d \"\u003ctd\u003e\" + rowData[i][columnIndices.packing] + \"\u003c/td\u003e\";\n            html +\u003d \"\u003ctd\u003e\" + rowData[i][columnIndices.category] + \"\u003c/td\u003e\";\n            html +\u003d \"\u003ctd\u003e\" + rowData[i][columnIndices.quantity] + \"\u003c/td\u003e\";\n            html +\u003d \"\u003ctd\u003e\" + rowData[i][columnIndices.uom] + \"\u003c/td\u003e\";\n            html +\u003d \"\u003c/tr\u003e\";\n          }\n          \n          tbody.innerHTML \u003d html;\n        }).getPackagingInventory();\n      }\n\n      // Load inventory data when the page loads\n      window.onload \u003d loadpackagingInventoryData;\n\n\n\n      //Draw Out\n\nfunction refreshInventoryModal() {\n  console.log(\"Starting refreshInventoryModal\");\n  var modalTableBody \u003d document.getElementById(\u0027modal-inventory-table-body\u0027);\n  if (!modalTableBody) {\n    console.error(\"Modal table body element not found\");\n    return;\n  }\n  modalTableBody.innerHTML \u003d \u0027\u0027;\n\n  google.script.run\n    .withSuccessHandler(function(data) {\n      console.log(\"Data received in refreshInventoryModal, items: \" + data.length);\n      if (data.length \u003d\u003d\u003d 0) {\n        console.log(\"No data received\");\n        return;\n      }\n      data.forEach(function(row, index) {\n        console.log(\"Processing row \" + index + \": \" + JSON.stringify(row));\n        if (parseFloat(row.quantity) \u003e 0) {\n          var newRow \u003d document.createElement(\u0027tr\u0027);\n          newRow.innerHTML \u003d `\n            \u003ctd\u003e${row.itemCode}\u003c/td\u003e\n            \u003ctd\u003e${row.description}\u003c/td\u003e\n            \u003ctd\u003e${row.packing}\u003c/td\u003e\n            \u003ctd\u003e${row.category}\u003c/td\u003e\n            \u003ctd\u003e${row.quantity}\u003c/td\u003e\n            \u003ctd\u003e${row.uom}\u003c/td\u003e\n          `;\n\n          newRow.addEventListener(\u0027click\u0027, function() {\n            console.log(\"Row clicked: \" + row.itemCode);\n            selectItem(row.itemCode, row.description, row.packing, row.category, row.quantity, row.uom);\n          });\n\n          modalTableBody.appendChild(newRow);\n        } else {\n          console.log(\"Skipping row due to zero quantity: \" + row.itemCode);\n        }\n      });\n      console.log(\"Modal refresh completed. Total rows added: \" + modalTableBody.children.length);\n    })\n    .withFailureHandler(function(error) {\n      console.error(\"Error in refreshInventoryModal: \" + error.toString());\n      alert(\"An error occurred while fetching inventory data. Please check the browser console for more details.\");\n    })\n    .getpackagingInventoryData();\n  \n  console.log(\"getpackagingInventoryData called. Waiting for response...\");\n}\n\n\nfunction showPackagingInventoryModal() {\n  refreshInventoryModal();\n  document.getElementById(\u0027myModal\u0027).style.display \u003d \u0027block\u0027;\n}\n\nfunction selectItem(itemCode, description, packing, category, quantity, uom) {\n  document.getElementById(\u0027selected-item-code\u0027).textContent \u003d itemCode;\n  document.getElementById(\u0027selected-product-description\u0027).textContent \u003d description;\n  document.getElementById(\u0027selected-packing\u0027).textContent \u003d packing;\n  document.getElementById(\u0027selected-Category\u0027).textContent \u003d category;\n  document.getElementById(\u0027selected-Quantity\u0027).textContent \u003d quantity;\n  document.getElementById(\u0027selected-UOM\u0027).textContent \u003d uom;\n\n  closePackagingModal();\n}\n\nfunction closePackagingModal() {\n  document.getElementById(\u0027myModal\u0027).style.display \u003d \u0027none\u0027;\n}\n\nfunction filterPackagingInventory() {\n  var input \u003d document.getElementById(\u0027search-input\u0027).value.toLowerCase();\n  var rows \u003d document.querySelectorAll(\u0027#packaging-inventory tr\u0027);\n  \n  rows.forEach(function(row) {\n    var itemCode \u003d row.cells[0].textContent.toLowerCase();\n    var description \u003d row.cells[1].textContent.toLowerCase();\n\n    if (itemCode.includes(input) || description.includes(input)) {\n      row.style.display \u003d \u0027\u0027;\n    } else {\n      row.style.display \u003d \u0027none\u0027;\n    }\n  });\n}\n\nfunction drawOutPackagingStock() {\n  var dateInput \u003d document.getElementById(\u0027drawOutDate\u0027).value;\n  var itemCode \u003d document.getElementById(\u0027selected-item-code\u0027).textContent;\n  var description \u003d document.getElementById(\u0027selected-product-description\u0027).textContent;\n  var packing \u003d document.getElementById(\u0027selected-packing\u0027).textContent;\n  var category \u003d document.getElementById(\u0027selected-Category\u0027).textContent;\n  var quantity \u003d document.getElementById(\u0027input-quantity\u0027).value;\n  var uom \u003d document.getElementById(\u0027selected-UOM\u0027).textContent;\n\n  google.script.run\n    .withSuccessHandler(function(result) {\n      alert(result);\n      clearSelectedItem();\n      refreshInventoryModal();\n      loadpackagingInventoryData();\n    })\n    .withFailureHandler(function(error) {\n      alert(\"Error: \" + error);\n    })\n    .drawOutPackagingStock(dateInput, itemCode, description, packing, category, quantity, uom);\n}\n\nfunction clearSelectedItem() {\n  document.getElementById(\u0027selected-item-code\u0027).textContent \u003d \u0027\u0027;\n  document.getElementById(\u0027selected-product-description\u0027).textContent \u003d \u0027\u0027;\n  document.getElementById(\u0027selected-packing\u0027).textContent \u003d \u0027\u0027;\n  document.getElementById(\u0027selected-Category\u0027).textContent \u003d \u0027\u0027;\n  document.getElementById(\u0027selected-Quantity\u0027).textContent \u003d \u0027\u0027;\n  document.getElementById(\u0027selected-UOM\u0027).textContent \u003d \u0027\u0027;\n  document.getElementById(\u0027input-quantity\u0027).value \u003d \u0027\u0027;\n}\n\nfunction filterPackagingModalInventory() {\n  var input \u003d document.getElementById(\u0027modal-search-input\u0027).value.toLowerCase();\n  var rows \u003d document.querySelectorAll(\u0027#modal-inventory-table-body tr\u0027);\n  \n  rows.forEach(function(row) {\n    var itemCode \u003d row.cells[0].textContent.toLowerCase();\n    var productDescription \u003d row.cells[1].textContent.toLowerCase();\n\n    if (itemCode.includes(input) || productDescription.includes(input)) {\n      row.classList.remove(\u0027hidden\u0027);\n    } else {\n      row.classList.add(\u0027hidden\u0027);\n    }\n  });\n}\n\n//Stock In\n\nfunction refreshStoreInInventoryModal() {\n  var modalTableBody \u003d document.getElementById(\u0027store-in-modal-inventory-table-body\u0027);\n  modalTableBody.innerHTML \u003d \u0027\u0027;\n\n  google.script.run.withSuccessHandler(function(data) {\n    // Skip the first row (header)\n    data.slice(1).forEach(function(row) {\n      var newRow \u003d document.createElement(\u0027tr\u0027);\n      newRow.innerHTML \u003d `\n        \u003ctd\u003e${row.itemCode}\u003c/td\u003e\n        \u003ctd\u003e${row.description}\u003c/td\u003e\n      `;\n\n      newRow.addEventListener(\u0027click\u0027, function() {\n        selectStoreInItem(row.itemCode, row.description, row.packing, row.category, row.uom);\n      });\n\n      modalTableBody.appendChild(newRow);\n    });\n  }).getpackagingInventoryData();\n}\n\nfunction showStoreInInventoryModal() {\n  refreshStoreInInventoryModal();\n  document.getElementById(\u0027storeInModal\u0027).style.display \u003d \u0027block\u0027;\n}\n\nfunction selectStoreInItem(itemCode, description, packing, category, uom) {\n  // Reset the form to its original state\n  clearStoreInSelectedItem();\n  \n  // Populate the fields with the selected item\u0027s information\n  document.getElementById(\u0027store-in-selected-item-code\u0027).textContent \u003d itemCode;\n  document.getElementById(\u0027store-in-selected-product-description\u0027).textContent \u003d description;\n  document.getElementById(\u0027store-in-selected-packing\u0027).textContent \u003d packing;\n  document.getElementById(\u0027store-in-selected-category\u0027).textContent \u003d category;\n  document.getElementById(\u0027store-in-selected-uom\u0027).textContent \u003d uom;\n\n  closeStoreInModal();\n}\n\nfunction closeStoreInModal() {\n  document.getElementById(\u0027storeInModal\u0027).style.display \u003d \u0027none\u0027;\n}\n\nfunction filterStoreInModalInventory() {\n  var input \u003d document.getElementById(\u0027store-in-modal-search-input\u0027).value.toLowerCase();\n  var rows \u003d document.querySelectorAll(\u0027#store-in-modal-inventory-table-body tr\u0027);\n  \n  rows.forEach(function(row) {\n    var itemCode \u003d row.cells[0].textContent.toLowerCase();\n    var description \u003d row.cells[1].textContent.toLowerCase();\n\n    if (itemCode.includes(input) || description.includes(input)) {\n      row.style.display \u003d \u0027\u0027;\n    } else {\n      row.style.display \u003d \u0027none\u0027;\n    }\n  });\n}\n\nfunction storeInPackagingStock() {\n  var dateInput \u003d document.getElementById(\u0027storeInDate\u0027).value;\n  var isNewItem \u003d document.getElementById(\u0027store-in-input-item-code\u0027).classList.contains(\u0027hidden\u0027) \u003d\u003d\u003d false;\n  \n  var itemCode, description, packing, category, uom;\n  \n  if (isNewItem) {\n    itemCode \u003d document.getElementById(\u0027store-in-input-item-code\u0027).value;\n    description \u003d document.getElementById(\u0027store-in-input-product-description\u0027).value;\n    packing \u003d document.getElementById(\u0027store-in-input-packing\u0027).value;\n    category \u003d document.getElementById(\u0027store-in-input-category\u0027).value;\n    uom \u003d document.getElementById(\u0027store-in-input-uom\u0027).value;\n  } else {\n    itemCode \u003d document.getElementById(\u0027store-in-selected-item-code\u0027).textContent;\n    description \u003d document.getElementById(\u0027store-in-selected-product-description\u0027).textContent;\n    packing \u003d document.getElementById(\u0027store-in-selected-packing\u0027).textContent;\n    category \u003d document.getElementById(\u0027store-in-selected-category\u0027).textContent;\n    uom \u003d document.getElementById(\u0027store-in-selected-uom\u0027).textContent;\n  }\n  \n  var quantity \u003d document.getElementById(\u0027store-in-input-quantity\u0027).value;\n\n  google.script.run\n    .withSuccessHandler(function(result) {\n      alert(result);\n      clearStoreInSelectedItem();\n      refreshStoreInInventoryModal();\n      loadpackagingInventoryData();\n    })\n    .withFailureHandler(function(error) {\n      alert(\"Error: \" + error);\n    })\n    .storeInPackagingStock(dateInput, itemCode, description, packing, category, quantity, uom, isNewItem);\n}\n\nfunction clearStoreInSelectedItem() {\n  document.getElementById(\u0027store-in-item-header\u0027).textContent \u003d \u0027Selected Item\u0027;\n  \n  [\u0027item-code\u0027, \u0027product-description\u0027, \u0027packing\u0027, \u0027category\u0027, \u0027uom\u0027].forEach(field \u003d\u003e {\n    document.getElementById(`store-in-selected-${field}`).textContent \u003d \u0027\u0027;\n    document.getElementById(`store-in-selected-${field}`).classList.remove(\u0027hidden\u0027);\n    document.getElementById(`store-in-input-${field}`).value \u003d \u0027\u0027;\n    document.getElementById(`store-in-input-${field}`).classList.add(\u0027hidden\u0027);\n  });\n  \n  document.getElementById(\u0027store-in-input-quantity\u0027).value \u003d \u0027\u0027;\n}\n\nfunction prepareNewItem() {\n  clearStoreInSelectedItem();\n  document.getElementById(\u0027store-in-item-header\u0027).textContent \u003d \u0027Please fill in the information\u0027;\n  \n  // Show input fields for new item\n  [\u0027item-code\u0027, \u0027product-description\u0027, \u0027packing\u0027, \u0027category\u0027, \u0027uom\u0027].forEach(field \u003d\u003e {\n    document.getElementById(`store-in-selected-${field}`).classList.add(\u0027hidden\u0027);\n    document.getElementById(`store-in-input-${field}`).classList.remove(\u0027hidden\u0027);\n  });\n  \n  closeStoreInModal();\n}\n\n//Report\n\nfunction generateAndDownloadPackagingPdf() {\n  showLoading(); // Show loading indicator\n\n  const date \u003d new Date();\n  const monthName \u003d date.toLocaleString(\u0027default\u0027, { month: \u0027long\u0027 });\n  const year \u003d date.getFullYear();\n  const sheetName \u003d `${monthName} ${year} End Month Report`;\n\n  google.script.run\n    .withSuccessHandler(function(result) {\n      if (result.sheetExists) {\n        if (confirm(`The sheet \"${sheetName}\" already exists. Do you want to replace it?`)) {\n          createAndDownloadReport(sheetName, true);\n        } else {\n          createAndDownloadReport(sheetName, false);\n        }\n      } else {\n        createAndDownloadReport(sheetName, false);\n      }\n    })\n    .withFailureHandler(function(error) {\n      console.error(\u0027Error checking if sheet exists:\u0027, error);\n      alert(\u0027An error occurred while checking if the sheet exists. Please try again.\u0027);\n      hideLoading(); // Hide loading indicator on error\n    })\n    .checkPackagingSheetExists(sheetName);\n}\n\nfunction createAndDownloadReport(sheetName, replace) {\n  google.script.run\n    .withSuccessHandler(function(data) {\n      google.script.run\n        .withSuccessHandler(function(fontData) {\n          const { jsPDF } \u003d window.jspdf;\n          const doc \u003d new jsPDF({\n            unit: \u0027mm\u0027,\n            format: \u0027a4\u0027,\n            orientation: \u0027portrait\u0027\n          });\n\n          doc.addFileToVFS(\u0027NotoSansSC-Medium.ttf\u0027, fontData);\n          doc.addFont(\u0027NotoSansSC-Medium.ttf\u0027, \u0027NotoSansSC\u0027, \u0027normal\u0027);\n          doc.setFont(\u0027NotoSansSC\u0027);\n\n          // Add title\n          doc.setFontSize(10);\n          doc.setTextColor(0);\n          var text \u003d \u0027Packaging Material \u0027 + sheetName;\n          doc.text(text, doc.internal.pageSize.width / 2, 10, null, null, \u0027center\u0027);\n\n          // Add table\n          doc.setFontSize(6);\n          const headers \u003d data[1];\n          const body \u003d data.slice(2);\n\n          doc.autoTable({\n            head: [headers.slice(1).concat([\u0027\u0027])],\n            body: body.map(row \u003d\u003e row.slice(1).concat([\u0027\u0027])),\n            startY: 15,\n            theme: \u0027grid\u0027,\n            styles: { \n              font: \u0027NotoSansSC\u0027, \n              fontStyle: \u0027bold\u0027,\n              fontSize: 10,\n              lineColor: 0,\n              lineWidth: 0.1\n            },\n            headStyles: {\n              fillColor: 255,\n              lineWidth: 0.1\n            },\n            alternateRowStyles: {\n              fillColor: 255\n            },\n            margin: { left: 0, top: 0, right: 0, bottom: 0 },\n            tableWidth: \u0027full\u0027,\n            columnStyles: {\n              [headers.length - 2]: { cellWidth: \u0027auto\u0027 },\n              [headers.length - 1]: { cellWidth: 20 }\n            },\n            didParseCell: function(data) {\n              data.cell.styles.textColor \u003d [0, 0, 0];\n            }\n          });\n\n          // Save the PDF\n          doc.save(\u0027Packaging Material \u0027 + sheetName + \u0027.pdf\u0027);\n          hideLoading(); // Hide loading indicator after PDF is generated\n        })\n        .withFailureHandler(function(error) {\n          console.error(\u0027Error loading font:\u0027, error);\n          alert(\u0027An error occurred while loading the font. Please try again.\u0027);\n          hideLoading(); // Hide loading indicator on error\n        })\n        .getFont();\n    })\n    .withFailureHandler(function(error) {\n      console.error(\u0027Error creating report:\u0027, error);\n      alert(\u0027An error occurred while creating the report. Please try again.\u0027);\n      hideLoading(); // Hide loading indicator on error\n    })\n    .getPackagingReportData(sheetName, replace);\n}\n\n// Function to show loading indicator\nfunction showLoading() {\n  // Create loading overlay if it doesn\u0027t exist\n  if (!document.getElementById(\u0027loadingOverlay\u0027)) {\n    const overlay \u003d document.createElement(\u0027div\u0027);\n    overlay.id \u003d \u0027loadingOverlay\u0027;\n    overlay.style.position \u003d \u0027fixed\u0027;\n    overlay.style.top \u003d \u00270\u0027;\n    overlay.style.left \u003d \u00270\u0027;\n    overlay.style.width \u003d \u0027100%\u0027;\n    overlay.style.height \u003d \u0027100%\u0027;\n    overlay.style.backgroundColor \u003d \u0027rgba(0, 0, 0, 0.5)\u0027;\n    overlay.style.display \u003d \u0027flex\u0027;\n    overlay.style.justifyContent \u003d \u0027center\u0027;\n    overlay.style.alignItems \u003d \u0027center\u0027;\n    overlay.style.zIndex \u003d \u00279999\u0027;\n\n    const spinner \u003d document.createElement(\u0027div\u0027);\n    spinner.style.border \u003d \u00274px solid #f3f3f3\u0027;\n    spinner.style.borderTop \u003d \u00274px solid #3498db\u0027;\n    spinner.style.borderRadius \u003d \u002750%\u0027;\n    spinner.style.width \u003d \u002740px\u0027;\n    spinner.style.height \u003d \u002740px\u0027;\n    spinner.style.animation \u003d \u0027spin 1s linear infinite\u0027;\n\n    overlay.appendChild(spinner);\n    document.body.appendChild(overlay);\n\n    // Add keyframe animation for spinner\n    const style \u003d document.createElement(\u0027style\u0027);\n    style.textContent \u003d `\n      @keyframes spin {\n        0% { transform: rotate(0deg); }\n        100% { transform: rotate(360deg); }\n      }\n    `;\n    document.head.appendChild(style);\n  }\n\n  document.getElementById(\u0027loadingOverlay\u0027).style.display \u003d \u0027flex\u0027;\n}\n\n// Function to hide loading indicator\nfunction hideLoading() {\n  const overlay \u003d document.getElementById(\u0027loadingOverlay\u0027);\n  if (overlay) {\n    overlay.style.display \u003d \u0027none\u0027;\n  }\n}\n\n//Adjustment\n\nfunction handleAdjustmentTab() {\n  console.log(\"Handling Adjustment tab\");\n  populateAdjustmentTable();\n}\n\nfunction populateAdjustmentTable() {\n  console.log(\"Populating adjustment table\");\n  const adjustmentInventory \u003d document.getElementById(\u0027adjustment-inventory\u0027);\n  adjustmentInventory.innerHTML \u003d \u0027\u0027; // Clear existing rows\n\n  const packagingInventory \u003d document.getElementById(\u0027packaging-inventory\u0027);\n  const rows \u003d packagingInventory.getElementsByTagName(\u0027tr\u0027);\n  console.log(\"Number of rows found:\", rows.length);\n\n  for (let row of rows) {\n    const cells \u003d row.getElementsByTagName(\u0027td\u0027);\n    if (cells.length \u003e 0) {\n      const newRow \u003d adjustmentInventory.insertRow();\n      \n      // Item Code\n      newRow.insertCell().textContent \u003d cells[0].textContent;\n      \n      // Product Description\n      newRow.insertCell().textContent \u003d cells[1].textContent;\n      \n      // Current Quantity\n      const currentQuantity \u003d cells[4].textContent;\n      newRow.insertCell().textContent \u003d currentQuantity;\n      \n      // Actual Count (input field)\n      const actualCountCell \u003d newRow.insertCell();\n      const actualCountInput \u003d document.createElement(\u0027input\u0027);\n      actualCountInput.type \u003d \u0027number\u0027;\n      actualCountInput.min \u003d \u00270\u0027;\n      actualCountInput.oninput \u003d function() { updateDifference(this); };\n      actualCountCell.appendChild(actualCountInput);\n      \n      // Difference (calculated field)\n      const differenceCell \u003d newRow.insertCell();\n      differenceCell.textContent \u003d \u00270\u0027;\n      \n      // Reason for Discrepancy (input field)\n      const reasonCell \u003d newRow.insertCell();\n      const reasonInput \u003d document.createElement(\u0027input\u0027);\n      reasonInput.type \u003d \u0027text\u0027;\n      reasonCell.appendChild(reasonInput);\n    }\n  }\n}\n\nfunction updateDifference(input) {\n  const row \u003d input.closest(\u0027tr\u0027);\n  const currentQuantity \u003d parseInt(row.cells[2].textContent);\n  const actualCount \u003d parseInt(input.value) || 0;\n  const difference \u003d actualCount - currentQuantity;\n  row.cells[4].textContent \u003d difference;\n}\n\nfunction initiateAdjustmentSubmission() {\n  var adjustmentData \u003d collectAdjustmentData();\n  google.script.run\n    .withSuccessHandler(onAdjustmentSuccess)\n    .withFailureHandler(onAdjustmentFailure)\n    .submitAdjustment(adjustmentData);\n}\n\nfunction collectAdjustmentData() {\n  var table \u003d document.getElementById(\u0027adjustment-table\u0027);\n  var rows \u003d table.getElementsByTagName(\u0027tr\u0027);\n  var adjustmentData \u003d [];\n\n  for (var i \u003d 1; i \u003c rows.length; i++) { // Start from 1 to skip header row\n    var cells \u003d rows[i].getElementsByTagName(\u0027td\u0027);\n    var itemCode \u003d cells[0].textContent;\n    var description \u003d cells[1].textContent;\n    var currentQuantity \u003d parseInt(cells[2].textContent);\n    var actualCount \u003d parseInt(cells[3].getElementsByTagName(\u0027input\u0027)[0].value);\n    var difference \u003d parseInt(cells[4].textContent);\n    var reason \u003d cells[5].getElementsByTagName(\u0027input\u0027)[0].value;\n    \n    if (!isNaN(actualCount) \u0026\u0026 actualCount !\u003d\u003d currentQuantity) {\n      adjustmentData.push({\n        itemCode: itemCode,\n        description: description,\n        currentQuantity: currentQuantity,\n        actualCount: actualCount,\n        difference: difference,\n        reason: reason\n      });\n    }\n  }\n\n  return adjustmentData;\n}\n\nfunction onAdjustmentSuccess(updatedData) {\n  console.log(\"onAdjustmentSuccess called with data:\", updatedData);\n  alert(\u0027Adjustment submitted successfully!\u0027);\n  \n  // Update the packaging inventory table\n  updatePackagingInventoryTable(updatedData);\n  \n  // Reset the adjustment table\n  resetAdjustmentTable(updatedData);\n}\n\nfunction updatePackagingInventoryTable(updatedData) {\n  var table \u003d document.getElementById(\u0027packaging-inventory\u0027);\n  var rows \u003d table.getElementsByTagName(\u0027tr\u0027);\n\n  updatedData.forEach(function(item) {\n    for (var i \u003d 0; i \u003c rows.length; i++) {\n      var cells \u003d rows[i].getElementsByTagName(\u0027td\u0027);\n      if (cells.length \u003e 0 \u0026\u0026 cells[0].textContent \u003d\u003d\u003d item.itemCode) {\n        cells[1].textContent \u003d item.description;\n        cells[2].textContent \u003d item.packing;\n        cells[3].textContent \u003d item.category;\n        cells[4].textContent \u003d item.quantity;\n        cells[5].textContent \u003d item.uom;\n        break;\n      }\n    }\n  });\n}\n\nfunction resetAdjustmentTable(updatedData) {\n  var table \u003d document.getElementById(\u0027adjustment-table\u0027);\n  var rows \u003d table.getElementsByTagName(\u0027tr\u0027);\n\n  for (var i \u003d 1; i \u003c rows.length; i++) { // Start from 1 to skip header row\n    var cells \u003d rows[i].getElementsByTagName(\u0027td\u0027);\n    var itemCode \u003d cells[0].textContent;\n    \n    var updatedItem \u003d updatedData.find(item \u003d\u003e item.itemCode \u003d\u003d\u003d itemCode);\n    if (updatedItem) {\n      cells[2].textContent \u003d updatedItem.quantity; // Update current quantity\n      cells[3].getElementsByTagName(\u0027input\u0027)[0].value \u003d \u0027\u0027; // Clear actual count input\n      cells[4].textContent \u003d \u00270\u0027; // Reset difference to 0\n      cells[5].getElementsByTagName(\u0027input\u0027)[0].value \u003d \u0027\u0027; // Clear reason input\n    }\n  }\n}\n\nfunction onAdjustmentFailure(error) {\n  console.error(\"Adjustment submission failed:\", error);\n  alert(\u0027Failed to submit adjustment. Please try again.\u0027);\n}\n\n\u003c/script\u003e"},{"id":"717447e4-b3b7-45fc-bb48-6e47cf6258be","name":"Packaginggs","type":"server_js","source":"var SPREADSHEET_ID \u003d \u00271DM3hnK4Z5WZWgRYwunP9_P0RV079d2T-QZsd0Z9_FOI\u0027;\nvar INVENTORY_SHEET_NAME \u003d \u0027Packaging Materials Summary\u0027;\nvar DRAW_OUT_SHEET_NAME \u003d \u0027Draw Out\u0027;\n\nfunction getpackagingInventoryData() {\n  try {\n    console.log(\"Starting getpackagingInventoryData\");\n    var sheet \u003d SpreadsheetApp.openById(SPREADSHEET_ID).getSheetByName(INVENTORY_SHEET_NAME);\n    console.log(\"Sheet retrieved: \" + (sheet ? \"success\" : \"failed\"));\n    var data \u003d sheet.getDataRange().getValues();\n    console.log(\"Data retrieved, rows: \" + data.length);\n    var headers \u003d data.shift();\n    \n    var result \u003d data.map(function(row) {\n      return {\n        itemCode: row[1],\n        description: row[2],\n        packing: row[3],\n        category: row[0],\n        quantity: row[4],\n        uom: row[5]\n      };\n    });\n    console.log(\"Data processed, items: \" + result.length);\n    return result;\n  } catch (error) {\n    console.error(\"Error in getpackagingInventoryData: \" + error.toString());\n    throw error;\n  }\n}\n\nfunction drawOutPackagingStock(date, itemCode, description, packing, category, quantity, uom) {\n  var inventorySheet \u003d SpreadsheetApp.openById(SPREADSHEET_ID).getSheetByName(INVENTORY_SHEET_NAME);\n  var drawOutSheet \u003d SpreadsheetApp.openById(SPREADSHEET_ID).getSheetByName(DRAW_OUT_SHEET_NAME);\n  \n  var data \u003d inventorySheet.getDataRange().getValues();\n  var matchedRow \u003d null;\n\n  for (var i \u003d 1; i \u003c data.length; i++) {\n    if (data[i][1] \u003d\u003d\u003d itemCode \u0026\u0026 data[i][2].trim() \u003d\u003d\u003d description.trim()) {\n      matchedRow \u003d i;\n      break;\n    }\n    else if (itemCode \u003d\u003d\u003d \"\" \u0026\u0026 data[i][2].trim() \u003d\u003d\u003d description.trim()) {\n      matchedRow \u003d i;\n      break;\n    }\n  }\n\n  if (matchedRow !\u003d\u003d null) {\n    var currentQuantity \u003d Number(data[matchedRow][4]);\n    var newQuantity \u003d currentQuantity - Number(quantity);\n\n    if (newQuantity \u003c 0) {\n      return \"Error: Not enough stock available. Current: \" + currentQuantity + \", Requested: \" + quantity;\n    }\n\n    inventorySheet.getRange(matchedRow + 1, 5).setValue(newQuantity);\n\n    drawOutSheet.appendRow([date, data[matchedRow][1], data[matchedRow][2], data[matchedRow][3], data[matchedRow][0], quantity, data[matchedRow][5]]);\n\n    return \"Stock drawn out successfully\";\n  }\n  \n  return \"Error: Item not found in inventory. ItemCode: \u0027\" + itemCode + \"\u0027, Description: \u0027\" + description + \"\u0027\";\n}\n\n//Packaging Inventory Summary\nfunction getPackagingInventory() {\n  var sheetId \u003d \"1DM3hnK4Z5WZWgRYwunP9_P0RV079d2T-QZsd0Z9_FOI\"; // Your Google Sheets ID\n  var sheetName \u003d \"Packaging Materials Summary\"; // Your sheet name\n\n  var ss \u003d SpreadsheetApp.openById(sheetId);\n  var sheet \u003d ss.getSheetByName(sheetName);\n  \n  // Get the total number of rows in the sheet\n  var lastRow \u003d sheet.getLastRow();\n  \n  // Get data range starting from row 2\n  var dataRange \u003d sheet.getRange(3, 1, lastRow - 1, sheet.getLastColumn());\n  var dataValues \u003d dataRange.getValues();\n  \n  return dataValues;\n}\n\n\n\n//Stock In\n\nvar SPREADSHEET_ID \u003d \u00271DM3hnK4Z5WZWgRYwunP9_P0RV079d2T-QZsd0Z9_FOI\u0027;\nvar INVENTORY_SHEET_NAME \u003d \u0027Packaging Materials Summary\u0027;\nvar STOCK_IN_SHEET_NAME \u003d \u0027Stock In\u0027;\n\nfunction storeInPackagingStock(date, itemCode, description, packing, category, quantity, uom, isNewItem) {\n  var inventorySheet \u003d SpreadsheetApp.openById(SPREADSHEET_ID).getSheetByName(INVENTORY_SHEET_NAME);\n  var stockInSheet \u003d SpreadsheetApp.openById(SPREADSHEET_ID).getSheetByName(STOCK_IN_SHEET_NAME);\n  \n  if (isNewItem) {\n    // Add new item to inventory\n    inventorySheet.appendRow([category, itemCode, description, packing, quantity, uom]);\n  } else {\n    // Update existing item\n    var data \u003d inventorySheet.getDataRange().getValues();\n    for (var i \u003d 1; i \u003c data.length; i++) {\n      if (data[i][1] \u003d\u003d\u003d itemCode) {  // Assuming item code is in column B (index 1)\n        var currentQuantity \u003d Number(data[i][4]);  // Assuming quantity is in column E (index 4)\n        var newQuantity \u003d currentQuantity + Number(quantity);\n        inventorySheet.getRange(i + 1, 5).setValue(newQuantity);  // Update quantity in column E\n        break;\n      }\n    }\n  }\n  \n  // Record stock in\n  stockInSheet.appendRow([date, itemCode, description, packing, category, quantity, uom]);\n  \n  return isNewItem ? \"New item added and stocked in successfully\" : \"Stock in successful\";\n}\n\n//Report\nfunction checkPackagingSheetExists(sheetName) {\n  const ss \u003d SpreadsheetApp.openById(\u00271DM3hnK4Z5WZWgRYwunP9_P0RV079d2T-QZsd0Z9_FOI\u0027);\n  const sheet \u003d ss.getSheetByName(sheetName);\n  return {sheetExists: sheet !\u003d\u003d null};\n}\n\nfunction getPackagingReportData(sheetName, replace) {\n  const sourceSs \u003d SpreadsheetApp.openById(\u00271DM3hnK4Z5WZWgRYwunP9_P0RV079d2T-QZsd0Z9_FOI\u0027);\n  const sourceSheet \u003d sourceSs.getSheetByName(\u0027Packaging Materials Summary\u0027);\n  \n  if (!sourceSheet) {\n    throw new Error(\u0027Could not find \"Packaging Materials Summary\" sheet\u0027);\n  }\n  \n  let targetSheet \u003d sourceSs.getSheetByName(sheetName);\n  \n  if (targetSheet) {\n    if (replace) {\n      sourceSs.deleteSheet(targetSheet);\n      targetSheet \u003d sourceSheet.copyTo(sourceSs);\n      targetSheet.setName(sheetName);\n    }\n  } else {\n    targetSheet \u003d sourceSheet.copyTo(sourceSs);\n    targetSheet.setName(sheetName);\n  }\n\n  // Get the data from the sheet\n  const data \u003d targetSheet.getDataRange().getValues();\n  \n  return data;\n}\n\nfunction getFont() {\n  // The font file should be saved as a blob in your Google Drive\n  var fileId \u003d \u00271LTu30ugXl9N3FxFakGumLW4gyL0l89Fe\u0027; // This is the correct file ID\n  var fontFile \u003d DriveApp.getFileById(fileId);\n  var fontBytes \u003d fontFile.getBlob().getBytes();\n  return Utilities.base64Encode(fontBytes);\n}\n\n\n//Adjustment\n\nfunction submitAdjustment(adjustmentData) {\n  try {\n    console.log(\"Received adjustment data:\", JSON.stringify(adjustmentData));\n\n    var SPREADSHEET_ID \u003d \u00271DM3hnK4Z5WZWgRYwunP9_P0RV079d2T-QZsd0Z9_FOI\u0027;\n    var INVENTORY_SHEET_NAME \u003d \u0027Packaging Materials Summary\u0027;\n    var ADJUSTMENT_SHEET_NAME \u003d \u0027Adjustment\u0027;\n\n    var inventorySheet \u003d SpreadsheetApp.openById(SPREADSHEET_ID).getSheetByName(INVENTORY_SHEET_NAME);\n    var adjustmentSheet \u003d SpreadsheetApp.openById(SPREADSHEET_ID).getSheetByName(ADJUSTMENT_SHEET_NAME);\n\n    if (!inventorySheet || !adjustmentSheet) {\n      throw new Error(\"Unable to find required sheets\");\n    }\n\n    var updatedData \u003d [];\n\n    adjustmentData.forEach(function(item) {\n      // Update inventory sheet\n      var data \u003d inventorySheet.getDataRange().getValues();\n      var rowUpdated \u003d false;\n\n      for (var j \u003d 1; j \u003c data.length; j++) {\n        if (data[j][1] \u003d\u003d\u003d item.itemCode) {  // Assuming item code is in column B (index 1)\n          inventorySheet.getRange(j + 1, 5).setValue(item.actualCount);  // Update quantity in column E\n          updatedData.push({\n            itemCode: item.itemCode,\n            description: data[j][2],  // Assuming description is in column C\n            packing: data[j][3],      // Assuming packing is in column D\n            category: data[j][0],     // Assuming category is in column E\n            quantity: item.actualCount,\n            uom: data[j][5]           // Assuming UOM is in column G\n          });\n          rowUpdated \u003d true;\n          break;\n        }\n      }\n\n      if (!rowUpdated) {\n        console.log(\"Warning: No matching row found for item code:\", item.itemCode);\n      }\n\n      // Add entry to adjustment sheet\n      var date \u003d new Date().toISOString().split(\u0027T\u0027)[0]; // Get current date in YYYY-MM-DD format\n      adjustmentSheet.appendRow([date, item.itemCode, item.description, item.currentQuantity, item.actualCount, item.difference, item.reason]);\n    });\n\n    console.log(\"Updated data to return:\", JSON.stringify(updatedData));\n    return updatedData;\n  } catch (error) {\n    console.error(\"Error in submitAdjustment:\", error);\n    throw error;\n  }\n}"},{"id":"0f39b74d-bf8e-473a-97fe-a39a4f70caee","name":"Report","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n    \u003c?!\u003d include(\u0027CSS\u0027); ?\u003e\n    \u003cstyle\u003e\n      /* Style for dropdown lists */\n      select {\n        width: 200px;\n        padding: 10px;\n        margin: 10px 0;\n        border: 1px solid #ccc;\n        border-radius: 4px;\n        background-color: #f8f8f8;\n        font-size: 16px;\n      }\n\n      select:focus {\n        border-color: #007bff;\n        box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);\n        outline: none;\n      }\n\n\n      .centered-table td:nth-child(2), /* 2nd column */\n.centered-table td:nth-child(5) { /* 5th column */\n  text-align: center;\n}\n    \u003c/style\u003e\n     \u003cscript src\u003d\"https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js\"\u003e\u003c/script\u003e\n    \u003cscript src\u003d\"https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js\"\u003e\u003c/script\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n    \u003cheader\u003e\n      \u003ch1\u003eInventory Management System\u003c/h1\u003e\n    \u003c/header\u003e\n    \n    {{NAVBAR}}\n    \u003cmain\u003e\n    \u003csection id\u003d\"report\" class\u003d\"tab-content\"\u003e\n      \u003ch2 id\u003d\"reportTitle\"\u003eReport\u003c/h2\u003e\n      \u003cdiv id\u003d\"initialOption\" class\u003d\"report-options\"\u003e\n        \u003cdiv class\u003d\"report-option\" onclick\u003d\"showReportSelection()\"\u003e\n          \u003cspan\u003eISO Coldroom Temperature Report\u003c/span\u003e\n        \u003c/div\u003e\n      \u003c/div\u003e\n      \n      \u003cdiv id\u003d\"reportSelection\" class\u003d\"report-options\" style\u003d\"display: none;\"\u003e\n        \u003cdiv class\u003d\"report-option\" onclick\u003d\"showMonthlyReportSelection()\"\u003e\n          \u003cspan\u003eMonthly Report PDF\u003c/span\u003e\n        \u003c/div\u003e\n        \u003cdiv class\u003d\"report-option\" onclick\u003d\"showDateSelection()\"\u003e\n          \u003cspan\u003eDate Selection Report PDF\u003c/span\u003e\n        \u003c/div\u003e\n        \u003cbutton onclick\u003d\"goBack()\"\u003eBack\u003c/button\u003e\n      \u003c/div\u003e\n      \n      \u003cdiv id\u003d\"dateSelection\" style\u003d\"display: none;\"\u003e\n  \u003ch3\u003eSelect Coldroom:\u003c/h3\u003e\n  \u003cselect id\u003d\"coldroomDate\"\u003e\n    \u003coption value\u003d\"Coldroom 1\"\u003eColdroom 1\u003c/option\u003e\n    \u003coption value\u003d\"Coldroom 2\"\u003eColdroom 2\u003c/option\u003e\n    \u003coption value\u003d\"Coldroom 3\"\u003eColdroom 3\u003c/option\u003e\n    \u003coption value\u003d\"Coldroom 3A\"\u003eColdroom 3A\u003c/option\u003e\n    \u003coption value\u003d\"Coldroom 3B\"\u003eColdroom 3B\u003c/option\u003e\n    \u003coption value\u003d\"Coldroom 5\"\u003eColdroom 5\u003c/option\u003e\n    \u003coption value\u003d\"Coldroom 6\"\u003eColdroom 6\u003c/option\u003e\n  \u003c/select\u003e\n  \u003ch3\u003eSelect Date Range:\u003c/h3\u003e\n  \u003cinput type\u003d\"date\" id\u003d\"startDate\"\u003e\n  \u003cinput type\u003d\"date\" id\u003d\"endDate\"\u003e\n  \u003cdiv\u003e\n    \u003cinput type\u003d\"checkbox\" id\u003d\"allDayCheckbox\"\u003e\n    \u003clabel for\u003d\"allDayCheckbox\"\u003eAll Day\u003c/label\u003e\n  \u003c/div\u003e\n  \u003cbutton onclick\u003d\"generateCustomDatePdf()\"\u003eGenerate PDF\u003c/button\u003e\n  \u003cbutton onclick\u003d\"goBack()\"\u003eBack\u003c/button\u003e\n\u003c/div\u003e\n\n      \u003cdiv id\u003d\"monthlyReportSelection\" style\u003d\"display: none;\"\u003e\n        \u003ch3\u003eSelect Coldroom:\u003c/h3\u003e\n        \u003cselect id\u003d\"coldroomMonthly\"\u003e\n          \u003coption value\u003d\"Coldroom 1\"\u003eColdroom 1\u003c/option\u003e\n          \u003coption value\u003d\"Coldroom 2\"\u003eColdroom 2\u003c/option\u003e\n          \u003coption value\u003d\"Coldroom 3\"\u003eColdroom 3\u003c/option\u003e\n          \u003coption value\u003d\"Coldroom 3A\"\u003eColdroom 3A\u003c/option\u003e\n          \u003coption value\u003d\"Coldroom 3B\"\u003eColdroom 3B\u003c/option\u003e\n          \u003coption value\u003d\"Coldroom 5\"\u003eColdroom 5\u003c/option\u003e\n          \u003coption value\u003d\"Coldroom 6\"\u003eColdroom 6\u003c/option\u003e\n        \u003c/select\u003e\n        \u003ch3\u003eSelect Month and Year:\u003c/h3\u003e\n        \u003cselect id\u003d\"month\"\u003e\n          \u003coption value\u003d\"January\"\u003eJanuary\u003c/option\u003e\n          \u003coption value\u003d\"February\"\u003eFebruary\u003c/option\u003e\n          \u003coption value\u003d\"March\"\u003eMarch\u003c/option\u003e\n          \u003coption value\u003d\"April\"\u003eApril\u003c/option\u003e\n          \u003coption value\u003d\"May\"\u003eMay\u003c/option\u003e\n          \u003coption value\u003d\"June\"\u003eJune\u003c/option\u003e\n          \u003coption value\u003d\"July\"\u003eJuly\u003c/option\u003e\n          \u003coption value\u003d\"August\"\u003eAugust\u003c/option\u003e\n          \u003coption value\u003d\"September\"\u003eSeptember\u003c/option\u003e\n          \u003coption value\u003d\"October\"\u003eOctober\u003c/option\u003e\n          \u003coption value\u003d\"November\"\u003eNovember\u003c/option\u003e\n          \u003coption value\u003d\"December\"\u003eDecember\u003c/option\u003e\n        \u003c/select\u003e\n        \u003cinput type\u003d\"number\" id\u003d\"year\" placeholder\u003d\"Year\" min\u003d\"2000\" max\u003d\"2100\"\u003e\n        \u003cbutton onclick\u003d\"generateAndDownloadPdf(\u0027monthly\u0027)\"\u003eGenerate PDF\u003c/button\u003e\n        \u003cbutton onclick\u003d\"goBack()\"\u003eBack\u003c/button\u003e\n      \u003c/div\u003e\n    \u003c/section\u003e\n\n\u003cscript\u003e\nconst singaporeHolidays \u003d [\n  \u002701/01\u0027, // New Year\u0027s Day\n  \u002729/01\u0027, // Chinese New Year (Day 1)\n  \u002730/01\u0027, // Chinese New Year (Day 2)\n  \u002731/03\u0027, // Hari Raya Puasa\n  \u002718/04\u0027, // Good Friday\n  \u002701/05\u0027, // Labour Day\n  \u002712/05\u0027, // Vesak Day\n  \u002707/06\u0027, // Hari Raya Haji\n  \u002709/08\u0027, // National Day\n  \u002720/10\u0027, // Deepavali\n  \u002725/12\u0027, // Christmas Day\n];\n\n// Sample image data URLs (replace these with your actual image data URLs)\nconst operatorImages \u003d [\n  \u0027data:image/png;base64,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\u003d\u0027,\n  \u0027data:image/gif;base64,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\u0027,\n  // Add more image data URLs as needed\n];\n\n// Fixed image data URL for \"Verified By\"\nconst verifiedByImage \u003d \u0027data:image/png;base64,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\u003d\u0027; // Replace with actual image\n\nfunction showReportSelection() {\n  document.getElementById(\u0027initialOption\u0027).style.display \u003d \u0027none\u0027;\n  document.getElementById(\u0027reportSelection\u0027).style.display \u003d \u0027block\u0027;\n  document.getElementById(\u0027reportTitle\u0027).textContent \u003d \u0027ISO Coldroom Temperature Report\u0027;\n}\n\nfunction showMonthlyReportSelection() {\n  document.getElementById(\u0027reportSelection\u0027).style.display \u003d \u0027none\u0027;\n  document.getElementById(\u0027monthlyReportSelection\u0027).style.display \u003d \u0027block\u0027;\n}\n\nfunction showDateSelection() {\n  document.getElementById(\u0027reportSelection\u0027).style.display \u003d \u0027none\u0027;\n  document.getElementById(\u0027dateSelection\u0027).style.display \u003d \u0027block\u0027;\n}\n\nfunction goBack() {\n  document.getElementById(\u0027initialOption\u0027).style.display \u003d \u0027block\u0027;\n  document.getElementById(\u0027reportSelection\u0027).style.display \u003d \u0027none\u0027;\n  document.getElementById(\u0027dateSelection\u0027).style.display \u003d \u0027none\u0027;\n  document.getElementById(\u0027monthlyReportSelection\u0027).style.display \u003d \u0027none\u0027;\n  document.getElementById(\u0027reportTitle\u0027).textContent \u003d \u0027Report\u0027;\n}\n\nfunction getRandomTemp(coldroom) {\n  if ([\u0027Coldroom 1\u0027, \u0027Coldroom 2\u0027, \u0027Coldroom 5\u0027, \u0027Coldroom 6\u0027].includes(coldroom)) {\n    if (coldroom \u003d\u003d\u003d \u0027Coldroom 6\u0027) {\n      return Math.floor(Math.random() * 3) - 19;\n    } else {\n      return Number((Math.random() * 2.5 + 17.5).toFixed(1)) * -1;\n    }\n  } else {\n    return Number((Math.random() * 4.5).toFixed(1));\n  }\n}\n\nfunction getRemarks(temp, coldroom) {\n  if ([\u0027Coldroom 1\u0027, \u0027Coldroom 2\u0027, \u0027Coldroom 5\u0027, \u0027Coldroom 6\u0027].includes(coldroom)) {\n    if (coldroom \u003d\u003d\u003d \u0027Coldroom 6\u0027) {\n      return temp \u003d\u003d\u003d -17 ? \u0027Defrost\u0027 : \u0027\u0027;\n    } else {\n      return temp \u003e\u003d -17.9 ? \u0027Defrost\u0027 : \u0027\u0027;\n    }\n  } else {\n    return temp \u003e\u003d 4.1 ? \u0027Defrost\u0027 : \u0027\u0027;\n  }\n}\n\nfunction isHolidayOrSunday(date, year) {\n  const [day, month] \u003d date.split(\u0027/\u0027);\n  const fullDate \u003d new Date(year, month - 1, day);\n  return singaporeHolidays.includes(date) || fullDate.getDay() \u003d\u003d\u003d 0; // 0 is Sunday\n}\n\nfunction getRandomOperatorImage() {\n  return operatorImages[Math.floor(Math.random() * operatorImages.length)];\n}\n\nfunction insertVerifiedBySection(doc, reportType, endDate) {\n  const formattedDate \u003d endDate.toLocaleDateString(\u0027en-GB\u0027, { day: \u00272-digit\u0027, month: \u00272-digit\u0027, year: \u0027numeric\u0027 });\n  \n  doc.setFont(\u0027normal\u0027);\n  doc.text(\u0027Verified By:\u0027, 20, doc.lastAutoTable.finalY + 20);\n  \n  // Only include the image if it\u0027s not a custom report\n  if (reportType !\u003d\u003d \u0027custom\u0027) {\n    doc.addImage(verifiedByImage, \u0027PNG\u0027, 50, doc.lastAutoTable.finalY + 15, 18, 18);\n  }\n  \n  doc.text(\u0027Date:\u0027, 150, doc.lastAutoTable.finalY + 20);\n  \n  // Check if it\u0027s a custom report to decide whether to include the date\n  if (reportType !\u003d\u003d \u0027custom\u0027) {\n    doc.text(formattedDate, 170, doc.lastAutoTable.finalY + 20);\n  }\n}\nfunction formatTemp(temp, coldroom) {\n  if (coldroom \u003d\u003d\u003d \u0027Coldroom 6\u0027) {\n    return temp.toString();\n  } else {\n    return typeof temp \u003d\u003d\u003d \u0027number\u0027 ? temp.toFixed(1) : temp;\n  }\n}\n\nfunction addOperatorImage(cell, data, options) {\n  if (data.section \u003d\u003d\u003d \u0027body\u0027 \u0026\u0026 (data.column.index \u003d\u003d\u003d 2 || data.column.index \u003d\u003d\u003d 5)) {\n    const date \u003d data.row.cells[0].raw;\n    const year \u003d document.getElementById(\u0027year\u0027).value || new Date().getFullYear();\n    \n    if (!isHolidayOrSunday(date, year)) {\n      // Check if it\u0027s the last row of a custom report and the afternoon column\n      if (options.reportType \u003d\u003d\u003d \u0027custom\u0027 \u0026\u0026 options.isLastRow \u0026\u0026 data.column.index \u003d\u003d\u003d 5 \u0026\u0026 !options.isAllDay) {\n        return null; // Don\u0027t add an image\n      }\n\n      const img \u003d getRandomOperatorImage();\n      cell.styles.cellPadding \u003d 1;\n      cell.styles.minCellHeight \u003d 10;\n      cell.styles.valign \u003d \u0027middle\u0027;\n      cell.styles.halign \u003d \u0027center\u0027;\n      return { content: \u0027\u0027, custom: { image: img, w: 8, h: 8 } };\n    }\n  }\n  return null;\n}\n\nfunction generateAndDownloadPdf(reportType) {\n  const { jsPDF } \u003d window.jspdf;\n  const doc \u003d new jsPDF();\n\n  doc.setFont(\u0027bold\u0027);\n  doc.setFontSize(18);\n  doc.text(\u0027Li Chuan Food Products Pte Ltd\u0027, 105, 10, { align: \u0027center\u0027 });\n\n  doc.setFontSize(16);\n  doc.text(\u0027Cold Room Temperature Record\u0027, 105, 20, { align: \u0027center\u0027 });\n  const textWidth \u003d doc.getTextWidth(\u0027Cold Room Temperature Record\u0027);\n  doc.line(105 - textWidth / 2, 21, 105 + textWidth / 2, 21);\n\n  doc.setFontSize(10);\n  doc.text(\u0027Freezer : \u003c\u003d-18°C | Chiller : 0-4°C\u0027, 105, 30, { align: \u0027center\u0027 });\n\n  doc.setFontSize(12);\n  doc.setFont(\u0027normal\u0027);\n\n  let coldroom, startDate, endDate, isAllDay;\n  const headers \u003d [[\u0027Date\u0027, \u0027Temperature(°C) 8.30am\u0027, \u0027Operator\u0027, \u0027Remarks\u0027, \u0027Temperature(°C) 5.30pm\u0027, \u0027Operator\u0027, \u0027Remarks\u0027]];\n  const body \u003d [];\n\n  if (reportType \u003d\u003d\u003d \u0027monthly\u0027) {\n    coldroom \u003d document.getElementById(\u0027coldroomMonthly\u0027).value;\n    const month \u003d document.getElementById(\u0027month\u0027).value;\n    const year \u003d parseInt(document.getElementById(\u0027year\u0027).value);\n\n    doc.text(`Coldroom: ${coldroom}`, 20, 40);\n    doc.text(`Month: ${month} ${year}`, 20, 50);\n\n    const daysInMonth \u003d new Date(year, new Date(Date.parse(month +\" 1, 2012\")).getMonth() + 1, 0).getDate();\n    endDate \u003d new Date(year, new Date(Date.parse(month + \" 1, 2012\")).getMonth(), daysInMonth);\n\n    for (let day \u003d 1; day \u003c\u003d daysInMonth; day++) {\n      const date \u003d `${day.toString().padStart(2, \u00270\u0027)}/${(new Date(Date.parse(month + \" 1, 2012\")).getMonth() + 1).toString().padStart(2, \u00270\u0027)}`;\n      if (isHolidayOrSunday(date, year)) {\n        body.push([date, \u0027\u0027, \u0027\u0027, \u0027\u0027, \u0027\u0027, \u0027\u0027, \u0027\u0027]);\n      } else {\n        const temp1 \u003d getRandomTemp(coldroom);\n        const temp2 \u003d getRandomTemp(coldroom);\n        body.push([\n          date, \n          { content: formatTemp(temp1, coldroom), styles: { halign: \u0027center\u0027 } },\n          \u0027\u0027, // Empty string for operator image\n          getRemarks(temp1, coldroom), \n          { content: formatTemp(temp2, coldroom), styles: { halign: \u0027center\u0027 } },\n          \u0027\u0027, // Empty string for operator image\n          getRemarks(temp2, coldroom)\n        ]);\n      }\n    }\n  } else if (reportType \u003d\u003d\u003d \u0027custom\u0027) {\n    coldroom \u003d document.getElementById(\u0027coldroomDate\u0027).value;\n    startDate \u003d new Date(document.getElementById(\u0027startDate\u0027).value);\n    endDate \u003d new Date(document.getElementById(\u0027endDate\u0027).value);\n    isAllDay \u003d document.getElementById(\u0027allDayCheckbox\u0027).checked;\n\n    doc.text(`Coldroom: ${coldroom}`, 20, 40);\n    doc.text(`Month: ${startDate.toLocaleDateString(\u0027en-GB\u0027, { month: \u0027long\u0027, year: \u0027numeric\u0027 })}`, 20, 50);\n\n\n    for (let date \u003d new Date(startDate); date \u003c\u003d endDate; date.setDate(date.getDate() + 1)) {\n      const formattedDate \u003d date.toLocaleDateString(\u0027en-GB\u0027, { day: \u00272-digit\u0027, month: \u00272-digit\u0027, year: \u0027numeric\u0027 });\n      if (isHolidayOrSunday(formattedDate, date.getFullYear())) {\n        body.push([formattedDate, \u0027\u0027, \u0027\u0027, \u0027\u0027, \u0027\u0027, \u0027\u0027, \u0027\u0027]);\n      } else {\n        const temp1 \u003d getRandomTemp(coldroom);\n        const isLastDay \u003d date.getTime() \u003d\u003d\u003d endDate.getTime();\n        const temp2 \u003d isAllDay || !isLastDay ? getRandomTemp(coldroom) : \u0027\u0027;\n        body.push([\n          formattedDate, \n          { content: formatTemp(temp1, coldroom), styles: { halign: \u0027center\u0027 } },\n          \u0027\u0027, // Empty string for operator image\n          getRemarks(temp1, coldroom), \n          { content: temp2 ? formatTemp(temp2, coldroom) : \u0027\u0027, styles: { halign: \u0027center\u0027 } },\n          isAllDay || !isLastDay ? \u0027\u0027 : \u0027 \u0027, // Empty string for operator image, space for last day if not all day\n          temp2 ? getRemarks(temp2, coldroom) : \u0027\u0027\n        ]);\n      }\n    }\n  }\n\n  doc.autoTable({\n    head: headers,\n    body: body,\n    startY: 60,\n    didParseCell: function(data) {\n      if (data.row.index \u003d\u003d\u003d \u0027head\u0027) return;\n\n      const imageCell \u003d addOperatorImage(data.cell, data, {\n        reportType: reportType,\n        isLastRow: data.row.index \u003d\u003d\u003d body.length - 1,\n        isAllDay: isAllDay\n      });\n      if (imageCell) {\n        Object.assign(data.cell, imageCell);\n      }\n\n      if (data.row.cells[0].raw \u0026\u0026 isHolidayOrSunday(data.row.cells[0].raw, new Date().getFullYear())) {\n        data.cell.styles.fillColor \u003d [255, 255, 153];\n      }\n    },\n    didDrawCell: function(data) {\n      if (data.cell.custom \u0026\u0026 data.cell.custom.image) {\n        doc.addImage(\n          data.cell.custom.image,\n          \u0027PNG\u0027,\n          data.cell.x + (data.cell.width - data.cell.custom.w) / 2,\n          data.cell.y + (data.cell.height - data.cell.custom.h) / 2,\n          data.cell.custom.w,\n          data.cell.custom.h\n        );\n      }\n    }\n  });\n\n  insertVerifiedBySection(doc, reportType, endDate);\n\n  let filename;\n  if (reportType \u003d\u003d\u003d \u0027monthly\u0027) {\n    const month \u003d document.getElementById(\u0027month\u0027).value;\n    const year \u003d document.getElementById(\u0027year\u0027).value;\n    filename \u003d `${coldroom} ${month} ${year} Temperature Record.pdf`;\n  } else {\n    filename \u003d `${coldroom} Temperature Record.pdf`;\n  }\n\n  doc.save(filename);\n}\n\nfunction generateCustomDatePdf() {\n  generateAndDownloadPdf(\u0027custom\u0027);\n}\n\u003c/script\u003e\n\n \u003c/main\u003e\n    \u003cfooter\u003e\n      \u003cp\u003e\u0026copy; 2024 Inventory Management System\u003c/p\u003e\n    \u003c/footer\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n"},{"id":"3b37f41e-2b03-49c2-ade3-b0b7d00e5edc","name":"SL","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n\u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n    \u003c?!\u003d include(\u0027CSS\u0027); ?\u003e\n    \u003c?!\u003d include(\u0027SLCSS\u0027); ?\u003e\n\n    \u003cstyle\u003e\n\n    \u003c/style\u003e\n\n\u003c/head\u003e\n\u003clink rel\u003d\"stylesheet\" href\u003d\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css\"\u003e\n\u003cbody\u003e\n    \u003cheader\u003e\n        \u003ch1\u003eInventory Management System\u003c/h1\u003e\n    \u003c/header\u003e\n    \u003cnav\u003e\n        {{NAVBAR}}\n    \u003c/nav\u003e\n    \u003cmain\u003e\n        \u003cdiv class\u003d\"tab-container\"\u003e\n            \u003cdiv class\u003d\"tab\" onclick\u003d\"activateTab(this, \u0027inventorySection\u0027)\"\u003eSing Long Inventory Summary\u003c/div\u003e\n            \u003cdiv class\u003d\"tab\" onclick\u003d\"activateTab(this, \u0027drawOutSection\u0027)\"\u003eStock Out -\u003c/div\u003e\n            \u003cdiv class\u003d\"tab\" onclick\u003d\"activateTab(this, \u0027storeInSection\u0027)\"\u003eStock In +\u003c/div\u003e\n            \u003cdiv class\u003d\"tab\" onclick\u003d\"activateTab(this, \u0027reportSection\u0027)\"\u003eReport\u003c/div\u003e\n        \u003c/div\u003e\n\n        \u003cdiv id\u003d\"loadingIndicator\" style\u003d\"display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: rgba(255,255,255,0.8); padding: 20px; border-radius: 5px; box-shadow: 0 0 10px rgba(0,0,0,0.1); z-index: 1000;\"\u003e\n            \u003cdiv style\u003d\"text-align: center;\"\u003e\n                \u003cdiv class\u003d\"spinner\" style\u003d\"border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto;\"\u003e\u003c/div\u003e\n                \u003cp style\u003d\"margin-top: 10px;\"\u003eLoading...\u003c/p\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n\n        \u003cdiv id\u003d\"inventorySection\" class\u003d\"tab-content\"\u003e\n            \u003ch2\u003eSing Long Inventory Summary\u003c/h2\u003e\n            \u003ctable id\u003d\"inventory-table\"\u003e\n                \u003cthead\u003e\n                    \u003ctr\u003e\n                        \u003cth\u003eItem Code\u003c/th\u003e\n                        \u003cth\u003eProduct Description\u003c/th\u003e\n                        \u003cth\u003ePacking\u003c/th\u003e\n                        \u003cth\u003eExpiry Date / Batch No\u003c/th\u003e\n                        \u003cth\u003eLot No\u003c/th\u003e\n                        \u003cth\u003eDate Stored\u003c/th\u003e\n                        \u003cth\u003eContainer No\u003c/th\u003e\n                        \u003cth\u003ePallet Due Date\u003c/th\u003e\n                        \u003cth\u003eDay Left\u003c/th\u003e\n                        \u003cth\u003eQuantity\u003c/th\u003e\n                        \u003cth\u003ePallets\u003c/th\u003e\n                    \u003c/tr\u003e\n                \u003c/thead\u003e\n                \u003ctbody id\u003d\"inventory-table-body\"\u003e\n                    \u003c!-- Inventory data will be inserted here --\u003e\n                \u003c/tbody\u003e\n                \u003ctfoot\u003e\n                    \u003ctr id\u003d\"totals-row\"\u003e\n                        \u003ctd colspan\u003d\"9\" style\u003d\"text-align: right;\"\u003e\u003cstrong\u003eTotal:\u003c/strong\u003e\u003c/td\u003e\n                        \u003ctd\u003e\u003c/td\u003e\n                        \u003ctd\u003e\u003c/td\u003e\n                    \u003c/tr\u003e\n                \u003c/tfoot\u003e\n            \u003c/table\u003e\n            \u003cdiv id\u003d\"transactionModal\" class\u003d\"modal\"\u003e\n        \u003cdiv class\u003d\"modal-content\"\u003e\n            \u003cspan class\u003d\"close\"\u003e\u0026times;\u003c/span\u003e\n            \u003ch3\u003eTransaction Details\u003c/h3\u003e\n            \u003ctable id\u003d\"transactionTable\"\u003e\n                \u003cthead\u003e\n                    \u003ctr\u003e\n                        \u003cth\u003eDate\u003c/th\u003e\n                        \u003cth\u003eType\u003c/th\u003e\n                        \u003cth\u003eQuantity\u003c/th\u003e\n                        \u003cth\u003ePallet\u003c/th\u003e\n                    \u003c/tr\u003e\n                \u003c/thead\u003e\n                \u003ctbody id\u003d\"transactionTableBody\"\u003e\n                    \u003c!-- Transaction data will be inserted here --\u003e\n                \u003c/tbody\u003e\n            \u003c/table\u003e\n        \u003c/div\u003e\n        \u003c/div\u003e\n        \u003c/div\u003e\n\n        \u003cdiv id\u003d\"drawOutSection\" class\u003d\"tab-content\"\u003e\n            \u003cdiv id\u003d\"drawing-out-record\"\u003e\n                \u003ch2\u003eStock Out -\u003c/h2\u003e\n                \u003clabel for\u003d\"drawOutDate\"\u003eDate:\u003c/label\u003e\n\u003cinput type\u003d\"date\" id\u003d\"drawOutDate\" name\u003d\"drawOutDate\"\u003e\u003cbr\u003e\n                \u003cbutton id\u003d\"drawOutItemButton\" onclick\u003d\"showInventoryModal()\"\u003eSelect Item\u003c/button\u003e\u003cbr\u003e\n                \u003cdiv id\u003d\"selected-item-details\"\u003e\n                    \u003ch3\u003eSelected Item\u003c/h3\u003e\n                    \u003cp\u003eItem Code: \u003cspan id\u003d\"selected-item-code\"\u003e\u003c/span\u003e\u003c/p\u003e\n                    \u003cp\u003eProduct Description: \u003cspan id\u003d\"selected-product-description\"\u003e\u003c/span\u003e\u003c/p\u003e\n                    \u003cp\u003ePacking: \u003cspan id\u003d\"selected-packing\"\u003e\u003c/span\u003e\u003c/p\u003e\n                    \u003cp\u003eExpiry Date/Batch No: \u003cspan id\u003d\"selected-expiry-batch\"\u003e\u003c/span\u003e\u003c/p\u003e\n                    \u003cp\u003eLot No: \u003cspan id\u003d\"selected-lot-no\"\u003e\u003c/span\u003e\u003c/p\u003e\n                    \u003cp\u003eDate Stored: \u003cspan id\u003d\"selected-date-stored\"\u003e\u003c/span\u003e\u003c/p\u003e\n                    \u003cp\u003eContainer No: \u003cspan id\u003d\"selected-container-no\"\u003e\u003c/span\u003e\u003c/p\u003e\n                    \u003cp\u003eBal. Quantity: \u003cspan id\u003d\"selected-bal-quantity\"\u003e\u003c/span\u003e\u003c/p\u003e\n                    \u003cp\u003eBal. Pallet: \u003cspan id\u003d\"selected-bal-pallet\"\u003e\u003c/span\u003e\u003c/p\u003e\n                    \u003clabel for\u003d\"input-quantity\"\u003eQuantity:\u003c/label\u003e\n                    \u003cinput type\u003d\"number\" id\u003d\"input-quantity\" min\u003d\"1\"\u003e\u003cbr\u003e\n                    \u003clabel for\u003d\"input-pallet\"\u003ePallet:\u003c/label\u003e\n                    \u003cinput type\u003d\"number\" id\u003d\"input-pallet\" min\u003d\"1\"\u003e\u003cbr\u003e\n                \u003c/div\u003e\n                \u003cbutton onclick\u003d\"drawOutStock()\"\u003eDraw Out Stock\u003c/button\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n\n\u003cdiv id\u003d\"storeInSection\" class\u003d\"tab-content\"\u003e\n    \u003cdiv id\u003d\"store-in-record\"\u003e\n    \u003ch2\u003eStock In +\u003c/h2\u003e\n    \u003cform id\u003d\"storeInForm\"\u003e\n        \u003cdiv style\u003d\"display: flex; align-items: center; gap: 10px;\"\u003e\n            \u003clabel for\u003d\"storeInDate\"\u003eDate:\u003c/label\u003e\n            \u003cinput type\u003d\"date\" id\u003d\"storeInDate\" required\u003e\n            \u003cbutton type\u003d\"button\" id\u003d\"checkButton\" style\u003d\"transform: translateY(-12px);\"\u003eCheck\u003c/button\u003e\n        \u003c/div\u003e\n\n            \u003cdiv id\u003d\"formFields\"\u003e\n                \u003clabel for\u003d\"pickItem\"\u003ePick Item:\u003c/label\u003e\n                \u003cselect id\u003d\"pickItem\" required\u003e\u003c/select\u003e\u003cbr\u003e\n\n                \u003clabel for\u003d\"itemCode\"\u003eItem Code:\u003c/label\u003e\n                \u003cinput type\u003d\"text\" id\u003d\"itemCode\" readonly\u003e\u003cbr\u003e\n\n                \u003clabel for\u003d\"productDescription\"\u003eProduct Description:\u003c/label\u003e\n                \u003cinput type\u003d\"text\" id\u003d\"productDescription\" readonly\u003e\u003cbr\u003e\n\n                \u003clabel for\u003d\"packingSize\"\u003ePacking Size:\u003c/label\u003e\n                \u003cinput type\u003d\"text\" id\u003d\"packingSize\" readonly\u003e\u003cbr\u003e\n\n                \u003clabel for\u003d\"expiryBatch\"\u003eExpiry Date/Batch Number:\u003c/label\u003e\n                \u003cinput type\u003d\"text\" id\u003d\"expiryBatch\" required\u003e\u003cbr\u003e\n\n                \u003clabel for\u003d\"lotNumber\"\u003eLot Number: \u003cspan id\u003d\"lotNumberHint\" style\u003d\"color: grey; font-weight: bold;\"\u003e\u003c/span\u003e\u003c/label\u003e\n                \u003cinput type\u003d\"text\" id\u003d\"lotNumber\" value\u003d\"PCR 24 /\" required\u003e\u003cbr\u003e\n\n                \u003clabel for\u003d\"dateStored\"\u003eDate Stored:\u003c/label\u003e\n                \u003cinput type\u003d\"date\" id\u003d\"dateStored\" required\u003e\u003cbr\u003e\n\n                \u003clabel for\u003d\"container\"\u003eContainer:\u003c/label\u003e\n                \u003cinput type\u003d\"text\" id\u003d\"container\" required\u003e\u003cbr\u003e\n\n                \u003clabel for\u003d\"quantity\"\u003eQuantity:\u003c/label\u003e\n                \u003cinput type\u003d\"number\" id\u003d\"quantity\" required\u003e\u003cbr\u003e\n\n                \u003clabel for\u003d\"pallet\"\u003ePallet:\u003c/label\u003e\n                \u003cinput type\u003d\"number\" id\u003d\"pallet\" required\u003e\u003cbr\u003e\n\n                \u003cbutton type\u003d\"button\" onclick\u003d\"submitStoreIn()\"\u003eSubmit\u003c/button\u003e\n            \u003c/div\u003e\n        \u003c/form\u003e\n        \u003cdiv id\u003d\"retrievedDataTable\" style\u003d\"display: none;\"\u003e\n            \u003ctable id\u003d\"stockInTable\"\u003e\n                \u003cthead\u003e\n                    \u003ctr\u003e\n                        \u003cth\u003eDate\u003c/th\u003e\n                        \u003cth\u003eItem Code\u003c/th\u003e\n                        \u003cth\u003eProduct Description\u003c/th\u003e\n                        \u003cth\u003ePacking Size\u003c/th\u003e\n                        \u003cth\u003eExpiry Date/Batch Number\u003c/th\u003e\n                        \u003cth\u003eLot Number\u003c/th\u003e\n                        \u003cth\u003eDate Stored\u003c/th\u003e\n                        \u003cth\u003eContainer\u003c/th\u003e\n                        \u003cth\u003eQuantity\u003c/th\u003e\n                        \u003cth\u003ePallet\u003c/th\u003e\n                    \u003c/tr\u003e\n                \u003c/thead\u003e\n                \u003ctbody\u003e\u003c/tbody\u003e\n            \u003c/table\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n\u003c/div\u003e\n\n    \u003cdiv id\u003d\"reportSection\" class\u003d\"tab-content\"\u003e\n        \u003cdiv id\u003d\"report\"\u003e\n            \u003ch2\u003eReport\u003c/h2\u003e\n            \u003cdiv class\u003d\"report-options\"\u003e\n                \u003cdiv class\u003d\"report-option\" onclick\u003d\"showEndMonthReportOptions()\"\u003e\n                    \u003cspan\u003eView End Month Report\u003c/span\u003e\n                \u003c/div\u003e\n                \u003cdiv class\u003d\"report-option\" onclick\u003d\"showPalletDueDateOptions()\"\u003e\n                    \u003cspan\u003ePallet Due Date (Account)\u003c/span\u003e\n                \u003c/div\u003e\n                \u003cdiv class\u003d\"report-option\" onclick\u003d\"showTransactionReportOptions()\"\u003e\n                    \u003cspan\u003eSing Long Inventory Transaction Report\u003c/span\u003e\n                \u003c/div\u003e\n                \u003cdiv class\u003d\"report-option\" onclick\u003d\"showRequestFormOptions()\"\u003e\n                    \u003cspan\u003eSing Long Request Form\u003c/span\u003e\n                \u003c/div\u003e\n            \u003c/div\u003e\n\n        \u003cdiv id\u003d\"endMonthReportOptions\" style\u003d\"display: none;\"\u003e\n          \u003cbutton onclick\u003d\"callDuplicateAndFilterSheet()\" class\u003d\"cut-off-button\"\u003eMonth End Cut Off(月尾截止)\u003c/button\u003e\n    \u003clabel for\u003d\"monthSelect\"\u003eMonth:\u003c/label\u003e\n    \u003cselect id\u003d\"monthSelect\"\u003e\n        \u003coption value\u003d\"01\"\u003eJanuary\u003c/option\u003e\n        \u003coption value\u003d\"02\"\u003eFebruary\u003c/option\u003e\n        \u003coption value\u003d\"03\"\u003eMarch\u003c/option\u003e\n        \u003coption value\u003d\"04\"\u003eApril\u003c/option\u003e\n        \u003coption value\u003d\"05\"\u003eMay\u003c/option\u003e\n        \u003coption value\u003d\"06\"\u003eJune\u003c/option\u003e\n        \u003coption value\u003d\"07\"\u003eJuly\u003c/option\u003e\n        \u003coption value\u003d\"08\"\u003eAugust\u003c/option\u003e\n        \u003coption value\u003d\"09\"\u003eSeptember\u003c/option\u003e\n        \u003coption value\u003d\"10\"\u003eOctober\u003c/option\u003e\n        \u003coption value\u003d\"11\"\u003eNovember\u003c/option\u003e\n        \u003coption value\u003d\"12\"\u003eDecember\u003c/option\u003e\n    \u003c/select\u003e\n    \u003clabel for\u003d\"yearSelect\"\u003eYear:\u003c/label\u003e\n    \u003cinput type\u003d\"number\" id\u003d\"yearSelect\" min\u003d\"2000\" max\u003d\"2100\" value\u003d\"2024\"\u003e\n    \u003cbutton onclick\u003d\"ViewEndMonthReport()\"\u003eView Report\u003c/button\u003e\n\u003c/div\u003e\n\n\u003cdiv id\u003d\"palletDueDateOptions\" style\u003d\"display: none;\"\u003e\n        \u003clabel for\u003d\"palletDueDateMonth\"\u003eMonth:\u003c/label\u003e\n        \u003cselect id\u003d\"palletDueDateMonth\"\u003e\n            \u003coption value\u003d\"1\"\u003eJanuary\u003c/option\u003e\n            \u003coption value\u003d\"2\"\u003eFebruary\u003c/option\u003e\n            \u003coption value\u003d\"3\"\u003eMarch\u003c/option\u003e\n            \u003coption value\u003d\"4\"\u003eApril\u003c/option\u003e\n            \u003coption value\u003d\"5\"\u003eMay\u003c/option\u003e\n            \u003coption value\u003d\"6\"\u003eJune\u003c/option\u003e\n            \u003coption value\u003d\"7\"\u003eJuly\u003c/option\u003e\n            \u003coption value\u003d\"8\"\u003eAugust\u003c/option\u003e\n            \u003coption value\u003d\"9\"\u003eSeptember\u003c/option\u003e\n            \u003coption value\u003d\"10\"\u003eOctober\u003c/option\u003e\n            \u003coption value\u003d\"11\"\u003eNovember\u003c/option\u003e\n            \u003coption value\u003d\"12\"\u003eDecember\u003c/option\u003e\n        \u003c/select\u003e\n        \u003clabel for\u003d\"palletDueDateYear\"\u003eYear:\u003c/label\u003e\n        \u003cinput type\u003d\"number\" id\u003d\"palletDueDateYear\" min\u003d\"2000\" max\u003d\"2100\"\u003e\n        \u003cbutton onclick\u003d\"generatePalletDueDateReport()\"\u003eGenerate Report\u003c/button\u003e\n    \u003c/div\u003e\n\n\u003cdiv id\u003d\"transactionReportOptions\" style\u003d\"display: none;\"\u003e\n    \u003clabel for\u003d\"openingStockMonth\"\u003eMonth:\u003c/label\u003e\n    \u003cselect id\u003d\"openingStockMonth\"\u003e\n        \u003coption value\u003d\"01\"\u003eJanuary\u003c/option\u003e\n        \u003coption value\u003d\"02\"\u003eFebruary\u003c/option\u003e\n        \u003coption value\u003d\"03\"\u003eMarch\u003c/option\u003e\n        \u003coption value\u003d\"04\"\u003eApril\u003c/option\u003e\n        \u003coption value\u003d\"05\"\u003eMay\u003c/option\u003e\n        \u003coption value\u003d\"06\"\u003eJune\u003c/option\u003e\n        \u003coption value\u003d\"07\"\u003eJuly\u003c/option\u003e\n        \u003coption value\u003d\"08\"\u003eAugust\u003c/option\u003e\n        \u003coption value\u003d\"09\"\u003eSeptember\u003c/option\u003e\n        \u003coption value\u003d\"10\"\u003eOctober\u003c/option\u003e\n        \u003coption value\u003d\"11\"\u003eNovember\u003c/option\u003e\n        \u003coption value\u003d\"12\"\u003eDecember\u003c/option\u003e\n    \u003c/select\u003e\n    \u003clabel for\u003d\"openingStockYear\"\u003eYear:\u003c/label\u003e\n    \u003cinput type\u003d\"number\" id\u003d\"openingStockYear\" min\u003d\"2000\" max\u003d\"2100\" value\u003d\"2024\"\u003e\n    \u003cbutton onclick\u003d\"generateTransactionReport()\"\u003eGenerate Report\u003c/button\u003e\n\u003c/div\u003e\n\n\u003cdiv id\u003d\"requestFormOptions\" style\u003d\"display: none;\"\u003e\n\u003cdiv style\u003d\"margin-bottom: 20px;\"\u003e\n    \u003cbutton onclick\u003d\"setRequestFormType(\u0027stockIn\u0027)\"\u003eStock In\u003c/button\u003e\n    \u003cbutton onclick\u003d\"setRequestFormType(\u0027stockOut\u0027)\"\u003eStock Out\u003c/button\u003e\n\u003c/div\u003e\n\u003cdiv id\u003d\"requestFormDateSelection\" style\u003d\"display: none; margin-top: 20px;\"\u003e\n    \u003clabel for\u003d\"requestFormDate\"\u003eDate:\u003c/label\u003e\n    \u003cselect id\u003d\"requestFormDate\"\u003e\u003c/select\u003e\n    \u003clabel for\u003d\"collectionTime\"\u003eCollection Time:\u003c/label\u003e\n    \u003cselect id\u003d\"collectionTime\"\u003e\n        \u003coption value\u003d\"10:00 AM\"\u003e10:00 AM\u003c/option\u003e\n        \u003coption value\u003d\"11:00 AM\"\u003e11:00 AM\u003c/option\u003e\n        \u003coption value\u003d\"1:00 PM\"\u003e1:00 PM\u003c/option\u003e\n        \u003coption value\u003d\"2:00 PM\"\u003e2:00 PM\u003c/option\u003e\n        \u003coption value\u003d\"3:00 PM\"\u003e3:00 PM\u003c/option\u003e\n        \u003coption value\u003d\"4:00 PM\"\u003e4:00 PM\u003c/option\u003e\n    \u003c/select\u003e\n    \u003cbutton onclick\u003d\"generateAndPrintRequestForm()\"\u003eGenerate and Print Form\u003c/button\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n    \u003c/div\u003e\n\u003c/div\u003e\n\n\n\n\n\u003c!-- Modals for displaying reports --\u003e\n\u003cdiv id\u003d\"monthEndReportModal\" class\u003d\"modal\"\u003e\n    \u003cdiv class\u003d\"modal-content\"\u003e\n        \u003cdiv class\u003d\"modal-header\"\u003e\n            \u003ch3\u003eSing Long Inventory Month End Report\u003c/h3\u003e\n            \u003cspan class\u003d\"print-icon\" onclick\u003d\"printMonthEndReport()\"\u003e\u003ci class\u003d\"fas fa-print\"\u003e\u003c/i\u003e Print\u003c/span\u003e\n            \u003cspan class\u003d\"close\"\u003e\u0026times;\u003c/span\u003e\n        \u003c/div\u003e\n        \u003ctable id\u003d\"monthEndReportTable\"\u003e\n            \u003cthead\u003e\n                \u003ctr\u003e\n                    \u003cth\u003eItem Code\u003c/th\u003e\n                    \u003cth\u003eProduct Description\u003c/th\u003e\n                    \u003cth\u003ePacking\u003c/th\u003e\n                    \u003cth\u003eExpiry Date / Batch No\u003c/th\u003e\n                    \u003cth\u003eLot No\u003c/th\u003e\n                    \u003cth\u003eDate Stored\u003c/th\u003e\n                    \u003cth\u003eContainer No\u003c/th\u003e\n                    \u003cth\u003ePallet Due Date\u003c/th\u003e\n                    \u003cth\u003eQuantity\u003c/th\u003e\n                    \u003cth\u003ePallets\u003c/th\u003e\n                \u003c/tr\u003e\n            \u003c/thead\u003e\n            \u003ctbody id\u003d\"monthEndReportTableBody\"\u003e\n                \u003c!-- Month End report data will be inserted here --\u003e\n            \u003c/tbody\u003e\n        \u003c/table\u003e\n        \u003cdiv id\u003d\"monthEndReportSummary\" class\u003d\"report-summary\"\u003e\n            \u003c!-- Total quantity and pallets will be inserted here --\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv id\u003d\"transactionReportModal\" class\u003d\"modal\"\u003e\n    \u003cdiv class\u003d\"modal-content\"\u003e\n        \u003cdiv class\u003d\"modal-header\"\u003e\n            \u003ch3\u003eSing Long Inventory Transaction Report\u003c/h3\u003e\n            \u003cspan class\u003d\"print-icon\" onclick\u003d\"printTransactionTable()\"\u003e\u003ci class\u003d\"fas fa-print\"\u003e\u003c/i\u003e Print\u003c/span\u003e\n            \u003cspan class\u003d\"close\"\u003e\u0026times;\u003c/span\u003e\n        \u003c/div\u003e\n        \u003ctable id\u003d\"transactionReportTable\"\u003e\n            \u003cthead\u003e\n                \u003ctr\u003e\n                    \u003cth\u003eProduct Description\u003c/th\u003e\n                    \u003cth\u003eLot Number\u003c/th\u003e\n                    \u003cth\u003eDate\u003c/th\u003e\n                    \u003cth\u003eOpening Stock\u003c/th\u003e\n                    \u003cth\u003eStock In\u003c/th\u003e\n                    \u003cth\u003eStock Out\u003c/th\u003e\n                    \u003cth\u003eBalance\u003c/th\u003e\n                \u003c/tr\u003e\n            \u003c/thead\u003e\n            \u003ctbody id\u003d\"transactionReportTableBody\"\u003e\n                \u003c!-- Transaction report data will be inserted here --\u003e\n            \u003c/tbody\u003e\n        \u003c/table\u003e\n    \u003c/div\u003e\n\u003c/div\u003e\n\n    \u003cdiv id\u003d\"palletDueDateModal\" class\u003d\"modal\"\u003e\n        \u003cdiv class\u003d\"modal-content\"\u003e\n            \u003cdiv class\u003d\"modal-header\"\u003e\n                \u003ch3\u003ePallet Due Date Report\u003c/h3\u003e\n                \u003cspan class\u003d\"print-icon\" onclick\u003d\"printPalletDueDateReport()\"\u003e\u003ci class\u003d\"fas fa-print\"\u003e\u003c/i\u003e Print\u003c/span\u003e\n                \u003cspan class\u003d\"close\"\u003e\u0026times;\u003c/span\u003e\n            \u003c/div\u003e\n            \u003ctable id\u003d\"palletDueDateTable\"\u003e\n                \u003cthead\u003e\n                    \u003ctr\u003e\n                        \u003cth\u003eProduct\u003c/th\u003e\n                        \u003cth\u003eLot Number\u003c/th\u003e\n                        \u003cth\u003eQuantity\u003c/th\u003e\n                        \u003cth\u003eCharged Pallets\u003c/th\u003e\n                        \u003cth\u003eReason\u003c/th\u003e\n                        \u003cth\u003ePallet Due Date\u003c/th\u003e\n                        \u003cth\u003eNext Pallet Due Date\u003c/th\u003e\n                    \u003c/tr\u003e\n                \u003c/thead\u003e\n                \u003ctbody id\u003d\"palletDueDateTableBody\"\u003e\n                    \u003c!-- Pallet Due Date report data will be inserted here --\u003e\n                \u003c/tbody\u003e\n            \u003c/table\u003e\n            \u003cp id\u003d\"totalChargedPallets\" style\u003d\"margin-top: 20px; font-weight: bold;\"\u003e\u003c/p\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n\n    \n \u003c/main\u003e\n    \u003cfooter\u003e\n        \u003cp\u003e\u0026copy; 2024 Inventory Management System\u003c/p\u003e\n    \u003c/footer\u003e\n\n    \u003c?!\u003d include(\u0027SLScript\u0027); ?\u003e\n    \u003cscript\u003e\n\nfunction callDuplicateAndFilterSheet() {\n    showLoadingIndicator();\n    google.script.run\n        .withSuccessHandler(function(result) {\n            hideLoadingIndicator();\n            if (result \u0026\u0026 result.success) {\n                alert(\u0027Cut off month process completed successfully. New sheet created: \u0027 + result.newSheetName);\n            } else {\n                alert(\u0027Cut off month process failed. \u0027 + (result.error || \u0027Unknown error occurred.\u0027));\n            }\n        })\n        .withFailureHandler(function(error) {\n            hideLoadingIndicator();\n            console.error(\u0027Error in duplicateAndFilterSheet:\u0027, error);\n            alert(\u0027An error occurred while processing the cut off month: \u0027 + error);\n        })\n        .duplicateAndFilterSheet();\n}\n\n    function onDateChange() {\n  var button \u003d document.getElementById(\u0027checkButton\u0027);\n  if (button.textContent \u003d\u003d\u003d \u0027Return\u0027) {\n    onCheckButtonClick();\n  }\n}\n\nfunction onCheckButtonClick() {\n  var button \u003d document.getElementById(\u0027checkButton\u0027);\n  var formFields \u003d document.getElementById(\u0027formFields\u0027);\n  var retrievedDataTable \u003d document.getElementById(\u0027retrievedDataTable\u0027);\n  var container \u003d document.getElementById(\u0027store-in-record\u0027);\n  var loadingText \u003d document.getElementById(\u0027loadingText\u0027) || document.createElement(\u0027p\u0027);\n  loadingText.id \u003d \u0027loadingText\u0027;\n  loadingText.textContent \u003d \u0027Loading...\u0027;\n  loadingText.style.textAlign \u003d \u0027center\u0027;\n  \n  if (button.textContent \u003d\u003d\u003d \u0027Check\u0027) {\n    var selectedDate \u003d document.getElementById(\u0027storeInDate\u0027).value;\n    if (!selectedDate) {\n      alert(\"Please select a date.\");\n      return;\n    }\n\n    formFields.style.display \u003d \u0027none\u0027;\n    retrievedDataTable.style.display \u003d \u0027none\u0027;\n    container.insertBefore(loadingText, retrievedDataTable);\n    button.textContent \u003d \u0027Return\u0027;\n    container.style.maxWidth \u003d \u00271200px\u0027;\n    \n    google.script.run\n      .withSuccessHandler(function(jsonData) {\n        container.removeChild(loadingText);\n        retrievedDataTable.style.display \u003d \u0027block\u0027;\n        try {\n          var data \u003d JSON.parse(jsonData);\n          if (Array.isArray(data) \u0026\u0026 data.length \u003e 0) {\n            var filteredData \u003d filterDataByDate(data, selectedDate);\n            displayData(filteredData);\n          } else {\n            retrievedDataTable.innerHTML \u003d \u0027\u003cp\u003eNo data available for the selected date.\u003c/p\u003e\u0027;\n          }\n        } catch (error) {\n          retrievedDataTable.innerHTML \u003d \u0027\u003cp\u003eError: Unable to process data.\u003c/p\u003e\u0027;\n        }\n      })\n      .withFailureHandler(function(error) {\n        container.removeChild(loadingText);\n        retrievedDataTable.style.display \u003d \u0027block\u0027;\n        retrievedDataTable.innerHTML \u003d \u0027\u003cp\u003eError: \u0027 + error.message + \u0027\u003c/p\u003e\u0027;\n      })\n      .getStockInData();\n  } else if (button.textContent \u003d\u003d\u003d \u0027Return\u0027) {\n    // Return functionality\n    formFields.style.display \u003d \u0027block\u0027;\n    retrievedDataTable.style.display \u003d \u0027none\u0027;\n    button.textContent \u003d \u0027Check\u0027;\n    container.style.maxWidth \u003d \u0027600px\u0027;\n    if (loadingText.parentNode) {\n      container.removeChild(loadingText);\n    }\n  }\n}\n\n\n\nfunction filterDataByDate(data, selectedDate) {\n  var formattedSelectedDate \u003d formatDateForComparison(selectedDate);\n  return data.filter(function(row, index) {\n    if (index \u003d\u003d\u003d 0) return true; // Keep header row\n    return formatDateForComparison(row[0]) \u003d\u003d\u003d formattedSelectedDate;\n  });\n}\n\nfunction formatDateForComparison(dateString) {\n  var date \u003d new Date(dateString);\n  var year \u003d date.getFullYear();\n  var month \u003d (date.getMonth() + 1).toString().padStart(2, \u00270\u0027);\n  var day \u003d date.getDate().toString().padStart(2, \u00270\u0027);\n  return `${year}-${month}-${day}`;\n}\n\nfunction formatDateForDisplay(dateString) {\n  if (!dateString) return \u0027\u0027;\n  var date \u003d new Date(dateString);\n  if (isNaN(date.getTime())) return dateString; // Return original string if not a valid date\n  var day \u003d date.getDate().toString().padStart(2, \u00270\u0027);\n  var month \u003d (date.getMonth() + 1).toString().padStart(2, \u00270\u0027);\n  var year \u003d date.getFullYear();\n  return `${day}/${month}/${year}`;\n}\n\n\nfunction displayData(data) {\n  var tableBody \u003d document.querySelector(\u0027#stockInTable tbody\u0027);\n  if (!tableBody) {\n    return;\n  }\n  \n  tableBody.innerHTML \u003d \u0027\u0027;\n  \n  if (data.length \u003c\u003d 1) {\n    tableBody.innerHTML \u003d \u0027\u003ctr\u003e\u003ctd colspan\u003d\"10\"\u003eNo data available for the selected date.\u003c/td\u003e\u003c/tr\u003e\u0027;\n    return;\n  }\n  \n  for (var i \u003d 1; i \u003c data.length; i++) {\n    var row \u003d data[i];\n    var tr \u003d document.createElement(\u0027tr\u0027);\n    for (var j \u003d 0; j \u003c row.length; j++) {\n      var td \u003d document.createElement(\u0027td\u0027);\n      if (j \u003d\u003d\u003d 0 || j \u003d\u003d\u003d 6) { // Columns A and G are dates\n        td.textContent \u003d formatDateForDisplay(row[j]);\n      } else if (j \u003d\u003d\u003d 4) { // Column E is Expiry Date/Batch Number\n        var input \u003d document.createElement(\u0027input\u0027);\n        input.type \u003d \u0027text\u0027;\n        input.value \u003d row[j] || \u0027\u0027;\n        input.dataset.date \u003d row[0]; // Store the date (column A) as a data attribute\n        input.dataset.itemCode \u003d row[1]; // Store the item code (column B) as a data attribute\n        input.dataset.lotNumber \u003d row[5]; // Store the lot number (column F) as a data attribute\n        input.dataset.dateStored \u003d row[6]; // Store the date stored (column G) as a data attribute\n        input.dataset.container \u003d row[7]; // Store the container (column H) as a data attribute\n        input.addEventListener(\u0027change\u0027, updateExpiryDateBatchNumber);\n        td.appendChild(input);\n      } else {\n        td.textContent \u003d row[j] !\u003d\u003d null \u0026\u0026 row[j] !\u003d\u003d undefined ? row[j].toString() : \u0027\u0027;\n      }\n      tr.appendChild(td);\n    }\n    tableBody.appendChild(tr);\n  }\n}\n\nfunction updateExpiryDateBatchNumber(event) {\n  var input \u003d event.target;\n  var date \u003d input.dataset.date;\n  var itemCode \u003d input.dataset.itemCode;\n  var lotNumber \u003d input.dataset.lotNumber;\n  var dateStored \u003d input.dataset.dateStored;\n  var container \u003d input.dataset.container;\n  var newValue \u003d input.value;\n\n  google.script.run\n    .withSuccessHandler(function(result) {\n      if (result.success) {\n        console.log(\u0027Update successful\u0027);\n      } else {\n        console.error(\u0027Update failed:\u0027, result.error);\n        alert(\u0027Failed to update. Please try again.\u0027);\n      }\n    })\n    .withFailureHandler(function(error) {\n      console.error(\u0027Error updating:\u0027, error);\n      alert(\u0027An error occurred while updating. Please try again.\u0027);\n    })\n    .updateExpiryDateBatchNumber(date, itemCode, lotNumber, dateStored, container, newValue);\n}\n\n// Initialize the page\ndocument.addEventListener(\u0027DOMContentLoaded\u0027, function() {\n  var dateInput \u003d document.getElementById(\u0027storeInDate\u0027);\n  var checkButton \u003d document.getElementById(\u0027checkButton\u0027);\n  \n  dateInput.addEventListener(\u0027change\u0027, function() {\n    var selectedDate \u003d new Date(this.value);\n    var year \u003d selectedDate.getFullYear();\n    var month \u003d (selectedDate.getMonth() + 1).toString().padStart(2, \u00270\u0027);\n    var day \u003d selectedDate.getDate().toString().padStart(2, \u00270\u0027);\n    this.value \u003d `${year}-${month}-${day}`;\n    onDateChange(); // Call onDateChange when the date is changed\n  });\n\n  checkButton.addEventListener(\u0027click\u0027, onCheckButtonClick);\n});\n\n\n//Pallet Due Date\n    function showPalletDueDateOptions() {\n        hideAllReportOptions();\n        document.getElementById(\u0027palletDueDateOptions\u0027).style.display \u003d \u0027block\u0027;\n        \n        // Set default values to current month and year\n        var today \u003d new Date();\n        document.getElementById(\u0027palletDueDateMonth\u0027).value \u003d today.getMonth() + 1;\n        document.getElementById(\u0027palletDueDateYear\u0027).value \u003d today.getFullYear();\n    }\n\n    function generatePalletDueDateReport() {\n    var selectedMonth \u003d document.getElementById(\u0027palletDueDateMonth\u0027).value;\n    var selectedYear \u003d document.getElementById(\u0027palletDueDateYear\u0027).value;\n    \n    console.log(\u0027Client-side - Selected Month:\u0027, selectedMonth);\n    console.log(\u0027Client-side - Selected Year:\u0027, selectedYear);\n\n    showLoadingIndicator();\n    google.script.run\n        .withSuccessHandler(displayPalletDueDateReport)\n        .withFailureHandler(handleReportError)\n        .calculatePalletCharges(selectedMonth, selectedYear);\n}\n\nfunction handleReportError(error) {\n    hideLoadingIndicator();\n    console.error(\u0027Error in calculatePalletCharges:\u0027, error);\n    var errorMessage \u003d \u0027An error occurred while generating the report: \u0027 + error.message;\n    if (error.message.includes(\u0027Previous month sheet not found\u0027)) {\n        errorMessage +\u003d \u0027\\nPlease ensure that the previous month\\\u0027s sheet exists in the spreadsheet.\u0027;\n    }\n    alert(errorMessage);\n}\nfunction generatePalletDueDateReport() {\n    var selectedMonth \u003d document.getElementById(\u0027palletDueDateMonth\u0027).value;\n    var selectedYear \u003d document.getElementById(\u0027palletDueDateYear\u0027).value;\n    \n    console.log(\u0027Client-side - Selected Month:\u0027, selectedMonth);\n    console.log(\u0027Client-side - Selected Year:\u0027, selectedYear);\n\n    showLoadingIndicator();\n    google.script.run\n        .withSuccessHandler(function(data) {\n            displayPalletDueDateReport(data, selectedMonth, selectedYear);\n        })\n        .withFailureHandler(handleReportError)\n        .calculatePalletCharges(selectedMonth, selectedYear);\n}\n\nfunction displayPalletDueDateReport(data, selectedMonth, selectedYear) {\n    hideLoadingIndicator();\n    var modal \u003d document.getElementById(\u0027palletDueDateModal\u0027);\n    var tableBody \u003d document.getElementById(\u0027palletDueDateTableBody\u0027);\n    var totalChargedPalletsElement \u003d document.getElementById(\u0027totalChargedPallets\u0027);\n    tableBody.innerHTML \u003d \u0027\u0027;\n\n    var totalChargedPallets \u003d 0;\n\n    data.forEach(function(row) {\n        var tr \u003d document.createElement(\u0027tr\u0027);\n        row.forEach(function(cell, index) {\n            if (index \u003c row.length - 1) {  // Skip the last element (our flag)\n                var td \u003d document.createElement(\u0027td\u0027);\n                td.textContent \u003d cell;\n                if (index \u003d\u003d\u003d 1 \u0026\u0026 row[row.length - 1]) {  // If it\u0027s the lot number column and the flag is true\n                    td.style.backgroundColor \u003d \u0027yellow\u0027;\n                }\n                if (index \u003d\u003d\u003d 3) {  // Charged Pallets column\n                    totalChargedPallets +\u003d parseInt(cell) || 0;\n                }\n                tr.appendChild(td);\n            }\n        });\n        tableBody.appendChild(tr);\n    });\n\n    var monthName \u003d getMonthName(parseInt(selectedMonth));\n    totalChargedPalletsElement.textContent \u003d `Total ${monthName} ${selectedYear} will be charged ${totalChargedPallets} Pallets.`;\n\n    modal.style.display \u003d \u0027block\u0027;\n}\n\nfunction getMonthName(monthNumber) {\n    var monthNames \u003d [\u0027January\u0027, \u0027February\u0027, \u0027March\u0027, \u0027April\u0027, \u0027May\u0027, \u0027June\u0027, \n                      \u0027July\u0027, \u0027August\u0027, \u0027September\u0027, \u0027October\u0027, \u0027November\u0027, \u0027December\u0027];\n    return monthNames[monthNumber - 1];\n}\n\nfunction handleReportError(error) {\n    hideLoadingIndicator();\n    console.error(\u0027Error in calculatePalletCharges:\u0027, error);\n    alert(\u0027An error occurred while generating the report: \u0027 + error);\n}\n\nfunction printPalletDueDateReport() {\n    var printWindow \u003d window.open(\u0027\u0027, \u0027_blank\u0027);\n    var tableContent \u003d document.getElementById(\u0027palletDueDateTable\u0027).outerHTML;\n    var totalChargedPallets \u003d document.getElementById(\u0027totalChargedPallets\u0027).textContent;\n    \n    var htmlContent \u003d `\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003ctitle\u003ePallet Due Date Report\u003c/title\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; font-size: 10pt; }\n                table { border-collapse: collapse; width: 100%; }\n                th, td { border: 1px solid black; padding: 4px; text-align: left; font-size: 8pt; }\n                th { background-color: #f2f2f2; }\n                @media print {\n                    body { margin: 0; padding: 10px; }\n                    table { page-break-inside: auto; }\n                    tr { page-break-inside: avoid; page-break-after: auto; }\n                    thead { display: table-header-group; }\n                }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n            \u003ch2 style\u003d\"font-size: 14pt;\"\u003ePallet Due Date Report\u003c/h2\u003e\n            ${tableContent}\n            \u003cp style\u003d\"margin-top: 20px; font-weight: bold;\"\u003e${totalChargedPallets}\u003c/p\u003e\n        \u003c/body\u003e\n        \u003c/html\u003e\n    `;\n    \n    printWindow.document.write(htmlContent);\n    printWindow.document.close();\n    printWindow.focus();\n    \n    printWindow.onload \u003d function() {\n        printWindow.print();\n        printWindow.close();\n    };\n}\n\n    // Close modal when clicking on \u003cspan\u003e (x)\n    document.querySelector(\u0027#palletDueDateModal .close\u0027).onclick \u003d function() {\n        document.getElementById(\u0027palletDueDateModal\u0027).style.display \u003d \u0027none\u0027;\n    }\n\n    // Close modal when clicking outside of it\n    window.onclick \u003d function(event) {\n        var modal \u003d document.getElementById(\u0027palletDueDateModal\u0027);\n        if (event.target \u003d\u003d modal) {\n            modal.style.display \u003d \u0027none\u0027;\n        }\n    }\n\n    function showLoadingIndicator() {\n        document.getElementById(\u0027loadingIndicator\u0027).style.display \u003d \u0027block\u0027;\n    }\n\n    function hideLoadingIndicator() {\n        document.getElementById(\u0027loadingIndicator\u0027).style.display \u003d \u0027none\u0027;\n    }\n    \u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e"},{"id":"bdd641d8-72c4-46f9-a4a0-c6b4255ef1a5","name":"SLCSS","type":"html","source":"    \u003cstyle\u003e\n        button {\n            margin: 2px;\n        }\n\n        .tab-container {\n            display: flex;\n            border-bottom: 1px solid #ccc;\n            margin-bottom: 20px;\n        }\n        .tab {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 10px 15px;\n            cursor: pointer;\n            border: 1px solid #ccc;\n            border-bottom: none;\n            background-color: #f0f0f0;\n            margin-right: 5px;\n            border-radius: 5px 5px 0 0;\n        }\n        .tab .tab-text {\n            margin-right: 15px;\n        }\n        .tab-content {\n            display: none;\n            padding: 20px;\n            background-color: #fff;\n            border: 1px solid #ccc;\n            border-radius: 5px;\n            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\n        }\n        .tab-content.active {\n            display: block;\n        }\n        .tab-content h2 {\n            font-size: 1.8em;\n            color: #333;\n            margin-bottom: 20px;\n            text-align: center;\n        }\n        .tab .close-tab {\n            position: absolute;\n            right: 4px;\n            top: 13px;\n            cursor: pointer;\n            font-weight: bold;\n            color: #888;\n            font-size: 14px;\n            line-height: 1;\n        }\n        .tab .close-tab:hover {\n            color: #000;\n        }\n\n        \n        .modal {\n            display: none;\n            position: fixed;\n            z-index: 1;\n            left: 0;\n            top: 0;\n            width: 100%;\n            height: 100%;\n            overflow: auto;\n            background-color: rgba(0,0,0,0.4);\n        }\n        .modal-content {\n            background-color: #fefefe;\n            margin: 15% auto;\n            padding: 20px;\n            border: 1px solid #888;\n            width: 80%;\n        }\n        .modal-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n        .close {\n            color: #aaa;\n            float: right;\n            font-size: 28px;\n            font-weight: bold;\n            cursor: pointer;\n        }\n        .close:hover,\n        .close:focus {\n            color: black;\n            text-decoration: none;\n        }\n        .print-icon {\n            font-size: 24px;\n            cursor: pointer;\n            margin-right: 10px;\n        }\n        @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n        }\n        #transactionReportTable, #monthEndReportTable, #inventory-table, #palletDueDateTable {\n            width: 100%;\n            border-collapse: collapse;\n        }\n        #transactionReportTable th, #transactionReportTable td,\n        #palletDueDateTable th, #palletDueDateTable td,\n        #monthEndReportTable th, #monthEndReportTable td,\n        #inventory-table th, #inventory-table td {\n            border: 1px solid #ddd;\n            padding: 8px;\n            text-align: left;\n        }\n        #transactionReportTable th, #monthEndReportTable th,#palletDueDateTable th, #inventory-table th {\n            background-color: #f2f2f2;\n            font-weight: bold;\n        }\n        .even-row {\n            background-color: #f9f9f9;\n        }\n        .odd-row {\n            background-color: #ffffff;\n        }\n        .group-start {\n            border-top: 2px solid #333;\n            font-weight: bold;\n        }\n        @media print {\n            body * {\n                visibility: hidden;\n            }\n            .modal, .modal * {\n                visibility: visible;\n            }\n            .modal {\n                position: absolute;\n                left: 0;\n                top: 0;\n            }\n            .modal-content {\n                width: 100%;\n                border: none;\n            }\n            .close, .print-icon {\n                display: none;\n            }\n            table {\n                font-size: 10pt;\n            }\n            th, td {\n                padding: 4px;\n            }\n        }\n        select#pickItem {\n            width: 100%;\n            padding: 8px;\n            margin: 5px 0;\n            border: 1px solid #ccc;\n            border-radius: 4px;\n            background-color: white;\n            font-size: 16px;\n        }\n        select#pickItem:focus {\n            outline: none;\n            border-color: #4CAF50;\n        }\n\n        #endMonthReportOptions,#palletDueDateOptions,\n#transactionReportOptions,\n#requestFormOptions {\n    background-color: #f8f9fa;\n    border: 1px solid #dee2e6;\n    border-radius: 5px;\n    padding: 15px;\n    margin-bottom: 20px;\n}\n\n/* Styles for select dropdowns */\nselect {\n    width: 150px;\n    padding: 8px;\n    margin: 5px;\n    border: 1px solid #ced4da;\n    border-radius: 4px;\n    background-color: white;\n    font-size: 14px;\n}\n\n/* Styles for number inputs */\ninput[type\u003d\"number\"] {\n    width: 100px;\n    padding: 8px;\n    margin: 5px;\n    border: 1px solid #ced4da;\n    border-radius: 4px;\n    font-size: 14px;\n}\n\n/* Specific styles for Stock In/Out buttons */\n#requestFormOptions button {\n    width: 100px;\n}\n\n.cut-off-button-wrapper {\n    display: flex;\n    justify-content: center;\n    width: 100%;\n    margin-bottom: 35px;\n}\n\n.cut-off-button {\n    padding: 10px 20px;\n    font-size: 16px;\n    font-weight: bold;\n    text-align: center;\n    text-decoration: none;\n    border-radius: 5px;\n    transition: all 0.3s ease;\n    cursor: pointer;\n    background-color: #2c3e50;\n    color: white;\n    border: 2px solid #2c3e50;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n    margin-bottom: 35px;\n}\n\n.cut-off-button:hover {\n    background-color: #34495e;\n    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);\n    transform: translateY(-2px);\n}\n\n.cut-off-button:active {\n    transform: translateY(1px);\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n}\n       \n.print-icon {\n    cursor: pointer;\n    padding: 5px 10px;\n    background-color: #f0f0f0;\n    border: 1px solid #ccc;\n    border-radius: 3px;\n    display: inline-flex;\n    align-items: center;\n    gap: 5px;\n    font-size: 12px; /* Set the base font size for the entire button */\n}\n\n.print-icon:hover {\n    background-color: #e0e0e0;\n}\n\n.print-icon i {\n    font-size: 12px; /* Keep this the same as the base font size */\n}\n        \n    \u003c/style\u003e"},{"id":"55542315-0473-4a46-8e9a-07545fb41190","name":"SLScript","type":"html","source":"\u003cscript\u003e\n\n  const options \u003d document.querySelectorAll(\u0027.report-option\u0027);\n        \n        options.forEach(option \u003d\u003e {\n            option.addEventListener(\u0027click\u0027, function() {\n                options.forEach(opt \u003d\u003e opt.classList.remove(\u0027selected\u0027));\n                this.classList.add(\u0027selected\u0027);\n            });\n        });\n\n// General functions\nfunction activateTab(element, contentId) {\n    var tabs \u003d document.getElementsByClassName(\u0027tab\u0027);\n    for (var i \u003d 0; i \u003c tabs.length; i++) {\n        tabs[i].classList.remove(\u0027active\u0027);\n    }\n    element.classList.add(\u0027active\u0027);\n\n    var tabContents \u003d document.getElementsByClassName(\u0027tab-content\u0027);\n    for (var i \u003d 0; i \u003c tabContents.length; i++) {\n        tabContents[i].classList.remove(\u0027active\u0027);\n    }\n    var contentElement \u003d document.getElementById(contentId);\n    if (contentElement) {\n        contentElement.classList.add(\u0027active\u0027);\n    }\n}\n\nfunction showLoadingIndicator() {\n    var indicator \u003d document.getElementById(\u0027loadingIndicator\u0027);\n    if (indicator) {\n        indicator.style.display \u003d \u0027block\u0027;\n    }\n}\n\nfunction hideLoadingIndicator() {\n    var indicator \u003d document.getElementById(\u0027loadingIndicator\u0027);\n    if (indicator) {\n        indicator.style.display \u003d \u0027none\u0027;\n    }\n}\n\n// Inventory table functions\nfunction updateInventoryTable(data) {\n    SLpopulateTable(data);\n    updateInventoryTotals();\n}\n\nfunction SLpopulateTable(data) {\n    console.log(\u0027Received data:\u0027, data);\n\n    var tableBody \u003d document.getElementById(\u0027inventory-table-body\u0027);\n    if (!tableBody) {\n        console.error(\u0027Table body not found\u0027);\n        return;\n    }\n\n    tableBody.innerHTML \u003d \u0027\u0027;\n\n    data.forEach(function(rowData, index) {\n        var row \u003d Array.isArray(rowData) ? rowData : rowData.data;\n        var colors \u003d Array.isArray(rowData) ? null : rowData.colors;\n\n        console.log(\u0027Processing row:\u0027, row);\n        console.log(\u0027Colors for row:\u0027, colors);\n\n        if (parseFloat(row[9]) \u003e 0) {\n            var tr \u003d document.createElement(\u0027tr\u0027);\n            row.forEach(function(cell, cellIndex) {\n                var td \u003d document.createElement(\u0027td\u0027);\n                \n                // Set cell content\n                if (cellIndex \u003d\u003d\u003d 9 || cellIndex \u003d\u003d\u003d 10) {\n                    td.textContent \u003d Math.round(parseFloat(cell));\n                } else {\n                    td.textContent \u003d cell;\n                }\n                \n                // Set background color if available\n                if (colors \u0026\u0026 colors[cellIndex] \u003d\u003d\u003d \u0027#ffff00\u0027) {\n                    td.style.backgroundColor \u003d \u0027yellow\u0027;\n                    console.log(\u0027Setting yellow background for cell:\u0027, cellIndex);\n                }\n                \n                td.addEventListener(\u0027contextmenu\u0027, function(e) {\n                    e.preventDefault();\n                    toggleCellColor(this, row[0], row[4], cellIndex);\n                });\n                tr.appendChild(td);\n            });\n            tr.style.cursor \u003d \u0027pointer\u0027;\n            tr.onclick \u003d function() { \n                showTransactionDetails(row[0], row[4], row[1]);\n            };\n            tableBody.appendChild(tr);\n        }\n    });\n\n    updateInventoryTotals();\n}\n\nfunction toggleCellColor(cell, itemCode, lotNumber, cellIndex) {\n    if (cell.style.backgroundColor \u003d\u003d\u003d \u0027yellow\u0027) {\n        cell.style.backgroundColor \u003d \u0027\u0027;\n        saveCellColorToSheet(itemCode, lotNumber, cellIndex, \u0027\u0027);\n    } else {\n        cell.style.backgroundColor \u003d \u0027yellow\u0027;\n        saveCellColorToSheet(itemCode, lotNumber, cellIndex, \u0027yellow\u0027);\n    }\n}\n\nfunction saveCellColorToSheet(itemCode, lotNumber, cellIndex, color) {\n    google.script.run\n        .withSuccessHandler(function() {\n            console.log(\u0027Cell color updated successfully\u0027);\n        })\n        .withFailureHandler(function(error) {\n            console.error(\u0027Error updating cell color:\u0027, error);\n        })\n        .SLupdateCellColor(itemCode, lotNumber, cellIndex, color);\n}\n\nfunction updateInventoryTotals() {\n    var tableBody \u003d document.getElementById(\u0027inventory-table-body\u0027);\n    if (!tableBody) return;\n\n    var rows \u003d tableBody.getElementsByTagName(\u0027tr\u0027);\n    let totalQuantity \u003d 0;\n    let totalPallets \u003d 0;\n\n    for (var i \u003d 0; i \u003c rows.length; i++) {\n        var cells \u003d rows[i].getElementsByTagName(\u0027td\u0027);\n        if (cells.length \u003e 10) {\n            totalQuantity +\u003d parseFloat(cells[9].textContent) || 0;\n            totalPallets +\u003d parseFloat(cells[10].textContent) || 0;\n        }\n    }\n\n    var totalsRow \u003d document.getElementById(\u0027totals-row\u0027);\n    if (totalsRow) {\n        totalsRow.innerHTML \u003d `\n            \u003ctd colspan\u003d\"9\" style\u003d\"text-align: right;\"\u003e\u003cstrong\u003eTotal:\u003c/strong\u003e\u003c/td\u003e\n            \u003ctd\u003e\u003cstrong\u003e${Math.round(totalQuantity)}\u003c/strong\u003e\u003c/td\u003e\n            \u003ctd\u003e\u003cstrong\u003e${Math.round(totalPallets)}\u003c/strong\u003e\u003c/td\u003e\n        `;\n    }\n}\n\n// Transaction details functions\nfunction showTransactionDetails(itemCode, lotNumber, productDescription) {\n    showLoadingIndicator();\n    \n    google.script.run\n        .withSuccessHandler(function(result) {\n            hideLoadingIndicator();\n            displayTransactionModal(result, productDescription);\n        })\n        .withFailureHandler(function(error) {\n            hideLoadingIndicator();\n            console.error(\u0027An error occurred while fetching transaction details:\u0027, error);\n            alert(\u0027An error occurred while fetching transaction details. Please try again.\u0027);\n        })\n        .SLgetTransactionDetails(itemCode, lotNumber);\n}\n\nfunction displayTransactionModal(transactionData, productDescription) {\n    var modal \u003d document.getElementById(\u0027transactionModal\u0027);\n    var tableBody \u003d document.getElementById(\u0027transactionTableBody\u0027);\n    var modalHeader \u003d document.querySelector(\u0027#transactionModal .modal-content h3\u0027);\n    \n    if (!modal || !tableBody || !modalHeader) {\n        console.error(\u0027Required elements for transaction modal not found\u0027);\n        return;\n    }\n    \n    modalHeader.textContent \u003d \u0027Transaction Details - \u0027 + productDescription;\n    \n    tableBody.innerHTML \u003d \u0027\u0027;\n    if (transactionData \u0026\u0026 transactionData.length \u003e 0) {\n        transactionData.forEach(function(transaction) {\n            var tr \u003d document.createElement(\u0027tr\u0027);\n            [\u0027date\u0027, \u0027type\u0027, \u0027quantity\u0027, \u0027pallet\u0027].forEach(function(key) {\n                var td \u003d document.createElement(\u0027td\u0027);\n                td.textContent \u003d transaction[key];\n                tr.appendChild(td);\n            });\n            tableBody.appendChild(tr);\n        });\n    } else {\n        var tr \u003d document.createElement(\u0027tr\u0027);\n        var td \u003d document.createElement(\u0027td\u0027);\n        td.colSpan \u003d 4;\n        td.textContent \u003d \u0027No transaction data found\u0027;\n        tr.appendChild(td);\n        tableBody.appendChild(tr);\n    }\n\n    modal.style.display \u003d \"block\";\n}\n\n// Event listener for closing the modal\ndocument.addEventListener(\u0027DOMContentLoaded\u0027, function() {\n    var closeButton \u003d document.querySelector(\u0027#transactionModal .close\u0027);\n    if (closeButton) {\n        closeButton.onclick \u003d function() {\n            document.getElementById(\u0027transactionModal\u0027).style.display \u003d \"none\";\n        }\n    }\n});\n\n// Draw Out functions\n\nfunction initializeDrawOutForm() {\n    const tomorrow \u003d new Date();\n    tomorrow.setDate(tomorrow.getDate() + 1);\n    \n    // If tomorrow is Sunday (day 0), add one more day\n    if (tomorrow.getDay() \u003d\u003d\u003d 0) {\n        tomorrow.setDate(tomorrow.getDate() + 1);\n    }\n    \n    document.getElementById(\u0027drawOutDate\u0027).valueAsDate \u003d tomorrow;\n}\ninitializeDrawOutForm();\n\nfunction showInventoryModal() {\n    var inventoryTable \u003d document.getElementById(\u0027inventory-table\u0027);\n    if (!inventoryTable) {\n        console.error(\"Inventory table not found\");\n        return;\n    }\n\n    // Create modal elements\n    var modal \u003d document.createElement(\u0027div\u0027);\n    modal.id \u003d \u0027inventoryModal\u0027;\n    modal.className \u003d \u0027modal\u0027;\n\n    var modalContent \u003d document.createElement(\u0027div\u0027);\n    modalContent.className \u003d \u0027modal-content\u0027;\n\n    var closeBtn \u003d document.createElement(\u0027span\u0027);\n    closeBtn.className \u003d \u0027close\u0027;\n    closeBtn.innerHTML \u003d \u0027\u0026times;\u0027;\n    closeBtn.onclick \u003d function() {\n        modal.style.display \u003d \u0027none\u0027;\n    };\n\n    // Create dropdown for product descriptions\n    var dropdown \u003d document.createElement(\u0027select\u0027);\n    dropdown.id \u003d \u0027productDescriptionDropdown\u0027;\n    dropdown.style.marginBottom \u003d \u002710px\u0027;\n    \n    // Add default option\n    var defaultOption \u003d document.createElement(\u0027option\u0027);\n    defaultOption.value \u003d \u0027\u0027;\n    defaultOption.textContent \u003d \u0027Select a product\u0027;\n    dropdown.appendChild(defaultOption);\n\n    // Get unique product descriptions (excluding the last row which is the total)\n    var descriptions \u003d new Set();\n    var rows \u003d inventoryTable.getElementsByTagName(\u0027tr\u0027);\n    for (var i \u003d 1; i \u003c rows.length - 1; i++) {  // Exclude header and last row\n        var description \u003d rows[i].cells[1].textContent;\n        descriptions.add(description);\n    }\n\n    // Add options to dropdown\n    descriptions.forEach(function(description) {\n        var option \u003d document.createElement(\u0027option\u0027);\n        option.value \u003d description;\n        option.textContent \u003d description;\n        dropdown.appendChild(option);\n    });\n\n    // Add event listener to dropdown\n    dropdown.addEventListener(\u0027change\u0027, function() {\n        filterTable(this.value);\n    });\n\n    // Clone the inventory table\n    var clonedTable \u003d inventoryTable.cloneNode(true);\n    clonedTable.id \u003d \u0027modal-inventory-table\u0027;\n\n    // Set up row click handlers (excluding the last row)\n    var tableRows \u003d clonedTable.getElementsByTagName(\u0027tr\u0027);\n    for (var i \u003d 1; i \u003c tableRows.length - 1; i++) {\n        tableRows[i].onclick \u003d function() {\n            selectItem(this);\n            modal.style.display \u003d \u0027none\u0027;\n        };\n        tableRows[i].style.cursor \u003d \u0027pointer\u0027;\n    }\n\n    // Function to filter the table based on selected product description\n    function filterTable(selectedDescription) {\n        var rows \u003d clonedTable.getElementsByTagName(\u0027tr\u0027);\n        for (var i \u003d 1; i \u003c rows.length - 1; i++) {  // Exclude header and last row\n            var row \u003d rows[i];\n            var description \u003d row.cells[1].textContent;\n            if (selectedDescription \u003d\u003d\u003d \u0027\u0027 || description \u003d\u003d\u003d selectedDescription) {\n                row.style.display \u003d \u0027\u0027;\n            } else {\n                row.style.display \u003d \u0027none\u0027;\n            }\n        }\n        // Always show the last row (total)\n        rows[rows.length - 1].style.display \u003d \u0027\u0027;\n    }\n\n    // Assemble the modal\n    modalContent.appendChild(closeBtn);\n    modalContent.appendChild(dropdown);\n    modalContent.appendChild(clonedTable);\n    modal.appendChild(modalContent);\n\n    // Add modal to the document body\n    document.body.appendChild(modal);\n\n    // Display the modal\n    modal.style.display \u003d \u0027block\u0027;\n}\n\nfunction selectItem(row) {\n    // Extract data from the selected row\n    var cells \u003d row.cells;\n    var itemCode \u003d cells[0].textContent;\n    var productDescription \u003d cells[1].textContent;\n    var lotNumber \u003d cells[4].textContent;\n    var availableQuantity \u003d cells[9].textContent;\n\n    // Populate the draw-out form (adjust field IDs as necessary)\n    document.getElementById(\u0027itemCode\u0027).value \u003d itemCode;\n    document.getElementById(\u0027productDescription\u0027).value \u003d productDescription;\n    document.getElementById(\u0027lotNumber\u0027).value \u003d lotNumber;\n    document.getElementById(\u0027availableQuantity\u0027).value \u003d availableQuantity;\n\n    // Focus on the quantity input\n    document.getElementById(\u0027drawOutQuantity\u0027).focus();\n}\nfunction selectItem(row) {\n    var cells \u003d row.cells;\n    document.getElementById(\u0027selected-item-code\u0027).textContent \u003d cells[0].textContent;\n    document.getElementById(\u0027selected-product-description\u0027).textContent \u003d cells[1].textContent;\n    document.getElementById(\u0027selected-packing\u0027).textContent \u003d cells[2].textContent;\n    document.getElementById(\u0027selected-expiry-batch\u0027).textContent \u003d cells[3].textContent;\n    document.getElementById(\u0027selected-lot-no\u0027).textContent \u003d cells[4].textContent;\n    document.getElementById(\u0027selected-date-stored\u0027).textContent \u003d cells[5].textContent;\n    document.getElementById(\u0027selected-container-no\u0027).textContent \u003d cells[6].textContent;\n    document.getElementById(\u0027selected-bal-quantity\u0027).textContent \u003d cells[9].textContent;\n    document.getElementById(\u0027selected-bal-pallet\u0027).textContent \u003d cells[10].textContent;\n\n    document.getElementById(\u0027input-quantity\u0027).disabled \u003d false;\n    document.getElementById(\u0027input-pallet\u0027).disabled \u003d false;\n}\n\nfunction drawOutStock() {\n    var itemCode \u003d document.getElementById(\u0027selected-item-code\u0027).textContent;\n    var quantity \u003d document.getElementById(\u0027input-quantity\u0027).value;\n    var pallet \u003d document.getElementById(\u0027input-pallet\u0027).value;\n    var date \u003d document.getElementById(\u0027drawOutDate\u0027).value;\n\n    if (!itemCode || !quantity || !pallet || !date) {\n        alert(\u0027Please fill in all fields\u0027);\n        return;\n    }\n\n    var balQuantity \u003d parseInt(document.getElementById(\u0027selected-bal-quantity\u0027).textContent);\n    var balPallet \u003d parseInt(document.getElementById(\u0027selected-bal-pallet\u0027).textContent);\n\n    if (parseInt(quantity) \u003e balQuantity || parseInt(pallet) \u003e balPallet) {\n        alert(\u0027Draw out quantity or pallet cannot exceed available balance\u0027);\n        return;\n    }\n\n    var drawOutData \u003d {\n        itemCode: itemCode,\n        quantity: quantity,\n        pallet: pallet,\n        date: date,\n        productDescription: document.getElementById(\u0027selected-product-description\u0027).textContent,\n        packing: document.getElementById(\u0027selected-packing\u0027).textContent,\n        expiryBatch: document.getElementById(\u0027selected-expiry-batch\u0027).textContent,\n        lotNo: document.getElementById(\u0027selected-lot-no\u0027).textContent,\n        dateStored: document.getElementById(\u0027selected-date-stored\u0027).textContent,\n        containerNo: document.getElementById(\u0027selected-container-no\u0027).textContent\n    };\n\n    updateLocalDataAndUI(drawOutData);\n    updateInventoryTotals();\n\n    google.script.run.withSuccessHandler(onDrawOutSuccess).withFailureHandler(onDrawOutFailure).saveDrawOutData(drawOutData);\n}\n\nfunction updateLocalDataAndUI(data) {\n    var tableBody \u003d document.getElementById(\u0027inventory-table-body\u0027);\n    var rows \u003d tableBody.getElementsByTagName(\u0027tr\u0027);\n    for (var i \u003d 0; i \u003c rows.length; i++) {\n        var cells \u003d rows[i].getElementsByTagName(\u0027td\u0027);\n        if (cells[0].textContent \u003d\u003d\u003d data.itemCode \u0026\u0026\n            cells[3].textContent \u003d\u003d\u003d data.expiryBatch \u0026\u0026\n            cells[4].textContent \u003d\u003d\u003d data.lotNo) {\n            cells[9].textContent \u003d parseInt(cells[9].textContent) - parseInt(data.quantity);\n            cells[10].textContent \u003d parseInt(cells[10].textContent) - parseInt(data.pallet);\n            break;\n        }\n    }\n\n    var balQuantityElem \u003d document.getElementById(\u0027selected-bal-quantity\u0027);\n    var balPalletElem \u003d document.getElementById(\u0027selected-bal-pallet\u0027);\n    if (balQuantityElem \u0026\u0026 balPalletElem) {\n        balQuantityElem.textContent \u003d parseInt(balQuantityElem.textContent) - parseInt(data.quantity);\n        balPalletElem.textContent \u003d parseInt(balPalletElem.textContent) - parseInt(data.pallet);\n    }\n\n    updateInventoryTotals();\n}\n\nfunction onDrawOutSuccess(result) {\n    alert(\u0027Stock drawn out successfully\u0027);\n    clearDrawOutForm();\n    updateInventoryTable(result);\n}\n\nfunction onDrawOutFailure(error) {\n    alert(\u0027Error drawing out stock: \u0027 + error);\n    google.script.run.withSuccessHandler(updateInventoryTable).SLgetInventoryData();\n}\n\nfunction clearDrawOutForm() {\n    document.getElementById(\u0027selected-item-code\u0027).textContent \u003d \u0027\u0027;\n    document.getElementById(\u0027selected-product-description\u0027).textContent \u003d \u0027\u0027;\n    document.getElementById(\u0027selected-packing\u0027).textContent \u003d \u0027\u0027;\n    document.getElementById(\u0027selected-expiry-batch\u0027).textContent \u003d \u0027\u0027;\n    document.getElementById(\u0027selected-lot-no\u0027).textContent \u003d \u0027\u0027;\n    document.getElementById(\u0027selected-date-stored\u0027).textContent \u003d \u0027\u0027;\n    document.getElementById(\u0027selected-container-no\u0027).textContent \u003d \u0027\u0027;\n    document.getElementById(\u0027selected-bal-quantity\u0027).textContent \u003d \u0027\u0027;\n    document.getElementById(\u0027selected-bal-pallet\u0027).textContent \u003d \u0027\u0027;\n    document.getElementById(\u0027input-quantity\u0027).value \u003d \u0027\u0027;\n    document.getElementById(\u0027input-pallet\u0027).value \u003d \u0027\u0027;\n}\n\n// Store In functions\n\nfunction fetchLotNumberHint() {\n    google.script.run.withSuccessHandler(function(hint) {\n        document.getElementById(\u0027lotNumberHint\u0027).textContent \u003d `(${hint})`;\n    }).getLotNumberHint();\n}\n\nfunction initializeStoreInForm() {\n    document.getElementById(\u0027storeInDate\u0027).valueAsDate \u003d new Date();\n    document.getElementById(\u0027dateStored\u0027).valueAsDate \u003d new Date();\n    loadPickItemOptions();\n    fetchLotNumberHint();\n}\n\nfunction loadPickItemOptions() {\n    google.script.run.withSuccessHandler(function(items) {\n        const pickItemSelect \u003d document.getElementById(\u0027pickItem\u0027);\n        pickItemSelect.innerHTML \u003d \u0027\u003coption value\u003d\"\"\u003eSelect an item\u003c/option\u003e\u0027;\n        items.forEach(item \u003d\u003e {\n            const option \u003d document.createElement(\u0027option\u0027);\n            option.value \u003d item;\n            option.textContent \u003d item;\n            pickItemSelect.appendChild(option);\n        });\n    }).getPickItemOptions();\n}\n\ndocument.getElementById(\u0027pickItem\u0027).addEventListener(\u0027change\u0027, function() {\n    const selectedItem \u003d this.value;\n    if (selectedItem) {\n        google.script.run.withSuccessHandler(function(itemDetails) {\n            document.getElementById(\u0027itemCode\u0027).value \u003d itemDetails.itemCode;\n            document.getElementById(\u0027productDescription\u0027).value \u003d itemDetails.productDescription;\n            document.getElementById(\u0027packingSize\u0027).value \u003d itemDetails.packingSize;\n        }).getItemDetails(selectedItem);\n    } else {\n        document.getElementById(\u0027itemCode\u0027).value \u003d \u0027\u0027;\n        document.getElementById(\u0027productDescription\u0027).value \u003d \u0027\u0027;\n        document.getElementById(\u0027packingSize\u0027).value \u003d \u0027\u0027;\n    }\n});\n\nfunction submitStoreIn() {\n    const storeInData \u003d {\n        storeInDate: document.getElementById(\u0027storeInDate\u0027).value, // Add this line\n        itemCode: document.getElementById(\u0027itemCode\u0027).value,\n        productDescription: document.getElementById(\u0027productDescription\u0027).value,\n        packingSize: document.getElementById(\u0027packingSize\u0027).value,\n        expiryBatch: document.getElementById(\u0027expiryBatch\u0027).value,\n        lotNumber: document.getElementById(\u0027lotNumber\u0027).value,\n        dateStored: document.getElementById(\u0027dateStored\u0027).value,\n        container: document.getElementById(\u0027container\u0027).value,\n        quantity: document.getElementById(\u0027quantity\u0027).value,\n        pallet: document.getElementById(\u0027pallet\u0027).value\n    };\n\n    storeInData.lotNumber \u003d storeInData.lotNumber.replace(/(PCR 24 \\/)(.*)/, \u0027$1 $2\u0027);\n\n    updateLocalInventoryTable(storeInData);\n    updateInventoryTotals();\n\n    google.script.run.withSuccessHandler(onStoreInSuccess)\n                     .withFailureHandler(onStoreInFailure)\n                     .saveStoreInData(storeInData);\n}\n\nfunction updateLocalInventoryTable(data) {\n    const tableBody \u003d document.getElementById(\u0027inventory-table-body\u0027);\n    const newRow \u003d tableBody.insertRow(-1);\n    \n    const cellOrder \u003d [\u0027itemCode\u0027, \u0027productDescription\u0027, \u0027packingSize\u0027, \u0027expiryBatch\u0027, \u0027lotNumber\u0027, \n                       \u0027dateStored\u0027, \u0027container\u0027, \u0027\u0027, \u0027\u0027, \u0027quantity\u0027, \u0027pallet\u0027];\n    \n    cellOrder.forEach((key, index) \u003d\u003e {\n        const cell \u003d newRow.insertCell(index);\n        cell.textContent \u003d key ? data[key] : \u0027\u0027;\n    });\n\n    updateInventoryTotals();\n}\n\nfunction onStoreInSuccess(result) {\n    alert(\u0027Stock stored in successfully\u0027);\n    const containerValue \u003d document.getElementById(\u0027container\u0027).value;\n    clearStoreInForm();\n    document.getElementById(\u0027container\u0027).value \u003d containerValue;\n    google.script.run.withSuccessHandler(updateInventoryTable).SLgetInventoryData();\n}\n\nfunction onStoreInFailure(error) {\n    alert(\u0027Error storing in stock: \u0027 + error);\n    google.script.run.withSuccessHandler(updateInventoryTable).SLgetInventoryData();\n}\n\nfunction clearStoreInForm() {\n    const containerValue \u003d document.getElementById(\u0027container\u0027).value;\n    document.getElementById(\u0027storeInForm\u0027).reset();\n    initializeStoreInForm();\n    document.getElementById(\u0027container\u0027).value \u003d containerValue;\n}\n\n// Report functions\nfunction showEndMonthReportOptions() {\n    hideAllReportOptions();\n    var options \u003d document.getElementById(\u0027endMonthReportOptions\u0027);\n    options.style.display \u003d \u0027block\u0027;\n    \n    var currentDate \u003d new Date();\n    var previousMonth \u003d new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, 1);\n    \n    document.getElementById(\u0027monthSelect\u0027).value \u003d (previousMonth.getMonth() + 1).toString().padStart(2, \u00270\u0027);\n    document.getElementById(\u0027yearSelect\u0027).value \u003d previousMonth.getFullYear();\n\n    console.log(\u0027End Month Report options displayed\u0027);\n}\n\nfunction getMonthName(monthInput) {\n    const monthNames \u003d [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\n                        \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\n    \n    // Convert input to a number if it\u0027s a string\n    let monthNumber \u003d parseInt(monthInput, 10);\n\n    // If parsing failed or input is out of range, try to match against month names\n    if (isNaN(monthNumber) || monthNumber \u003c 1 || monthNumber \u003e 12) {\n        let lowercaseInput \u003d monthInput.toLowerCase();\n        for (let i \u003d 0; i \u003c monthNames.length; i++) {\n            if (monthNames[i].toLowerCase().startsWith(lowercaseInput)) {\n                return monthNames[i];\n            }\n        }\n        console.error(\u0027Invalid month input:\u0027, monthInput);\n        return \u0027Err\u0027;\n    }\n\n    // Adjust for zero-based index\n    return monthNames[monthNumber - 1];\n}\n\nfunction getAbbreviatedMonthName(monthInput) {\n    const monthNames \u003d [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\n                        \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\n    \n    let monthNumber \u003d parseInt(monthInput, 10);\n    if (isNaN(monthNumber) || monthNumber \u003c 1 || monthNumber \u003e 12) {\n        console.error(\u0027Invalid month input:\u0027, monthInput);\n        return \u0027Err\u0027;\n    }\n\n    return monthNames[monthNumber - 1];\n}\nfunction ViewEndMonthReport() {\n    var month \u003d document.getElementById(\u0027monthSelect\u0027).value;\n    var year \u003d document.getElementById(\u0027yearSelect\u0027).value;\n    var sheetName \u003d getAbbreviatedMonthName(month) + \u0027 \u0027 + year;\n\n    console.log(\u0027User selected:\u0027, { month: month, year: year, sheetName: sheetName });\n\n    showLoadingIndicator();\n\n    google.script.run\n        .withSuccessHandler(function(data) {\n            console.log(\u0027Successfully fetched data for\u0027, sheetName);\n            populateMonthEndReportTable(data, month, year);\n            showMonthEndReportModal();\n            hideLoadingIndicator();\n        })\n        .withFailureHandler(function(error) {\n            console.error(\u0027Error fetching report:\u0027, error);\n            console.log(\u0027Failed to fetch data for\u0027, sheetName);\n            populateMonthEndReportTable(null, month, year);\n            showMonthEndReportModal();\n            hideLoadingIndicator();\n        })\n        .getMonthEndReport(sheetName);\n}\n\nfunction populateMonthEndReportTable(data, month, year) {\n    var tbody \u003d document.getElementById(\u0027monthEndReportTableBody\u0027);\n    tbody.innerHTML \u003d \u0027\u0027;\n\n    if (data \u0026\u0026 data.length \u003e 0) {\n        console.log(\u0027Populating table with\u0027, data.length, \u0027rows of data\u0027);\n        data.forEach(function(row) {\n            var tr \u003d document.createElement(\u0027tr\u0027);\n            row.forEach(function(cell) {\n                var td \u003d document.createElement(\u0027td\u0027);\n                td.textContent \u003d cell;\n                tr.appendChild(td);\n            });\n            tbody.appendChild(tr);\n        });\n\n        // Calculate and display totals\n        var totals \u003d calculateTotals(data);\n        displayTotals(totals);\n    } else {\n        console.log(\u0027No data available for\u0027, month, year);\n        var tr \u003d document.createElement(\u0027tr\u0027);\n        var td \u003d document.createElement(\u0027td\u0027);\n        td.textContent \u003d \u0027No data available for the selected month and year.\u0027;\n        td.colSpan \u003d 10;  // Adjust this number based on your table columns\n        tr.appendChild(td);\n        tbody.appendChild(tr);\n    }\n\n    var fullMonthName \u003d getFullMonthName(month);\n    var reportTitle \u003d \u0027Sing Long Inventory Month End Report - \u0027 + fullMonthName + \u0027 \u0027 + year;\n    document.querySelector(\u0027#monthEndReportModal .modal-header h3\u0027).textContent \u003d reportTitle;\n    console.log(\u0027Report title set:\u0027, reportTitle);\n}\n\nfunction calculateTotals(data) {\n    let totalQuantity \u003d 0;\n    let totalPallets \u003d 0;\n\n    data.forEach(function(row) {\n        // Assuming quantity is at index 8 and pallets at index 9\n        // Adjust these indices if the data structure is different\n        totalQuantity +\u003d parseInt(row[8]) || 0;\n        totalPallets +\u003d parseInt(row[9]) || 0;\n    });\n\n    return { quantity: totalQuantity, pallets: totalPallets };\n}\n\nfunction displayTotals(totals) {\n    // Add totals row to the table\n    var totalsRow \u003d document.createElement(\u0027tr\u0027);\n    totalsRow.innerHTML \u003d `\n        \u003ctd colspan\u003d\"8\" style\u003d\"text-align: right;\"\u003e\u003cstrong\u003eMonth End Totals:\u003c/strong\u003e\u003c/td\u003e\n        \u003ctd\u003e\u003cstrong\u003e${totals.quantity}\u003c/strong\u003e\u003c/td\u003e\n        \u003ctd\u003e\u003cstrong\u003e${totals.pallets}\u003c/strong\u003e\u003c/td\u003e\n    `;\n    document.getElementById(\u0027monthEndReportTableBody\u0027).appendChild(totalsRow);\n\n    // Update the summary div\n    var summaryDiv \u003d document.getElementById(\u0027monthEndReportSummary\u0027);\n    summaryDiv.innerHTML \u003d `\u003cp\u003e\u003cstrong\u003eMonth End Total Quantity: ${totals.quantity} | Total Pallets: ${totals.pallets}\u003c/strong\u003e\u003c/p\u003e`;\n}\n\nfunction getFullMonthName(monthNumber) {\n    const monthNames \u003d [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\n                        \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n    return monthNames[parseInt(monthNumber) - 1];\n}\n\nfunction showMonthEndReportModal() {\n    var modal \u003d document.getElementById(\u0027monthEndReportModal\u0027);\n    modal.style.display \u003d \u0027block\u0027;\n    console.log(\u0027Month End Report modal displayed\u0027);\n}\n\nfunction printMonthEndReport() {\n    var month \u003d document.getElementById(\u0027monthSelect\u0027).options[document.getElementById(\u0027monthSelect\u0027).selectedIndex].text;\n    var year \u003d document.getElementById(\u0027yearSelect\u0027).value;\n    \n    console.log(\u0027Printing report for\u0027, month, year);\n\n    var printWindow \u003d window.open(\u0027\u0027, \u0027_blank\u0027);\n    var tableContent \u003d document.getElementById(\u0027monthEndReportTable\u0027).outerHTML;\n    \n    var htmlContent \u003d `\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003ctitle\u003eSing Long Inventory Month End Report ${month} ${year}\u003c/title\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; font-size: 10pt; }\n                table { border-collapse: collapse; width: 100%; }\n                th, td { border: 1px solid black; padding: 4px; text-align: left; font-size: 8pt; }\n                th { background-color: #f2f2f2; }\n                @media print {\n                    body { margin: 0; padding: 10px; }\n                    table { page-break-inside: auto; }\n                    tr { page-break-inside: avoid; page-break-after: auto; }\n                    thead { display: table-header-group; }\n                }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n            \u003ch2 style\u003d\"font-size: 14pt;\"\u003eSing Long Inventory Month End Report - ${month} ${year}\u003c/h2\u003e\n            ${tableContent}\n        \u003c/body\u003e\n        \u003c/html\u003e\n    `;\n    \n    printWindow.document.write(htmlContent);\n    printWindow.document.close();\n    printWindow.focus();\n    \n    printWindow.onload \u003d function() {\n        printWindow.print();\n        printWindow.close();\n    };\n}\n\nfunction showTransactionReportOptions() {\n    hideAllReportOptions();\n    document.getElementById(\u0027transactionReportOptions\u0027).style.display \u003d \u0027block\u0027;\n}\n\ndocument.addEventListener(\u0027DOMContentLoaded\u0027, function() {\n    const currentDate \u003d new Date();\n    const currentMonth \u003d (currentDate.getMonth() + 1).toString().padStart(2, \u00270\u0027);\n    document.getElementById(\u0027openingStockMonth\u0027).value \u003d currentMonth;\n    document.getElementById(\u0027openingStockYear\u0027).value \u003d currentDate.getFullYear();\n})\n\nfunction generateTransactionReport() {\n    var month \u003d document.getElementById(\u0027openingStockMonth\u0027).value;\n    var year \u003d document.getElementById(\u0027openingStockYear\u0027).value;\n  \n    showLoadingIndicator();\n    google.script.run\n        .withSuccessHandler(function(data) {\n            displayTransactionReport(data);\n            hideLoadingIndicator();\n        })\n        .withFailureHandler(function(error) {\n            console.error(\u0027Error:\u0027, error);\n            hideLoadingIndicator();\n        })\n        .generateTransactionReport(month, year);\n}\n\nfunction displayTransactionReport(data) {\n    var tableBody \u003d document.getElementById(\u0027transactionReportTableBody\u0027);\n    tableBody.innerHTML \u003d \u0027\u0027;\n\n    var currentProduct \u003d \u0027\u0027;\n    var currentLot \u003d \u0027\u0027;\n\n    data.forEach(function(row, index) {\n        var tr \u003d document.createElement(\u0027tr\u0027);\n    \n        if (row.every(cell \u003d\u003e cell \u003d\u003d\u003d \u0027\u0027)) {\n            // This is an empty row, add some styling\n            tr.style.height \u003d \u002720px\u0027;\n        } else {\n            row.forEach(function(cell, cellIndex) {\n                var td \u003d document.createElement(\u0027td\u0027);\n                td.textContent \u003d cell;\n                if (cellIndex \u003d\u003d\u003d 2) { // Date column\n                    td.style.whiteSpace \u003d \u0027nowrap\u0027;\n                }\n                tr.appendChild(td);\n            });\n\n            // Add alternating row colors\n            tr.classList.add(index % 2 \u003d\u003d\u003d 0 ? \u0027even-row\u0027 : \u0027odd-row\u0027);\n\n            // Highlight the first row of each product/lot group\n            if (row[0] !\u003d\u003d \u0027\u0027 || row[1] !\u003d\u003d \u0027\u0027) {\n                tr.classList.add(\u0027group-start\u0027);\n                currentProduct \u003d row[0];\n                currentLot \u003d row[1];\n            }\n        }\n    \n        tableBody.appendChild(tr);\n    });\n\n    showTransactionReportModal();\n}\n\nfunction showTransactionReportModal() {\n    var modal \u003d document.getElementById(\u0027transactionReportModal\u0027);\n    modal.style.display \u003d \u0027block\u0027;\n}\n\nfunction printTransactionTable() {\n    var printWindow \u003d window.open(\u0027\u0027, \u0027_blank\u0027);\n    var tableContent \u003d document.getElementById(\u0027transactionReportTable\u0027).outerHTML;\n    \n    var month \u003d document.getElementById(\u0027openingStockMonth\u0027).options[document.getElementById(\u0027openingStockMonth\u0027).selectedIndex].text;\n    var year \u003d document.getElementById(\u0027openingStockYear\u0027).value;\n    \n    var htmlContent \u003d `\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003ctitle\u003eSing Long Inventory Transaction Report ${month} ${year}\u003c/title\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; font-size: 10pt; }\n                table { border-collapse: collapse; width: 100%; }\n                th, td { border: 1px solid black; padding: 4px; text-align: left; font-size: 8pt; }\n                th { background-color: #f2f2f2; }\n                .group-start { border-top: 2px solid #333; font-weight: bold; }\n                @media print {\n                    body { margin: 0; padding: 10px; }\n                    table { page-break-inside: auto; }\n                    tr { page-break-inside: avoid; page-break-after: auto; }\n                    thead { display: table-header-group; }\n                }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n            \u003ch2 style\u003d\"font-size: 14pt;\"\u003eSing Long Inventory Transaction Report - ${month} ${year}\u003c/h2\u003e\n            ${tableContent}\n        \u003c/body\u003e\n        \u003c/html\u003e\n    `;\n    \n    printWindow.document.write(htmlContent);\n    printWindow.document.close();\n    printWindow.focus();\n    \n    printWindow.onload \u003d function() {\n        printWindow.print();\n        printWindow.close();\n    };\n}\n\n// Modal close functions\nfunction closeModal(modalId) {\n    document.getElementById(modalId).style.display \u003d \u0027none\u0027;\n}\n\n// Event listeners\ndocument.addEventListener(\u0027DOMContentLoaded\u0027, function() {\n    var firstTab \u003d document.querySelector(\u0027.tab\u0027);\n    var firstTabContent \u003d document.querySelector(\u0027.tab-content\u0027);\n    if (firstTab \u0026\u0026 firstTabContent) {\n        firstTab.classList.add(\u0027active\u0027);\n        firstTabContent.classList.add(\u0027active\u0027);\n    }\n    google.script.run.withSuccessHandler(SLpopulateTable).SLgetInventoryData();\n\n    // Set up modal close buttons\n    var closeButtons \u003d document.getElementsByClassName(\u0027close\u0027);\n    for (var i \u003d 0; i \u003c closeButtons.length; i++) {\n        closeButtons[i].onclick \u003d function() {\n            var modal \u003d this.closest(\u0027.modal\u0027);\n            if (modal) {\n                closeModal(modal.id);\n            }\n        };\n    }\n\n    // Close modals when clicking outside\n    window.onclick \u003d function(event) {\n        if (event.target.classList.contains(\u0027modal\u0027)) {\n            closeModal(event.target.id);\n        }\n    };\n\n    initializeStoreInForm();\n});\n\n//Request Form\nlet currentRequestFormType \u003d \u0027\u0027;\n\n// Function to show Request Form options\nfunction showRequestFormOptions() {\n    hideAllReportOptions();\n    document.getElementById(\u0027requestFormOptions\u0027).style.display \u003d \u0027block\u0027;\n}\n\nfunction hideAllReportOptions() {\n    document.getElementById(\u0027endMonthReportOptions\u0027).style.display \u003d \u0027none\u0027;\n    document.getElementById(\u0027transactionReportOptions\u0027).style.display \u003d \u0027none\u0027;\n    document.getElementById(\u0027requestFormOptions\u0027).style.display \u003d \u0027none\u0027;\n    document.getElementById(\u0027palletDueDateOptions\u0027).style.display \u003d \u0027none\u0027;\n}\n\n// Function to set the Request Form Type\nfunction setRequestFormType(type) {\n    currentRequestFormType \u003d type;\n    document.getElementById(\u0027loadingIndicator\u0027).style.display \u003d \u0027block\u0027;\n    google.script.run\n        .withSuccessHandler(populateDateDropdown)\n        .withFailureHandler(handleError)\n        .getRequestFormDates(type);\n}\n\n// Function to populate the date dropdown\nfunction populateDateDropdown(dates) {\n    const dateSelect \u003d document.getElementById(\u0027requestFormDate\u0027);\n    dateSelect.innerHTML \u003d \u0027\u0027;\n    dates.forEach(date \u003d\u003e {\n        const option \u003d document.createElement(\u0027option\u0027);\n        option.value \u003d date;\n        option.textContent \u003d date;\n        dateSelect.appendChild(option);\n    });\n    document.getElementById(\u0027requestFormDateSelection\u0027).style.display \u003d \u0027block\u0027;\n    document.getElementById(\u0027loadingIndicator\u0027).style.display \u003d \u0027none\u0027;\n}\n\n// Function to generate and print the Request Form\nfunction generateAndPrintRequestForm() {\n    const selectedDate \u003d document.getElementById(\u0027requestFormDate\u0027).value;\n    const collectionTime \u003d document.getElementById(\u0027collectionTime\u0027).value;\n    document.getElementById(\u0027loadingIndicator\u0027).style.display \u003d \u0027block\u0027;\n    google.script.run\n        .withSuccessHandler(response \u003d\u003e {\n            if (response \u0026\u0026 response.formData) {\n                printRequestForm(response.formData, selectedDate, collectionTime, response.serialNumber);\n            } else {\n                handleError(\u0027No data found for the selected date.\u0027);\n            }\n        })\n        .withFailureHandler(handleError)\n        .getRequestFormData(currentRequestFormType, selectedDate);\n}\n\n// Function to print the Request Form\nfunction printRequestForm(data, selectedDate, collectionTime, serialNumber) {\n    const printWindow \u003d window.open(\u0027\u0027, \u0027_blank\u0027);\n    \n    let tableRows \u003d data.map((row, index) \u003d\u003e `\n        \u003ctr\u003e\n            \u003ctd\u003e${index + 1}\u003c/td\u003e\n            \u003ctd\u003e${row.productDescription || \u0027\u0027}\u003c/td\u003e\n            \u003ctd\u003e${row.packing || \u0027\u0027}\u003c/td\u003e\n            \u003ctd\u003e${row.lotNumber || \u0027\u0027}\u003c/td\u003e\n            \u003ctd\u003e${row.batch || \u0027\u0027}\u003c/td\u003e\n            \u003ctd\u003e${row.quantity !\u003d\u003d undefined ? row.quantity : \u0027\u0027}\u003c/td\u003e\n            \u003ctd\u003e${row.pallet !\u003d\u003d undefined ? row.pallet : \u0027\u0027}\u003c/td\u003e\n        \u003c/tr\u003e\n    `).join(\u0027\u0027);\n\n    const formattedDate \u003d selectedDate;\n    const paddedSerialNumber \u003d String(serialNumber).padStart(3, \u00270\u0027);\n    const timeLabel \u003d currentRequestFormType \u003d\u003d\u003d \u0027stockIn\u0027 ? \u0027Delivery Time\u0027 : \u0027Collection Time\u0027;\n\n    const htmlContent \u003d `\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003ctitle\u003eSing Long ${currentRequestFormType \u003d\u003d\u003d \u0027stockIn\u0027 ? \u0027Stock In\u0027 : \u0027Stock Out\u0027} Request Form\u003c/title\u003e\n            \u003cstyle\u003e\n                @page { size: A4; margin: 0; }\n                body { \n                    font-family: Arial, sans-serif; \n                    font-size: 12pt; \n                    margin: 0; \n                    line-height: 1.3;\n                }\n                .content {\n                    margin: 30px;\n                }\n                table { \n                    border-collapse: collapse; \n                    width: 100%; \n                    margin-top: 20px; \n                    margin-bottom: 20px;\n                }\n                th, td { \n                    border: 1px solid black; \n                    padding: 8px; \n                    text-align: left; \n                    font-size: 12pt; \n                }\n                th { background-color: #f2f2f2; }\n                .header { margin-bottom: 20px; }\n                .header p { margin: 3px 0; }\n                .company-name-container {\n                    margin-top: 30px;\n                }\n                .company-name { \n                    font-weight: bold; \n                    text-decoration: underline; \n                    font-size: 16pt; \n                    margin-bottom: 5px;\n                }\n                .attn { \n                    font-weight: bold; \n                    text-decoration: underline; \n                    font-size: 14pt; \n                    margin-top: 15px;\n                    margin-bottom: 5px;\n                }\n                .date-container {\n                    margin: 40px 0;\n                }\n                .date { \n                    font-weight: bold; \n                    font-size: 14pt; \n                }\n                .bold { font-weight: bold; }\n                .right-align { \n                    text-align: right; \n                    margin-top: 10px;\n                }\n                .header-row { \n                    display: flex; \n                    justify-content: space-between; \n                    align-items: flex-start;\n                }\n                .header-left { flex: 1; }\n                .header-right { text-align: right; }\n                h2 { \n                    font-size: 14pt; \n                    margin-top: 20px;\n                    margin-bottom: 10px;\n                }\n                .footer { margin-top: 20px; }\n                .footer-row { \n                    display: flex; \n                    justify-content: space-between; \n                    margin-top: 40px;\n                }\n                .footer-item { \n                    flex: 1; \n                    text-align: left; \n                    margin-right: 30px;\n                }\n                .footer-line { \n                    border-top: 1px solid black; \n                    margin-top: 60px;\n                    width: 100%;\n                }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n            \u003cdiv class\u003d\"content\"\u003e\n                \u003cdiv class\u003d\"header\"\u003e\n                    \u003cdiv class\u003d\"header-row\"\u003e\n                        \u003cdiv class\u003d\"header-left\"\u003e\n                            \u003cdiv class\u003d\"company-name-container\"\u003e\n                                \u003cp class\u003d\"company-name\"\u003eLi Chuan Food Product Pte Ltd\u003c/p\u003e\n                                \u003cp\u003e40 Woodlands Terrace 738456\u003c/p\u003e\n                                \u003cp\u003eTel 65 6755 7688 Fax 65 6755 6698\u003c/p\u003e\n                            \u003c/div\u003e\n                        \u003c/div\u003e\n                        \u003cdiv class\u003d\"header-right\"\u003e\n                            \u003cp class\u003d\"bold\"\u003eS/N: SL 22/${paddedSerialNumber}\u003c/p\u003e\n                        \u003c/div\u003e\n                    \u003c/div\u003e\n                    \u003cdiv class\u003d\"date-container\"\u003e\n                        \u003cp class\u003d\"date\"\u003eDate: ${formattedDate}\u003c/p\u003e\n                    \u003c/div\u003e\n                    \u003cp class\u003d\"attn\"\u003eAttn: Sing Long Foodstuff \u0026 Trading Co.Pte Ltd\u003c/p\u003e\n                    \u003cp\u003e12 Woodlands Link Singapore 738740\u003c/p\u003e\n                    \u003cp\u003eTel 6284 5254 Fax 6289 7351\u003c/p\u003e\n                    \u003cp class\u003d\"right-align\"\u003e\u003cspan class\u003d\"bold\"\u003e${timeLabel}: ${collectionTime}\u003c/span\u003e\u003c/p\u003e\n                \u003c/div\u003e\n                \u003ch2\u003eSing Long ${currentRequestFormType \u003d\u003d\u003d \u0027stockIn\u0027 ? \u0027Stock In\u0027 : \u0027Stock Out\u0027} Request Form\u003c/h2\u003e\n                \u003ctable id\u003d\"dataTable\"\u003e\n                    \u003cthead\u003e\n                        \u003ctr\u003e\n                            \u003cth\u003eNo.\u003c/th\u003e\n                            \u003cth\u003eProduct Description\u003c/th\u003e\n                            \u003cth\u003ePacking\u003c/th\u003e\n                            \u003cth\u003eLot Number\u003c/th\u003e\n                            \u003cth\u003eBatch\u003c/th\u003e\n                            \u003cth\u003eQuantity\u003c/th\u003e\n                            \u003cth\u003ePallet\u003c/th\u003e\n                        \u003c/tr\u003e\n                    \u003c/thead\u003e\n                    \u003ctbody\u003e\n                        ${tableRows}\n                    \u003c/tbody\u003e\n                \u003c/table\u003e\n                \u003cdiv class\u003d\"footer\"\u003e\n                    \u003cp\u003eRegards,\u003c/p\u003e\n                    \u003cdiv class\u003d\"footer-row\"\u003e\n                        \u003cdiv class\u003d\"footer-item\"\u003e\n                            \u003cp\u003eIssue By:\u003c/p\u003e\n                            \u003cdiv class\u003d\"footer-line\"\u003e\u003c/div\u003e\n                        \u003c/div\u003e\n                        \u003cdiv class\u003d\"footer-item\"\u003e\n                            \u003cp\u003eCollected By:\u003c/p\u003e\n                            \u003cdiv class\u003d\"footer-line\"\u003e\u003c/div\u003e\n                        \u003c/div\u003e\n                        \u003cdiv class\u003d\"footer-item\"\u003e\n                            \u003cp\u003eVerified By:\u003c/p\u003e\n                            \u003cdiv class\u003d\"footer-line\"\u003e\u003c/div\u003e\n                        \u003c/div\u003e\n                    \u003c/div\u003e\n                \u003c/div\u003e\n            \u003c/div\u003e\n        \u003c/body\u003e\n        \u003c/html\u003e\n    `;\n    \n    printWindow.document.write(htmlContent);\n    printWindow.document.close();\n    printWindow.focus();\n    \n    printWindow.onload \u003d function() {\n        printWindow.print();\n        printWindow.close();\n    };\n\n    document.getElementById(\u0027loadingIndicator\u0027).style.display \u003d \u0027none\u0027;\n}\n// Function to handle errors\nfunction handleError(error) {\n    console.error(\u0027Error:\u0027, error);\n    document.getElementById(\u0027loadingIndicator\u0027).style.display \u003d \u0027none\u0027;\n    alert(\u0027An error occurred: \u0027 + error);\n}\n\n\n\n\u003c/script\u003e"},{"id":"00a010a2-794f-4313-88cf-72a970ca431f","name":"SLgs","type":"server_js","source":"function SLgetInventoryData() {\n  var ss \u003d SpreadsheetApp.openById(\u002717kO0MzE5mOMcQqdJgHenpSjY4Tll2KMpF8pSIdiXLUo\u0027);\n  var sheet \u003d ss.getSheetByName(\u0027Sing Long Summary\u0027);\n  var range \u003d sheet.getDataRange();\n  var data \u003d range.getValues();\n  var backgrounds \u003d range.getBackgrounds();\n  \n  console.log(\u0027Total rows in sheet: \u0027 + data.length);\n  \n  // Remove header row from data, but keep it in backgrounds\n  data.shift();\n  \n  var today \u003d new Date();\n  \n  // Function to parse date strings\n  function parseDate(dateString) {\n    if (dateString instanceof Date) {\n      return dateString;\n    }\n    var parts \u003d dateString.split(\u0027/\u0027);\n    if (parts.length \u003d\u003d\u003d 3) {\n      return new Date(parts[2], parts[1] - 1, parts[0]); // Year, Month (0-indexed), Day\n    }\n    return new Date(dateString); // Fallback to default parsing\n  }\n\n  // Format date as dd/MM/yyyy\n  function formatDate(date) {\n    return Utilities.formatDate(date, Session.getScriptTimeZone(), \u0027dd/MM/yyyy\u0027);\n  }\n\n  var formattedData \u003d data.map(function(row, rowIndex) {\n    // Handle Date Stored (row[5])\n    var storedDate \u003d parseDate(row[5]);\n    if (isNaN(storedDate.getTime())) {\n      storedDate \u003d new Date(); // Use current date if parsing fails\n    }\n    var storedDateFormatted \u003d formatDate(storedDate);\n    \n    // Calculate Pallet Due Date\n    var dueDate \u003d new Date(storedDate.getTime());\n    \n    // First, add 29 days\n    dueDate.setDate(dueDate.getDate() + 29);\n    \n    // If still not more than today, keep adding 30 days until it is\n    while (dueDate \u003c\u003d today) {\n      dueDate.setDate(dueDate.getDate() + 30);\n    }\n    \n    var dueDateFormatted \u003d formatDate(dueDate);\n    \n    var row3Value \u003d row[3] instanceof Date ? formatDate(row[3]) : row[3].toString();\n    \n    // Calculate Days Left and format as \"X Days\"\n    var daysLeft \u003d Math.ceil((dueDate - today) / (1000 * 60 * 60 * 24));\n    var daysLeftFormatted \u003d daysLeft + \" Days\";\n    \n    var formattedRow \u003d [\n      row[0],  // Item Code\n      row[1],  // Product Description\n      row[2].toString(),  // Packing (as text)\n      row3Value,  // Date if it\u0027s a date, otherwise string\n      row[4],  // Lot No\n      storedDateFormatted,  // Date Stored\n      row[6],  // Container No\n      dueDateFormatted,  // Pallet Due Date (calculated)\n      daysLeftFormatted,  // Days Left until Pallet Due Date (e.g., \"7 Days\")\n      row[8],  // Quantity\n      row[9]   // Pallets\n    ];\n\n    // Add color information, offsetting the rowIndex by 1 to account for the header\n    var colors \u003d backgrounds[rowIndex + 1].slice(0, 10);  // Take the first 10 columns\n    \n    // Add an extra column for the \u0027Days Left\u0027 and adjust quantity and pallets\n    colors.splice(8, 0, \u0027#ffffff\u0027);  // Insert white color for \u0027Days Left\u0027 column\n    colors.push(colors[9]);  // Duplicate the color for quantity\n    colors.push(colors[10]);  // Duplicate the color for pallets\n\n    console.log(\u0027Row \u0027 + (rowIndex + 2) + \u0027 colors: \u0027 + JSON.stringify(colors));\n\n    return {\n      data: formattedRow,\n      colors: colors\n    };\n  });\n  \n  console.log(\u0027Total rows processed: \u0027 + formattedData.length);\n  console.log(\u0027Sample data: \u0027 + JSON.stringify(formattedData[0]));\n  \n  return formattedData;\n}\nfunction SLupdateCellColor(itemCode, lotNumber, cellIndex, color) {\n  var ss \u003d SpreadsheetApp.openById(\u002717kO0MzE5mOMcQqdJgHenpSjY4Tll2KMpF8pSIdiXLUo\u0027);\n  var sheet \u003d ss.getSheetByName(\u0027Sing Long Summary\u0027);\n  var data \u003d sheet.getDataRange().getValues();\n  \n  for (var i \u003d 1; i \u003c data.length; i++) {\n    if (data[i][0] \u003d\u003d\u003d itemCode \u0026\u0026 data[i][4] \u003d\u003d\u003d lotNumber) {\n      // Adjust cellIndex only for quantity and pallet columns\n      var adjustedCellIndex \u003d cellIndex;\n      if (cellIndex \u003d\u003d\u003d 9 || cellIndex \u003d\u003d\u003d 10) {\n        adjustedCellIndex \u003d cellIndex - 1;\n      }\n      \n      var cell \u003d sheet.getRange(i + 1, adjustedCellIndex + 1);\n      if (color \u003d\u003d\u003d \u0027yellow\u0027) {\n        cell.setBackground(\u0027#FFFF00\u0027);\n      } else {\n        cell.setBackground(null);\n      }\n      break;\n    }\n  }\n}\n\n\n//Transcation Report\n// Global spreadsheet ID\n\nfunction SLgetTransactionDetails(itemCode, lotNumber) {\n  var spreadsheetId \u003d \u002717kO0MzE5mOMcQqdJgHenpSjY4Tll2KMpF8pSIdiXLUo\u0027;\n  var ss \u003d SpreadsheetApp.openById(spreadsheetId);\n  \n  var stockInSheet \u003d ss.getSheetByName(\u0027Stock In\u0027);\n  var drawOutSheet \u003d ss.getSheetByName(\u0027Stock Out\u0027);\n  \n  var stockInData \u003d getTransactionData(stockInSheet, itemCode, lotNumber, \u0027Stock In\u0027);\n  var drawOutData \u003d getTransactionData(drawOutSheet, itemCode, lotNumber, \u0027Stock Out\u0027);\n  \n  var combinedData \u003d stockInData.concat(drawOutData).sort(function(a, b) {\n    return new Date(a.date) - new Date(b.date);\n  });\n\n  Logger.log(\u0027Combined Data: \u0027 + JSON.stringify(combinedData));\n  \n  return combinedData;\n}\n\nfunction getTransactionData(sheet, itemCode, lotNumber, type) {\n  var data \u003d sheet.getDataRange().getValues();\n  var headers \u003d data.shift();\n  \n  // Assuming Item Code is in column B (index 1) and Lot Number is in column F (index 5)\n  var itemCodeIndex \u003d 1;\n  var lotNumberIndex \u003d 5;\n  var dateIndex \u003d 0; // Assuming Date is in column A (index 0)\n  var quantityIndex \u003d 8; // Assuming Quantity is in column I (index 8)\n  var palletIndex \u003d 9; // Assuming Pallet is in column J (index 9)\n  \n  var filteredData \u003d data.filter(function(row) {\n    return row[itemCodeIndex] \u003d\u003d\u003d itemCode \u0026\u0026 row[lotNumberIndex] \u003d\u003d\u003d lotNumber;\n  });\n  \n  Logger.log(type + \u0027 Filtered Data: \u0027 + JSON.stringify(filteredData));\n  \n  return filteredData.map(function(row) {\n    return {\n      date: Utilities.formatDate(new Date(row[dateIndex]), Session.getScriptTimeZone(), \u0027dd/MM/yyyy\u0027),\n      type: type,\n      quantity: row[quantityIndex],\n      pallet: row[palletIndex]\n    };\n  });\n}\n\nfunction saveDrawOutData(data) {\n  var spreadsheetId \u003d \u002717kO0MzE5mOMcQqdJgHenpSjY4Tll2KMpF8pSIdiXLUo\u0027;\n  var ss \u003d SpreadsheetApp.openById(spreadsheetId);\n  \n  // Select the \"Stock Out\" sheet\n  var stockOutSheet \u003d ss.getSheetByName(\u0027Stock Out\u0027);\n  \n  // Format the date as DD/MM/YYYY\n  var dateParts \u003d data.date.split(\u0027-\u0027);\n  var formattedDate \u003d dateParts[2] + \u0027/\u0027 + dateParts[1] + \u0027/\u0027 + dateParts[0];\n  \n  // Prepare the row to be added\n  var newRow \u003d [\n    formattedDate,  // Date in DD/MM/YYYY format\n    data.itemCode,\n    data.productDescription,\n    data.packing,\n    data.expiryBatch,\n    data.lotNo,\n    data.dateStored,\n    data.containerNo,\n    data.quantity,\n    data.pallet\n  ];\n  \n  // Append the new row to the \"Stock Out\" sheet\n  stockOutSheet.appendRow(newRow);\n  \n  // Update the \"Sing Long Summary\" sheet\n  var summarySheet \u003d ss.getSheetByName(\u0027Sing Long Summary\u0027);\n  var summaryData \u003d summarySheet.getDataRange().getValues();\n  \n  Logger.log(\"Number of rows in summary sheet: \" + summaryData.length);\n  \n  var updated \u003d false;\n  for (var i \u003d 1; i \u003c summaryData.length; i++) {  // Start from 1 to skip header\n    Logger.log(\"Checking row \" + (i+1) + \": \" + JSON.stringify(summaryData[i]));\n    \n    if (summaryData[i][0] \u003d\u003d data.itemCode \u0026\u0026 summaryData[i][4] \u003d\u003d data.lotNo) {\n      // Update quantity and pallets\n      var newQuantity \u003d summaryData[i][8] - Number(data.quantity);\n      var newPallets \u003d summaryData[i][9] - Number(data.pallet);\n      summarySheet.getRange(i+1, 9).setValue(newQuantity);\n      summarySheet.getRange(i+1, 10).setValue(newPallets);\n      Logger.log(\"Updated row \" + (i+1) + \": New quantity \u003d \" + newQuantity + \", New pallets \u003d \" + newPallets);\n      updated \u003d true;\n      break;\n    }\n  }\n  \n  if (!updated) {\n    Logger.log(\"No matching row found for itemCode: \" + data.itemCode + \", lotNo: \" + data.lotNo);\n  }\n  \n  // Return the updated inventory data\n  return SLgetInventoryData();\n}\n\nfunction formatDateForComparison(dateString) {\n  if (dateString instanceof Date) {\n    return Utilities.formatDate(dateString, Session.getScriptTimeZone(), \"dd/MM/yyyy\");\n  }\n  \n  // Check if the date is in ISO format (e.g., \"2024-09-02T16:00:00.000Z\")\n  if (dateString.includes(\u0027T\u0027)) {\n    var date \u003d new Date(dateString);\n    return Utilities.formatDate(date, Session.getScriptTimeZone(), \"dd/MM/yyyy\");\n  }\n  \n  // If it\u0027s already in dd/MM/yyyy format, return as is\n  if (dateString.match(/^\\d{1,2}\\/\\d{1,2}\\/\\d{4}$/)) {\n    return dateString;\n  }\n  \n  // If it\u0027s in the format \"4/8/23  22/11/23\", take the second date\n  if (dateString.includes(\u0027  \u0027)) {\n    return dateString.split(\u0027  \u0027)[1];\n  }\n  \n  // If none of the above, return the original string\n  return dateString;\n}\n\n\n//End Month Report\nfunction getMonthEndReport(sheetName) {\n  var ss \u003d SpreadsheetApp.openById(\u002717kO0MzE5mOMcQqdJgHenpSjY4Tll2KMpF8pSIdiXLUo\u0027);\n  var sheet \u003d ss.getSheetByName(sheetName);\n  \n  if (!sheet) {\n    return [[\u0027No data available for the selected month and year.\u0027]];\n  }\n  \n  var data \u003d sheet.getDataRange().getValues();\n  \n  // Remove the header row if it exists\n  if (data.length \u003e 0 \u0026\u0026 data[0][0] \u003d\u003d\u003d \u0027Item Code\u0027) {\n    data.shift();\n  }\n  \n  // Convert Java Date objects to DD/MM/YYYY strings\n  data \u003d data.map(function(row) {\n    return row.map(function(cell, index) {\n      if (cell instanceof Date) {\n        return Utilities.formatDate(cell, Session.getScriptTimeZone(), \"dd/MM/yyyy\");\n      }\n      return cell;\n    });\n  });\n  \n  return data;\n}\n//Transcation Report\n// Global spreadsheet ID\nfunction generateTransactionReport(month, year) {\n  var SPREADSHEET_ID \u003d \u002717kO0MzE5mOMcQqdJgHenpSjY4Tll2KMpF8pSIdiXLUo\u0027;\n  \n  console.log(\u0027Starting generateTransactionReport for month: \u0027 + month + \u0027, year: \u0027 + year);\n  \n  try {\n    var ss \u003d SpreadsheetApp.openById(SPREADSHEET_ID);\n    console.log(\u0027Successfully opened spreadsheet\u0027);\n    \n    // Log all sheet names\n    var allSheets \u003d ss.getSheets();\n    console.log(\"All sheet names:\");\n    allSheets.forEach(function(sheet) {\n      console.log(\"\u0027\" + sheet.getName() + \"\u0027\");\n    });\n  } catch (e) {\n    console.error(\u0027Error opening spreadsheet: \u0027 + e.message);\n    return;\n  }\n  \n  // Calculate the previous month for opening stock\n  var openingStockDate \u003d new Date(year, month - 1, 0);\n  var openingStockMonth \u003d openingStockDate.getMonth() + 1;\n  var openingStockYear \u003d openingStockDate.getFullYear();\n  \n  console.log(\"Input month: \" + month + \", Input year: \" + year);\n  console.log(\"Calculated openingStockMonth: \" + openingStockMonth);\n  console.log(\"Calculated openingStockYear: \" + openingStockYear);\n  \n  // Construct the sheet name for opening stock (previous month)\n  var openingStockSheetName \u003d getMonthAbbreviation(openingStockMonth) + \" \" + openingStockYear;\n  console.log(\u0027Looking for opening stock sheet: \"\u0027 + openingStockSheetName + \u0027\"\u0027);\n  \n  var openingStockSheet \u003d ss.getSheetByName(openingStockSheetName);\n  \n  // Try direct access\n  var directSheet \u003d ss.getSheetByName(\"Jun 2024\");\n  console.log(\"Direct sheet access result: \" + (directSheet ? \"Found\" : \"Not Found\"));\n  \n  if (!openingStockSheet) {\n    console.error(\u0027Opening stock sheet not found: \u0027 + openingStockSheetName);\n    throw new Error(\"Opening stock sheet not found for \" + openingStockSheetName);\n  }\n  \n  console.log(\u0027Successfully found opening stock sheet\u0027);\n  \n  var stockOutSheet \u003d ss.getSheetByName(\"Stock Out\");\n  var stockInSheet \u003d ss.getSheetByName(\"Stock In\");\n  \n  if (!stockOutSheet || !stockInSheet) {\n    console.error(\u0027Stock Out or Stock In sheet not found\u0027);\n    throw new Error(\"Stock Out or Stock In sheet not found\");\n  }\n  \n  console.log(\u0027Successfully found Stock Out and Stock In sheets\u0027);\n  \n  // Calculate the start and end dates for transactions\n  var transactionStartDate \u003d new Date(year, month - 1, 1);\n  var transactionEndDate \u003d new Date(year, month, 0);\n  console.log(\u0027Transaction date range: \u0027 + transactionStartDate + \u0027 to \u0027 + transactionEndDate);\n  \n  // Process opening stock sheet\n  var openingStockData \u003d openingStockSheet.getDataRange().getValues();\n  console.log(\u0027Retrieved opening stock data. Rows: \u0027 + openingStockData.length);\n  \n  var openingStock \u003d {};\n  var allItems \u003d {};\n  \n  for (var i \u003d 1; i \u003c openingStockData.length; i++) {\n    var key \u003d openingStockData[i][1] + \"|\" + openingStockData[i][4]; // Product Description + Lot Number\n    var quantity \u003d openingStockData[i][8];\n    var pallets \u003d openingStockData[i][9];\n    openingStock[key] \u003d formatQuantity(quantity, pallets);\n    allItems[key] \u003d {productDesc: openingStockData[i][1], lotNumber: openingStockData[i][4]};\n  }\n  \n  console.log(\u0027Processed opening stock data. Items: \u0027 + Object.keys(openingStock).length);\n  \n  // Process Stock Out and Stock In sheets\n  var stockOutData \u003d stockOutSheet.getDataRange().getValues();\n  var stockInData \u003d stockInSheet.getDataRange().getValues();\n  console.log(\u0027Retrieved Stock Out data. Rows: \u0027 + stockOutData.length);\n  console.log(\u0027Retrieved Stock In data. Rows: \u0027 + stockInData.length);\n  \n  var transactions \u003d {};\n  \n  function processSheet(data, isStockIn) {\n    for (var i \u003d 1; i \u003c data.length; i++) {\n      var date \u003d new Date(data[i][0]);\n      \n      // Only process transactions within the selected month\n      if (date \u003e\u003d transactionStartDate \u0026\u0026 date \u003c\u003d transactionEndDate) {\n        var key \u003d data[i][2] + \"|\" + data[i][5]; // Product Description + Lot Number\n        var quantity \u003d data[i][8];\n        var pallets \u003d data[i][9];\n        \n        if (!transactions[key]) {\n          transactions[key] \u003d [];\n        }\n        \n        transactions[key].push({\n          date: date,\n          stockIn: isStockIn ? formatQuantity(quantity, pallets) : \"\",\n          stockOut: !isStockIn ? formatQuantity(quantity, pallets) : \"\"\n        });\n        \n        if (!allItems[key]) {\n          allItems[key] \u003d {productDesc: data[i][2], lotNumber: data[i][5]};\n        }\n      }\n    }\n  }\n  \n  processSheet(stockOutData, false);\n  processSheet(stockInData, true);\n  \n  console.log(\u0027Processed Stock Out and Stock In data. Transaction keys: \u0027 + Object.keys(transactions).length);\n  \n  // Generate Transaction report data\n  var transactionData \u003d [];\n  \n  for (var key in allItems) {\n    var productDesc \u003d allItems[key].productDesc;\n    var lotNumber \u003d allItems[key].lotNumber;\n    var balance \u003d openingStock[key] || \"New Stock\";\n    \n    // Add opening stock row\n    transactionData.push([\n      productDesc,\n      lotNumber,\n      formatDate(transactionStartDate), // First day of the selected month\n      balance,\n      \"\",\n      \"\",\n      balance\n    ]);\n    \n    if (transactions[key]) {\n      // Sort transactions by date\n      transactions[key].sort((a, b) \u003d\u003e a.date - b.date);\n      \n      // Add transaction rows\n      for (var transaction of transactions[key]) {\n        if (transaction.stockIn) {\n          balance \u003d addQuantities(balance, transaction.stockIn);\n        }\n        if (transaction.stockOut) {\n          balance \u003d subtractQuantities(balance, transaction.stockOut);\n        }\n        \n        transactionData.push([\n          \"\",  // Product Description (blank after first row)\n          \"\",  // Lot Number (blank after first row)\n          formatDate(transaction.date),\n          \"\",\n          transaction.stockIn,\n          transaction.stockOut,\n          balance\n        ]);\n      }\n    }\n    \n    // Add an empty row between different items\n    transactionData.push([\"\", \"\", \"\", \"\", \"\", \"\", \"\"]);\n  }\n  \n  console.log(\u0027Generated transaction report. Rows: \u0027 + transactionData.length);\n  return transactionData;\n}\nfunction addQuantities(q1, q2) {\n  if (q1 \u003d\u003d\u003d \"New Stock\") q1 \u003d \"0 Ctns 0 Pallets\";\n  if (q2 \u003d\u003d\u003d \"New Stock\") q2 \u003d \"0 Ctns 0 Pallets\";\n  \n  var [qty1, , pallets1] \u003d q1.split(\" \");\n  var [qty2, , pallets2] \u003d q2.split(\" \");\n  var newQty \u003d (parseInt(qty1) || 0) + (parseInt(qty2) || 0);\n  var newPallets \u003d (parseInt(pallets1) || 0) + (parseInt(pallets2) || 0);\n  return formatQuantity(newQty, newPallets);\n}\n\nfunction subtractQuantities(q1, q2) {\n  if (q1 \u003d\u003d\u003d \"New Stock\") q1 \u003d \"0 Ctns 0 Pallets\";\n  if (q2 \u003d\u003d\u003d \"New Stock\") q2 \u003d \"0 Ctns 0 Pallets\";\n  \n  var [qty1, , pallets1] \u003d q1.split(\" \");\n  var [qty2, , pallets2] \u003d q2.split(\" \");\n  var newQty \u003d (parseInt(qty1) || 0) - (parseInt(qty2) || 0);\n  var newPallets \u003d (parseInt(pallets1) || 0) - (parseInt(pallets2) || 0);\n  return formatQuantity(newQty, newPallets);\n}\n\nfunction formatQuantity(qty, pallets) {\n  qty \u003d isNaN(qty) ? 0 : parseInt(qty);\n  pallets \u003d isNaN(pallets) ? 0 : parseInt(pallets);\n  \n  if (qty \u003d\u003d\u003d 0 \u0026\u0026 pallets \u003d\u003d\u003d 0) {\n    return \"Clear\";\n  }\n  \n  var qtyStr \u003d qty + \" Ctns\";\n  var palletStr \u003d pallets + \" \" + (pallets \u003d\u003d\u003d 1 ? \"Pallet\" : \"Pallets\");\n  \n  return qtyStr + \" \" + palletStr;\n}\n\nfunction formatDate(date) {\n  var day \u003d date.getDate().toString().padStart(2, \u00270\u0027);\n  var month \u003d (date.getMonth() + 1).toString().padStart(2, \u00270\u0027);\n  var year \u003d date.getFullYear();\n  return day + \"/\" + month + \"/\" + year;\n}\n\nfunction getMonthAbbreviation(monthNumber) {\n  var monthAbbreviations \u003d [\n    \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\n    \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"\n  ];\n  return monthAbbreviations[parseInt(monthNumber) - 1];\n}\n\n// This function can be called from the client-side to generate the report\nfunction generateReport(month, year) {\n  try {\n    var data \u003d generateTransactionReport(parseInt(month), parseInt(year));\n    return JSON.stringify(data);\n  } catch (error) {\n    return JSON.stringify({error: error.message});\n  }\n}\n\n\n//Store In\n\nfunction getLotNumberHint() {\n    const ss \u003d SpreadsheetApp.openById(\u002717kO0MzE5mOMcQqdJgHenpSjY4Tll2KMpF8pSIdiXLUo\u0027);\n    const sheet \u003d ss.getSheetByName(\u0027Sing Long Summary\u0027);\n    const lastRow \u003d sheet.getLastRow();\n    return sheet.getRange(`E${lastRow}`).getValue();\n}\n\nfunction getPickItemOptions() {\n  const ss \u003d SpreadsheetApp.openById(\u00271HkPIjBIwxylJlMp1LfGDVw597EjIQ1SgknZ-ymyk57Y\u0027);\n  const sheet \u003d ss.getSheetByName(\u0027Surimi List\u0027);\n  const range \u003d sheet.getRange(\u0027B2:B\u0027 + sheet.getLastRow());\n  const values \u003d range.getValues();\n  return values.flat().filter(String);\n}\n\nfunction getItemDetails(selectedItem) {\n  const ss \u003d SpreadsheetApp.openById(\u00271HkPIjBIwxylJlMp1LfGDVw597EjIQ1SgknZ-ymyk57Y\u0027);\n  const sheet \u003d ss.getSheetByName(\u0027Surimi List\u0027);\n  const data \u003d sheet.getDataRange().getValues();\n  \n  for (let i \u003d 1; i \u003c data.length; i++) {\n    if (data[i][1] \u003d\u003d\u003d selectedItem) {\n      return {\n        itemCode: data[i][0],\n        productDescription: data[i][1],\n        packingSize: data[i][2]\n      };\n    }\n  }\n  \n  return null;\n}\n\nfunction saveStoreInData(storeInData) {\n  try {\n    const ss \u003d SpreadsheetApp.openById(\u002717kO0MzE5mOMcQqdJgHenpSjY4Tll2KMpF8pSIdiXLUo\u0027);\n    const stockInSheet \u003d ss.getSheetByName(\u0027Stock In\u0027);\n    const summarySheet \u003d ss.getSheetByName(\u0027Sing Long Summary\u0027);\n    \n    // Format the store in date as DD/MM/YYYY\n    const storeInDate \u003d new Date(storeInData.storeInDate);\n    const formattedStoreInDate \u003d Utilities.formatDate(storeInDate, Session.getScriptTimeZone(), \"dd/MM/yyyy\");\n    \n    // Format the stored date as DD/MM/YYYY\n    const storedDate \u003d new Date(storeInData.dateStored);\n    const formattedStoredDate \u003d Utilities.formatDate(storedDate, Session.getScriptTimeZone(), \"dd/MM/yyyy\");\n    \n    // Save to Stock In sheet\n    stockInSheet.appendRow([\n      formattedStoreInDate, // Use the formatted store in date\n      storeInData.itemCode,\n      storeInData.productDescription,\n      storeInData.packingSize,\n      storeInData.expiryBatch,\n      storeInData.lotNumber,\n      formattedStoredDate,\n      storeInData.container,\n      storeInData.quantity,\n      storeInData.pallet\n    ]);\n    \n    // Update storeInData with formatted dates before passing to updateSingLongSummary\n    storeInData.storeInDate \u003d formattedStoreInDate;\n    storeInData.dateStored \u003d formattedStoredDate;\n    \n    // Update or append to Sing Long Summary sheet\n    updateSingLongSummary(summarySheet, storeInData);\n    \n    return { success: true };\n  } catch (error) {\n    return { success: false, error: error.toString() };\n  }\n}\nfunction updateSingLongSummary(sheet, data) {\n  const values \u003d sheet.getDataRange().getValues();\n  let rowIndex \u003d -1;\n  \n  // Check if the item already exists\n  for (let i \u003d 1; i \u003c values.length; i++) {\n    if (values[i][0] \u003d\u003d\u003d data.itemCode \u0026\u0026 \n        values[i][3] \u003d\u003d\u003d data.expiryBatch \u0026\u0026 \n        values[i][4] \u003d\u003d\u003d data.lotNumber) {\n      rowIndex \u003d i + 1;\n      break;\n    }\n  }\n  \n  if (rowIndex \u003d\u003d\u003d -1) {\n    // Item doesn\u0027t exist, append new row\n    sheet.appendRow([\n      data.itemCode,\n      data.productDescription,\n      data.packingSize,\n      data.expiryBatch,\n      data.lotNumber,\n      data.dateStored,\n      data.container,\n      \u0027\u0027, // Pallet Due Date left blank\n      data.quantity,\n      data.pallet\n    ]);\n  } else {\n    // Item exists, update quantity and pallet\n    const currentQuantity \u003d sheet.getRange(rowIndex, 9).getValue();\n    const currentPallet \u003d sheet.getRange(rowIndex, 10).getValue();\n    sheet.getRange(rowIndex, 9).setValue(currentQuantity + Number(data.quantity));\n    sheet.getRange(rowIndex, 10).setValue(currentPallet + Number(data.pallet));\n  }\n}\n\nfunction getStockInData() {\n  try {\n    var spreadsheet \u003d SpreadsheetApp.openById(\u002717kO0MzE5mOMcQqdJgHenpSjY4Tll2KMpF8pSIdiXLUo\u0027);\n    var sheet \u003d spreadsheet.getSheetByName(\u0027Stock In\u0027);\n    if (!sheet) {\n      return JSON.stringify([]);\n    }\n    \n    var range \u003d sheet.getDataRange();\n    var data \u003d range.getValues();\n    \n    var formattedData \u003d data.map(function(row, index) {\n      if (index \u003d\u003d\u003d 0) return row; // Skip header row\n      return row.map(function(cell, cellIndex) {\n        if (cell instanceof Date) {\n          return Utilities.formatDate(cell, Session.getScriptTimeZone(), \"yyyy-MM-dd\");\n        }\n        return cell;\n      });\n    });\n    \n    return JSON.stringify(formattedData);\n  } catch (error) {\n    return JSON.stringify([]);\n  }\n}\n\nfunction updateExpiryDateBatchNumber(date, itemCode, lotNumber, dateStored, container, newValue) {\n  try {\n    var spreadsheet \u003d SpreadsheetApp.openById(\u002717kO0MzE5mOMcQqdJgHenpSjY4Tll2KMpF8pSIdiXLUo\u0027);\n    var stockInSheet \u003d spreadsheet.getSheetByName(\u0027Stock In\u0027);\n    var summarySheet \u003d spreadsheet.getSheetByName(\u0027Sing Long Summary\u0027);\n    \n    if (!stockInSheet || !summarySheet) {\n      return { success: false, error: \u0027One or both sheets not found\u0027 };\n    }\n\n    // Update Stock In sheet\n    var stockInData \u003d stockInSheet.getDataRange().getValues();\n    var stockInRowIndex \u003d findExactMatchingRow(stockInData, date, itemCode, lotNumber, dateStored, container);\n\n    if (stockInRowIndex \u003d\u003d\u003d -1) {\n      return { success: false, error: \u0027Row not found in Stock In sheet\u0027 };\n    }\n\n    stockInSheet.getRange(stockInRowIndex, 5).setValue(newValue);\n\n    // Update Sing Long Summary sheet\n    var summaryData \u003d summarySheet.getDataRange().getValues();\n    var summaryRowIndex \u003d findBestMatchingRow(summaryData, itemCode, lotNumber);\n\n    if (summaryRowIndex \u003d\u003d\u003d -1) {\n      return { success: false, error: \u0027Row not found in Sing Long Summary sheet\u0027 };\n    }\n\n    summarySheet.getRange(summaryRowIndex, 4).setValue(newValue);\n    \n    return { success: true };\n  } catch (error) {\n    console.error(\u0027Error updating cells:\u0027, error);\n    return { success: false, error: error.toString() };\n  }\n}\n\nfunction findExactMatchingRow(data, date, itemCode, lotNumber, dateStored, container) {\n  for (var i \u003d 1; i \u003c data.length; i++) {\n    if (formatDateForComparison(data[i][0]) \u003d\u003d\u003d formatDateForComparison(date) \u0026\u0026\n        data[i][1] \u003d\u003d\u003d itemCode \u0026\u0026\n        data[i][5] \u003d\u003d\u003d lotNumber \u0026\u0026\n        formatDateForComparison(data[i][6]) \u003d\u003d\u003d formatDateForComparison(dateStored) \u0026\u0026\n        data[i][7] \u003d\u003d\u003d container) {\n      return i + 1; // +1 because sheet rows are 1-indexed\n    }\n  }\n  return -1; // Row not found\n}\n\nfunction findBestMatchingRow(data, itemCode, lotNumber) {\n  var matchingRows \u003d [];\n  for (var i \u003d 1; i \u003c data.length; i++) {\n    if (data[i][0] \u003d\u003d\u003d itemCode \u0026\u0026 data[i][4] \u003d\u003d\u003d lotNumber) {\n      matchingRows.push(i + 1); // +1 because sheet rows are 1-indexed\n    }\n  }\n  \n  if (matchingRows.length \u003d\u003d\u003d 0) {\n    return -1; // No matching row found\n  }\n  \n  // Return the last (most recent) matching row\n  return matchingRows[matchingRows.length - 1];\n}\n\nfunction formatDateForComparison(dateString) {\n  var date \u003d new Date(dateString);\n  var year \u003d date.getFullYear();\n  var month \u003d (date.getMonth() + 1).toString().padStart(2, \u00270\u0027);\n  var day \u003d date.getDate().toString().padStart(2, \u00270\u0027);\n  return `${year}-${month}-${day}`;\n}\n\nfunction formatDateForComparison(dateString) {\n  var date \u003d new Date(dateString);\n  var year \u003d date.getFullYear();\n  var month \u003d (date.getMonth() + 1).toString().padStart(2, \u00270\u0027);\n  var day \u003d date.getDate().toString().padStart(2, \u00270\u0027);\n  return `${year}-${month}-${day}`;\n}\n//Request Form\n// Function to get the next serial number\nfunction getNextSerialNumber() {\n  const ss \u003d SpreadsheetApp.openById(\u002717kO0MzE5mOMcQqdJgHenpSjY4Tll2KMpF8pSIdiXLUo\u0027);\n  const configSheet \u003d ss.getSheetByName(\u0027Config\u0027);\n  \n  if (!configSheet) {\n    throw new Error(\"Config sheet not found. Please create a sheet named \u0027Config\u0027.\");\n  }\n\n  let serialNumber \u003d configSheet.getRange(\u0027A1\u0027).getValue();\n  \n  if (!serialNumber) {\n    serialNumber \u003d 1;\n  } else {\n    serialNumber \u003d parseInt(serialNumber) + 1;\n  }\n  \n  configSheet.getRange(\u0027A1\u0027).setValue(serialNumber);\n  \n  return serialNumber;\n}\n\n// Function to get available dates for the request form\nfunction getRequestFormDates(type) {\n  const ss \u003d SpreadsheetApp.openById(\u002717kO0MzE5mOMcQqdJgHenpSjY4Tll2KMpF8pSIdiXLUo\u0027);\n  const sheet \u003d ss.getSheetByName(type \u003d\u003d\u003d \u0027stockIn\u0027 ? \u0027Stock In\u0027 : \u0027Stock Out\u0027);\n  const data \u003d sheet.getRange(\u0027A2:A\u0027).getValues();\n  \n  // Get unique dates and ensure they\u0027re in DD/MM/YYYY format\n  const uniqueDates \u003d [...new Set(data.map(row \u003d\u003e {\n    if (row[0] instanceof Date) {\n      return Utilities.formatDate(row[0], Session.getScriptTimeZone(), \u0027dd/MM/yyyy\u0027);\n    }\n    return row[0]; // If it\u0027s already a string, assume it\u0027s in the correct format\n  }).filter(date \u003d\u003e date !\u003d\u003d \u0027\u0027))];\n  \n  // Sort dates in descending order (most recent first)\n  uniqueDates.sort((a, b) \u003d\u003e {\n    const [dayA, monthA, yearA] \u003d a.split(\u0027/\u0027).map(Number);\n    const [dayB, monthB, yearB] \u003d b.split(\u0027/\u0027).map(Number);\n    return new Date(yearB, monthB - 1, dayB) - new Date(yearA, monthA - 1, dayA);\n  });\n  \n  return uniqueDates;\n}\n\nfunction getRequestFormData(type, selectedDate) {\n  const ss \u003d SpreadsheetApp.openById(\u002717kO0MzE5mOMcQqdJgHenpSjY4Tll2KMpF8pSIdiXLUo\u0027);\n  const sheet \u003d ss.getSheetByName(type \u003d\u003d\u003d \u0027stockIn\u0027 ? \u0027Stock In\u0027 : \u0027Stock Out\u0027);\n  const data \u003d sheet.getDataRange().getValues();\n  \n  const formattedData \u003d data.slice(1) // Skip header row\n    .filter(row \u003d\u003e {\n      const rowDate \u003d row[0] instanceof Date ? \n        Utilities.formatDate(row[0], Session.getScriptTimeZone(), \u0027dd/MM/yyyy\u0027) : row[0];\n      return rowDate \u003d\u003d\u003d selectedDate;\n    })\n    .map(row \u003d\u003e ({\n      productDescription: row[2],\n      packing: row[3],\n      lotNumber: row[5],\n      quantity: row[8],\n      pallet: row[9],\n      batch: row[4] instanceof Date ? \n        Utilities.formatDate(row[4], Session.getScriptTimeZone(), \u0027dd/MM/yyyy\u0027) : row[4]\n    }));\n  \n  const serialNumber \u003d getNextSerialNumber();\n  \n  return {\n    formData: formattedData,\n    serialNumber: serialNumber\n  };\n}\n\n\n\n//pallet Due Date\nfunction calculatePalletCharges(selectedMonth, selectedYear) {\n  try {\n    // Log the received month and year\n    console.log(\u0027Received selectedMonth:\u0027, selectedMonth);\n    console.log(\u0027Received selectedYear:\u0027, selectedYear);\n\n    var spreadsheetId \u003d \u002717kO0MzE5mOMcQqdJgHenpSjY4Tll2KMpF8pSIdiXLUo\u0027;\n    var ss \u003d SpreadsheetApp.openById(spreadsheetId);\n    \n    var stockOutSheet \u003d ss.getSheetByName(\u0027Stock Out\u0027);\n    var storeInSheet \u003d ss.getSheetByName(\u0027Stock In\u0027);\n    \n    // Convert selectedMonth and selectedYear to numbers and validate\n    selectedMonth \u003d parseInt(selectedMonth);\n    selectedYear \u003d parseInt(selectedYear);\n    \n    // Log the parsed month and year\n    console.log(\u0027Parsed selectedMonth:\u0027, selectedMonth);\n    console.log(\u0027Parsed selectedYear:\u0027, selectedYear);\n\n    if (isNaN(selectedMonth) || selectedMonth \u003c 1 || selectedMonth \u003e 12 || \n        isNaN(selectedYear) || selectedYear \u003c 2000 || selectedYear \u003e 2100) {\n      throw new Error(\u0027Invalid month or year selected\u0027);\n    }\n    \n    // Calculate previous month and year\n    var previousMonth \u003d selectedMonth - 1;\n    var previousYear \u003d selectedYear;\n    if (previousMonth \u003d\u003d\u003d 0) {\n      previousMonth \u003d 12;\n      previousYear--;\n    }\n    \n    // Log the calculated previous month and year\n    console.log(\u0027Calculated previousMonth:\u0027, previousMonth);\n    console.log(\u0027Calculated previousYear:\u0027, previousYear);\n\n    // Get the name of the previous month sheet\n    var previousMonthName \u003d getMonthName(previousMonth) + \u0027 \u0027 + previousYear;\n    console.log(\u0027Previous month sheet name:\u0027, previousMonthName);\n\n    var previousMonthSheet \u003d ss.getSheetByName(previousMonthName);\n    \n    if (!previousMonthSheet) {\n      throw new Error(\u0027Previous month sheet not found: \u0027 + previousMonthName);\n    }\n    \n    var stockOutData \u003d stockOutSheet.getRange(\u0027A2:J\u0027 + stockOutSheet.getLastRow()).getValues();\n    var previousMonthData \u003d previousMonthSheet.getRange(\u0027A2:J\u0027 + previousMonthSheet.getLastRow()).getValues();\n    var storeInData \u003d storeInSheet.getRange(\u0027A2:J\u0027 + storeInSheet.getLastRow()).getValues();\n    \n    var pallets \u003d {};\n    var storeInPallets \u003d {};\n    var startOfMonth \u003d new Date(selectedYear, selectedMonth - 1, 1);\n    var endOfMonth \u003d new Date(selectedYear, selectedMonth, 0);\n    \n    console.log(\u0027Start of month:\u0027, startOfMonth);\n    console.log(\u0027End of month:\u0027, endOfMonth);\n\n    var thirtyDaysInMilliseconds \u003d 30 * 24 * 60 * 60 * 1000;\n\n    function isInTargetMonth(date) {\n      return date \u003e\u003d startOfMonth \u0026\u0026 date \u003c\u003d endOfMonth;\n    }\n\n    // Process previous month data\n    previousMonthData.forEach(function(row) {\n      var key \u003d row[1] + \u0027|\u0027 + row[4]; // Product + Lot number\n      var initialDueDate \u003d new Date(row[7]);\n      var palletCount \u003d parseInt(row[9]);\n      var quantity \u003d parseInt(row[8]); // Get quantity from column I\n      \n      pallets[key] \u003d {\n        palletCount: palletCount,\n        quantity: quantity,\n        initialDueDate: initialDueDate,\n        lastPalletDueDate: initialDueDate, // Last Pallet Due Date from column H\n        nextPalletDueDate: new Date(initialDueDate.getTime() + thirtyDaysInMilliseconds), // Next Pallet Due Date is +30 days\n        dailyPalletCount: {},\n        dailyQuantity: {}\n      };\n      \n      // Fill in daily quantities for the entire month\n      var currentDate \u003d new Date(startOfMonth);\n      while (currentDate \u003c\u003d endOfMonth) {\n        pallets[key].dailyPalletCount[currentDate.toDateString()] \u003d palletCount;\n        pallets[key].dailyQuantity[currentDate.toDateString()] \u003d quantity;\n        currentDate.setDate(currentDate.getDate() + 1);\n      }\n    });\n    \n    // Process Store In data\n    storeInData.forEach(function(row) {\n      var product \u003d row[2]; // Product name from column C\n      var lotNumber \u003d row[5]; // Lot number from column F\n      var key \u003d product + \u0027|\u0027 + lotNumber;\n      var storedDate \u003d new Date(row[6]); // Date Stored from column G\n      var palletCount \u003d parseInt(row[9]); // Pallet count from column J\n      var quantity \u003d parseInt(row[8]); // Get quantity from column I\n\n      if (isInTargetMonth(storedDate)) {\n        storeInPallets[key] \u003d {\n          palletCount: palletCount,\n          quantity: quantity,\n          initialPalletCount: palletCount,\n          initialQuantity: quantity,\n          storedDate: storedDate,\n          lastPalletDueDate: storedDate, // Last Pallet Due Date from column G\n          nextPalletDueDate: new Date(storedDate.getTime() + 29 * 24 * 60 * 60 * 1000), // Next Pallet Due Date is +29 days\n          fullyWithdrawn: false\n        };\n      }\n    });\n    \n    // Process stock out data\n    stockOutData.forEach(function(row) {\n      var key \u003d row[2] + \u0027|\u0027 + row[5]; // Product + Lot number\n      var outDate \u003d new Date(row[0]);\n      var outPalletCount \u003d parseInt(row[9]);\n      var outQuantity \u003d parseInt(row[8]); // Get quantity from column I\n      if (pallets[key] \u0026\u0026 isInTargetMonth(outDate)) {\n        pallets[key].palletCount \u003d Math.max(0, pallets[key].palletCount - outPalletCount);\n        pallets[key].quantity \u003d Math.max(0, pallets[key].quantity - outQuantity);\n        \n        // Update daily quantities\n        for (var d \u003d new Date(outDate); d \u003c\u003d endOfMonth; d.setDate(d.getDate() + 1)) {\n          if (pallets[key].dailyPalletCount[d.toDateString()] !\u003d\u003d undefined) {\n            pallets[key].dailyPalletCount[d.toDateString()] \u003d Math.max(0, pallets[key].dailyPalletCount[d.toDateString()] - outPalletCount);\n            pallets[key].dailyQuantity[d.toDateString()] \u003d Math.max(0, pallets[key].dailyQuantity[d.toDateString()] - outQuantity);\n          }\n        }\n      }\n      if (storeInPallets[key] \u0026\u0026 isInTargetMonth(outDate)) {\n        storeInPallets[key].palletCount \u003d Math.max(0, storeInPallets[key].palletCount - outPalletCount);\n        storeInPallets[key].quantity \u003d Math.max(0, storeInPallets[key].quantity - outQuantity);\n        if (storeInPallets[key].palletCount \u003c\u003d 0) {\n          storeInPallets[key].fullyWithdrawn \u003d true;\n        }\n      }\n    });\n\n    // Calculate charges\n    var charges \u003d [];\n    var lotCounts \u003d {};\n\n    for (var key in pallets) {\n      var data \u003d pallets[key];\n      \n      var currentDueDate \u003d new Date(data.initialDueDate);\n      var chargeCount \u003d 0;\n      while (currentDueDate \u003c\u003d endOfMonth) {\n        var nextDueDate \u003d new Date(currentDueDate.getTime() + thirtyDaysInMilliseconds);\n        \n        if (isInTargetMonth(currentDueDate) || isInTargetMonth(nextDueDate)) {\n          var chargePeriodStart \u003d new Date(Math.max(currentDueDate, startOfMonth));\n          var chargePeriodEnd \u003d new Date(Math.min(nextDueDate, endOfMonth));\n          \n          var periodPalletCount \u003d data.palletCount;\n          var periodQuantity \u003d data.quantity;\n          for (var d \u003d new Date(chargePeriodStart); d \u003c\u003d chargePeriodEnd; d.setDate(d.getDate() + 1)) {\n            periodPalletCount \u003d Math.max(periodPalletCount, data.dailyPalletCount[d.toDateString()] || 0);\n            periodQuantity \u003d Math.max(periodQuantity, data.dailyQuantity[d.toDateString()] || 0);\n          }\n          \n          if (periodPalletCount \u003e 0 || periodQuantity \u003e 0) {\n            var [product, lot] \u003d key.split(\u0027|\u0027);\n            var reason;\n            if (chargeCount \u003d\u003d\u003d 0) {\n              reason \u003d \"Due Date Reached\";\n            } else if (chargeCount \u003d\u003d\u003d 1 \u0026\u0026 isInTargetMonth(data.initialDueDate)) {\n              reason \u003d \"Charged Twice in Same Month\";\n            } else {\n              reason \u003d \"30 Days Period\";\n            }\n            \n            // Adjust Last Due Date and Next Due Date for subsequent charges\n            var lastDueDate \u003d chargeCount \u003d\u003d\u003d 0 ? data.lastPalletDueDate : new Date(endOfMonth);\n            var nextDueDate \u003d new Date(lastDueDate.getTime() + thirtyDaysInMilliseconds);\n            \n            charges.push([product, lot, periodQuantity, periodPalletCount, reason, formatDate(lastDueDate), formatDate(nextDueDate)]);\n            lotCounts[lot] \u003d (lotCounts[lot] || 0) + 1;\n            chargeCount++;\n          }\n        }\n        \n        currentDueDate \u003d nextDueDate;\n      }\n    }\n    \n    // Add charges for all Store In pallets in the selected month, not just fully withdrawn ones\n    for (var key in storeInPallets) {\n      var data \u003d storeInPallets[key];\n      var [product, lot] \u003d key.split(\u0027|\u0027);\n      charges.push([product, lot, data.initialQuantity, data.initialPalletCount, \"New Store in\", formatDate(data.lastPalletDueDate), formatDate(data.nextPalletDueDate)]);\n      lotCounts[lot] \u003d (lotCounts[lot] || 0) + 1;\n    }\n    \n    // Add a flag for repeated lot numbers\n    charges \u003d charges.map(function(charge) {\n      var lot \u003d charge[1];\n      return charge.concat([lotCounts[lot] \u003e 1]);\n    });\n    \n    console.log(\u0027Charges calculated:\u0027, charges.length);\n    return charges;\n  } catch (error) {\n    console.error(\u0027Error in calculatePalletCharges:\u0027, error);\n    throw error;  // Re-throw the error to be caught by the client-side code\n  }\n}\n\nfunction getMonthName(monthNumber) {\n  var monthNames \u003d [\u0027Jan\u0027, \u0027Feb\u0027, \u0027Mar\u0027, \u0027Apr\u0027, \u0027May\u0027, \u0027Jun\u0027, \n                    \u0027Jul\u0027, \u0027Aug\u0027, \u0027Sep\u0027, \u0027Oct\u0027, \u0027Nov\u0027, \u0027Dec\u0027];\n  if (monthNumber \u003c 1 || monthNumber \u003e 12) {\n    throw new Error(\u0027Invalid month number: \u0027 + monthNumber);\n  }\n  return monthNames[monthNumber - 1];\n}\n\nfunction formatDate(date) {\n  return Utilities.formatDate(date, Session.getScriptTimeZone(), \"dd/MM/yyyy\");\n}\n\nfunction duplicateAndFilterSheet() {\n  try {\n    // Use the specific spreadsheet ID\n    var ss \u003d SpreadsheetApp.openById(\u002717kO0MzE5mOMcQqdJgHenpSjY4Tll2KMpF8pSIdiXLUo\u0027);\n    \n    // Get the \"Sing Long Summary\" sheet\n    var sourceSheet \u003d ss.getSheetByName(\"Sing Long Summary\");\n    \n    // Check if the sheet exists\n    if (!sourceSheet) {\n      return { success: false, error: \"Sheet \u0027Sing Long Summary\u0027 not found.\" };\n    }\n    \n    // Get all data from the source sheet\n    var data \u003d sourceSheet.getDataRange().getValues();\n    \n    // Create an array to keep track of rows to delete\n    var rowsToDelete \u003d [];\n    \n    // Iterate through the data (skipping the header row)\n    for (var i \u003d data.length - 1; i \u003e 0; i--) {\n      if (data[i][8] \u003d\u003d\u003d 0) {\n        rowsToDelete.push(i + 1); // +1 because sheet rows are 1-indexed\n      }\n    }\n    \n    // Delete the rows with 0 in column I (index 8)\n    rowsToDelete.forEach(function(row) {\n      sourceSheet.deleteRow(row);\n    });\n    \n    // Create a new date object\n    var date \u003d new Date();\n    \n    // Subtract 5 days from the current date\n    date.setDate(date.getDate() - 5);\n    \n    // Format the date as MMM yyyy\n    var newSheetName \u003d Utilities.formatDate(date, Session.getScriptTimeZone(), \"MMM yyyy\");\n    \n    // Duplicate the filtered sheet\n    var newSheet \u003d sourceSheet.copyTo(ss);\n    \n    // Rename the new sheet\n    newSheet.setName(newSheetName);\n    \n    return { success: true, newSheetName: newSheetName };\n  } catch (error) {\n    console.error(\u0027Error in duplicateAndFilterSheet:\u0027, error);\n    return { success: false, error: error.toString() };\n  }\n}"},{"id":"23789dec-fbec-4656-b7ca-b68ef2197d10","name":"Script","type":"html","source":"\u003cscript\u003e\n\nfunction activateTab(element, contentId) {\n  // Remove active class from all tabs\n  var tabs \u003d document.getElementsByClassName(\u0027tab\u0027);\n  for (var i \u003d 0; i \u003c tabs.length; i++) {\n    tabs[i].classList.remove(\u0027active\u0027);\n  }\n\n  // Add active class to the clicked tab\n  element.classList.add(\u0027active\u0027);\n\n  // Hide all tab content\n  var tabContents \u003d document.getElementsByClassName(\u0027tab-content\u0027);\n  for (var i \u003d 0; i \u003c tabContents.length; i++) {\n    tabContents[i].style.display \u003d \u0027none\u0027;\n  }\n\n  // Show the selected tab content\n  document.getElementById(contentId).style.display \u003d \u0027block\u0027;\n}\n\n      document.addEventListener(\u0027DOMContentLoaded\u0027, function() {\n        var today \u003d new Date().toISOString().substr(0, 10);\n        document.getElementById(\u0027drawOutDate\u0027).value \u003d today;\n        document.getElementById(\u0027stored-date\u0027).value \u003d today;\n      });\n\n  function filterInventory() {\n    const input \u003d document.getElementById(\u0027search-input\u0027).value.toLowerCase();\n    const tableBody \u003d document.getElementById(\u0027inventory-table-body\u0027);\n    const rows \u003d tableBody.getElementsByTagName(\u0027tr\u0027);\n\n    for (let i \u003d 0; i \u003c rows.length; i++) {\n      const cells \u003d rows[i].getElementsByTagName(\u0027td\u0027);\n      let match \u003d false;\n      for (let j \u003d 0; j \u003c cells.length; j++) {\n        if (cells[j].innerText.toLowerCase().includes(input)) {\n          match \u003d true;\n          break;\n        }\n      }\n      // Check if the value in the 10th column is 0\n      if (parseInt(cells[9].innerText) \u003d\u003d\u003d 0) {\n        match \u003d false;\n      }\n      rows[i].style.display \u003d match ? \u0027\u0027 : \u0027none\u0027;\n    }\n  }\n\n  function fetchInventoryData() {\n    google.script.run.withSuccessHandler(populateTable).getInventoryData();\n  }\n\n  function isValidDate(d) {\n    return !isNaN(Date.parse(d));\n  }\n\n  function formatDateString(dateString) {\n    const options \u003d { timeZone: \u0027Asia/Singapore\u0027, year: \u00272-digit\u0027, month: \u00272-digit\u0027, day: \u00272-digit\u0027 };\n    const date \u003d new Date(dateString);\n    return date.toLocaleDateString(\u0027en-GB\u0027, options).replace(/\\//g, \u0027-\u0027);\n  }\n\n  function populateTable(data) {\n    const inventoryData \u003d JSON.parse(data);\n    const tableBody \u003d document.getElementById(\u0027inventory-table-body\u0027);\n    tableBody.innerHTML \u003d \u0027\u0027; // Clear existing table rows\n\n    inventoryData.slice(1).forEach((row, originalRowIdx) \u003d\u003e {\n      const tr \u003d document.createElement(\u0027tr\u0027);\n      tr.setAttribute(\u0027data-original-row-idx\u0027, originalRowIdx); // Add the original row index as a data attribute\n      tr.addEventListener(\u0027click\u0027, () \u003d\u003e handleRowClick(originalRowIdx)); // Pass the original row index\n\n      row.forEach((cell, index) \u003d\u003e {\n        const td \u003d document.createElement(\u0027td\u0027);\n        if ((index \u003d\u003d\u003d 4 || index \u003d\u003d\u003d 7) \u0026\u0026 isValidDate(cell)) {\n          td.innerText \u003d formatDateString(cell);\n        } else {\n          td.innerText \u003d cell;\n        }\n        tr.appendChild(td);\n      });\n\n      // Hide the row if the value in the 10th column (index 9) is zero\n      if (parseInt(row[9]) \u003d\u003d\u003d 0) {\n        tr.style.display \u003d \u0027none\u0027;\n      }\n\n      tableBody.appendChild(tr);\n    });\n  }\n\n  window.onload \u003d fetchInventoryData;\n\n  function sortTable(columnIndex) {\n    const table \u003d document.querySelector(\u0027tbody\u0027);\n    const rows \u003d Array.from(table.rows);\n    const th \u003d document.querySelectorAll(\u0027th\u0027)[columnIndex];\n    const order \u003d th.classList.contains(\u0027sorted-asc\u0027) ? \u0027desc\u0027 : \u0027asc\u0027;\n\n    rows.sort((a, b) \u003d\u003e {\n      const cellA \u003d a.cells[columnIndex].innerText.toLowerCase();\n      const cellB \u003d b.cells[columnIndex].innerText.toLowerCase();\n\n      if (!isNaN(Date.parse(cellA)) \u0026\u0026 !isNaN(Date.parse(cellB))) {\n        return order \u003d\u003d\u003d \u0027asc\u0027 \n          ? new Date(cellA) - new Date(cellB) \n          : new Date(cellB) - new Date(cellA);\n      }\n\n      if (!isNaN(cellA) \u0026\u0026 !isNaN(cellB)) {\n        return order \u003d\u003d\u003d \u0027asc\u0027 \n          ? cellA - cellB \n          : cellB - cellA;\n      }\n\n      return order \u003d\u003d\u003d \u0027asc\u0027 \n        ? cellA.localeCompare(cellB) \n        : cellB.localeCompare(cellA);\n    });\n\n    rows.forEach(row \u003d\u003e table.appendChild(row));\n\n    document.querySelectorAll(\u0027th\u0027).forEach(th \u003d\u003e th.classList.remove(\u0027sorted-asc\u0027, \u0027sorted-desc\u0027));\n    th.classList.add(order \u003d\u003d\u003d \u0027asc\u0027 ? \u0027sorted-asc\u0027 : \u0027sorted-desc\u0027);\n  }\n\n  // Function to toggle section visibility based on ID\n  function showSection(sectionId) {\n    const sections \u003d document.querySelectorAll(\u0027section\u0027);\n    sections.forEach(section \u003d\u003e {\n      if (section.id \u003d\u003d\u003d sectionId) {\n        section.style.display \u003d \u0027block\u0027;\n      } else {\n        section.style.display \u003d \u0027none\u0027;\n      }\n    });\n  }\n\n  function handleRowClick(originalRowIdx) {\n    const table \u003d document.getElementById(\u0027inventory-table\u0027);\n    const rows \u003d table.getElementsByTagName(\u0027tbody\u0027)[0].getElementsByTagName(\u0027tr\u0027);\n    const row \u003d rows[originalRowIdx]; // Use the original row index\n    const cells \u003d row.getElementsByTagName(\u0027td\u0027);\n\n    // Extract product name (assuming index 1) and packing info (assuming index 2)\n    const productName \u003d cells[1].innerText.trim();\n    const packingInfo \u003d cells[2].innerText.trim();\n\n    // Populate modal with relevant data (product name and packing info)\n    document.getElementById(\u0027productName\u0027).innerText \u003d productName;\n    document.getElementById(\u0027packingInfo\u0027).innerText \u003d packingInfo;\n\n    // Show modal dialog\n    const modal \u003d document.getElementById(\u0027myModal\u0027);\n    modal.style.display \u003d \u0027block\u0027;\n\n    // Optionally pre-fill modal fields (quantity and pallet inputs)\n    document.getElementById(\u0027quantityInput\u0027).value \u003d \u0027\u0027; // Clear previous input\n    document.getElementById(\u0027palletInput\u0027).value \u003d \u0027\u0027; // Clear previous input\n\n    // Store the original row index in the modal for later use\n    modal.setAttribute(\u0027data-original-row-idx\u0027, originalRowIdx);\n  }\n\n  // Function to close modal\n  function closeModal() {\n    const modal \u003d document.getElementById(\u0027myModal\u0027);\n    modal.style.display \u003d \u0027none\u0027;\n  }\n\n  // Function to save values from modal\n  function saveValues() {\n    const modal \u003d document.getElementById(\u0027myModal\u0027);\n    const originalRowIdx \u003d parseInt(modal.getAttribute(\u0027data-original-row-idx\u0027), 10);\n    const quantity \u003d parseInt(document.getElementById(\u0027quantityInput\u0027).value, 10);\n    const pallet \u003d parseInt(document.getElementById(\u0027palletInput\u0027).value, 10);\n\n    // Validate inputs\n    if (isNaN(quantity) || isNaN(pallet)) {\n      alert(\u0027Please enter valid numerical values.\u0027);\n      return;\n    }\n\n    // Update values in Google Sheet\n    google.script.run\n      .withSuccessHandler(function() {\n        // Close the modal after successful update\n        closeModal();\n      })\n      .updateInventoryValues(originalRowIdx, quantity, pallet);\n  }\n\nlet isGrouped \u003d false;\nlet originalData \u003d [];\n\nfunction groupInventory() {\n  const tableBody \u003d document.getElementById(\u0027inventory-table-body\u0027);\n  const tableHeader \u003d document.getElementById(\u0027inventory-table\u0027).getElementsByTagName(\u0027thead\u0027)[0];\n  const groupButton \u003d document.getElementById(\u0027groupButton\u0027);\n\n  if (!isGrouped) {\n    const rows \u003d Array.from(tableBody.getElementsByTagName(\u0027tr\u0027));\n    const groupedData \u003d {};\n\n    rows.forEach(row \u003d\u003e {\n      const cells \u003d row.getElementsByTagName(\u0027td\u0027);\n      const itemCode \u003d cells[0].innerText;\n      const quantity \u003d parseInt(cells[9].innerText);\n      const pallets \u003d parseInt(cells[10].innerText);\n\n      if (groupedData[itemCode]) {\n        groupedData[itemCode].quantity +\u003d quantity;\n        groupedData[itemCode].pallets +\u003d pallets;\n      } else {\n        groupedData[itemCode] \u003d {\n          itemCode: itemCode,\n          productDescription: cells[1].innerText,\n          packing: cells[2].innerText,\n          quantity: quantity,\n          pallets: pallets\n        };\n      }\n    });\n\n    tableBody.innerHTML \u003d \u0027\u0027;\n\n    for (const key in groupedData) {\n      const row \u003d groupedData[key];\n      const tr \u003d document.createElement(\u0027tr\u0027);\n\n      const columns \u003d [row.itemCode, row.productDescription, row.packing, \u0027\u0027, \u0027\u0027, \u0027\u0027, \u0027\u0027, \u0027\u0027, \u0027\u0027, row.quantity, row.pallets];\n      columns.forEach((value, index) \u003d\u003e {\n        const td \u003d document.createElement(\u0027td\u0027);\n        td.innerText \u003d value;\n        if ([3, 4, 5, 6, 7, 8].includes(index)) { // Hide specific columns\n          td.style.display \u003d \u0027none\u0027;\n        }\n        tr.appendChild(td);\n      });\n\n      tableBody.appendChild(tr);\n    }\n\n    // Hide the specified columns in the header\n    const headerCells \u003d tableHeader.getElementsByTagName(\u0027th\u0027);\n    [3, 4, 5, 6, 7, 8].forEach(index \u003d\u003e {\n      headerCells[index].style.display \u003d \u0027none\u0027;\n    });\n\n    // Change the button text to \"Ungroup\"\n    groupButton.innerText \u003d \u0027Ungroup\u0027;\n\n    isGrouped \u003d true;\n  } else {\n    populateTable(originalData);\n    isGrouped \u003d false;\n\n    // Change the button text back to \"Group\"\n    groupButton.innerText \u003d \u0027Group\u0027;\n  }\n}\n\nfunction populateTable(data) {\n  originalData \u003d data;\n  const inventoryData \u003d JSON.parse(data);\n  const tableBody \u003d document.getElementById(\u0027inventory-table-body\u0027);\n  tableBody.innerHTML \u003d \u0027\u0027; // Clear existing table rows\n\n  inventoryData.slice(1).forEach((row, originalRowIdx) \u003d\u003e {\n    const tr \u003d document.createElement(\u0027tr\u0027);\n    tr.setAttribute(\u0027data-original-row-idx\u0027, originalRowIdx); // Add the original row index as a data attribute\n    tr.addEventListener(\u0027click\u0027, () \u003d\u003e handleRowClick(originalRowIdx)); // Pass the original row index\n\n    row.forEach((cell, index) \u003d\u003e {\n      const td \u003d document.createElement(\u0027td\u0027);\n      if ((index \u003d\u003d\u003d 4 || index \u003d\u003d\u003d 7) \u0026\u0026 isValidDate(cell)) {\n        td.innerText \u003d formatDateString(cell);\n      } else {\n        td.innerText \u003d cell;\n      }\n      tr.appendChild(td);\n    });\n\n    // Hide the row if the value in the 10th column (index 9) is zero\n    if (parseInt(row[9]) \u003d\u003d\u003d 0) {\n      tr.style.display \u003d \u0027none\u0027;\n    }\n\n    tableBody.appendChild(tr);\n  });\n\n  // Show all header cells when ungrouping\n  const tableHeader \u003d document.getElementById(\u0027inventory-table\u0027).getElementsByTagName(\u0027thead\u0027)[0];\n  const headerCells \u003d tableHeader.getElementsByTagName(\u0027th\u0027);\n  for (let i \u003d 0; i \u003c headerCells.length; i++) {\n    headerCells[i].style.display \u003d \u0027\u0027;\n  }\n}\n\nfunction fetchInventoryData() {\n  google.script.run.withSuccessHandler(populateTable).getInventoryData();\n}\n\n// Call fetchInventoryData on window load to populate the table initially\nwindow.onload \u003d fetchInventoryData;\n\n    // Lineage Draw out\n\nfunction showSection(sectionId) {\n  document.querySelectorAll(\u0027section\u0027).forEach(function(section) {\n    section.classList.remove(\u0027active\u0027);\n  });\n  document.getElementById(sectionId).classList.add(\u0027active\u0027);\n}\n\nfunction refreshInventoryTable() {\n  google.script.run\n    .withSuccessHandler(function(jsonData) {\n      var data \u003d JSON.parse(jsonData);\n      var tableBody \u003d document.getElementById(\u0027inventory-table-body\u0027);\n      tableBody.innerHTML \u003d \u0027\u0027;\n      \n      for (var i \u003d 1; i \u003c data.length; i++) {\n        var row \u003d data[i];\n        var newRow \u003d tableBody.insertRow();\n        for (var j \u003d 0; j \u003c row.length; j++) {\n          var cell \u003d newRow.insertCell();\n          cell.textContent \u003d row[j];\n        }\n      }\n      \n      // After updating the main table, refresh the modal\n      refreshInventoryModal();\n    })\n    .withFailureHandler(function(error) {\n      console.error(\"Error refreshing inventory:\", error);\n    })\n    .getInventoryData();\n}\n\nfunction refreshInventoryModal() {\n  var modalTableBody \u003d document.getElementById(\u0027modal-inventory-table-body\u0027);\n  modalTableBody.innerHTML \u003d \u0027\u0027;\n\n  var inventoryRows \u003d document.querySelectorAll(\u0027#inventory-table-body tr\u0027);\n  inventoryRows.forEach(function(row) {\n    var itemCode \u003d row.cells[0].textContent;\n    var productDescription \u003d row.cells[1].textContent;\n    var packingSize \u003d row.cells[2].textContent;\n    var type \u003d row.cells[3].textContent;\n    var expiryBatchNo \u003d row.cells[4].textContent;\n    var grn \u003d row.cells[5].textContent;\n    var lineageItemCode \u003d row.cells[6].textContent;\n    var dateStored \u003d row.cells[7].textContent;\n    var containerNo \u003d row.cells[8].textContent;\n    var balQuantity \u003d row.cells[9].textContent;\n    var balPallet \u003d row.cells[10].textContent;\n\n    if (parseFloat(balQuantity) \u003e 0) {\n      var newRow \u003d document.createElement(\u0027tr\u0027);\n      newRow.innerHTML \u003d `\n        \u003ctd\u003e${itemCode}\u003c/td\u003e\n        \u003ctd\u003e${productDescription}\u003c/td\u003e\n        \u003ctd\u003e${packingSize}\u003c/td\u003e\n        \u003ctd\u003e${type}\u003c/td\u003e\n        \u003ctd\u003e${expiryBatchNo}\u003c/td\u003e\n        \u003ctd\u003e${grn}\u003c/td\u003e\n        \u003ctd\u003e${lineageItemCode}\u003c/td\u003e\n        \u003ctd\u003e${dateStored}\u003c/td\u003e\n        \u003ctd\u003e${containerNo}\u003c/td\u003e\n        \u003ctd\u003e${balQuantity}\u003c/td\u003e\n        \u003ctd\u003e${balPallet}\u003c/td\u003e\n      `;\n\n      newRow.addEventListener(\u0027click\u0027, function() {\n        selectItem(itemCode, productDescription, packingSize, type, expiryBatchNo, grn, lineageItemCode, dateStored, containerNo, balQuantity, balPallet);\n      });\n\n      modalTableBody.appendChild(newRow);\n    }\n  });\n}\n\nfunction showInventoryModal() {\n  refreshInventoryModal();\n  document.getElementById(\u0027myModal\u0027).style.display \u003d \u0027block\u0027;\n}\n\nfunction selectItem(itemCode, productDescription, packingSize, type, expiryBatchNo, grn, lineageItemCode, dateStored, containerNo, balQuantity, balPallet) {\n  document.getElementById(\u0027selected-item-code\u0027).textContent \u003d itemCode;\n  document.getElementById(\u0027selected-product-description\u0027).textContent \u003d productDescription;\n  document.getElementById(\u0027selected-packing\u0027).textContent \u003d packingSize;\n  document.getElementById(\u0027selected-type\u0027).textContent \u003d type;\n  document.getElementById(\u0027selected-expiry-batch\u0027).textContent \u003d expiryBatchNo;\n  document.getElementById(\u0027selected-grn\u0027).textContent \u003d grn;\n  document.getElementById(\u0027selected-lineage-item-code\u0027).textContent \u003d lineageItemCode;\n  document.getElementById(\u0027selected-date-stored\u0027).textContent \u003d dateStored;\n  document.getElementById(\u0027selected-container-no\u0027).textContent \u003d containerNo;\n  document.getElementById(\u0027selected-bal-quantity\u0027).textContent \u003d balQuantity;\n  document.getElementById(\u0027selected-bal-pallet\u0027).textContent \u003d balPallet;\n\n  closeModal();\n}\n\nfunction closeModal() {\n  document.getElementById(\u0027myModal\u0027).style.display \u003d \u0027none\u0027;\n}\n\nfunction filterInventory() {\n  var input \u003d document.getElementById(\u0027search-input\u0027).value.toLowerCase();\n  var rows \u003d document.querySelectorAll(\u0027#inventory-table-body tr\u0027);\n  \n  rows.forEach(function(row) {\n    var itemCode \u003d row.cells[0].textContent.toLowerCase();\n    var productDescription \u003d row.cells[1].textContent.toLowerCase();\n\n    if (itemCode.includes(input) || productDescription.includes(input)) {\n      row.classList.remove(\u0027hidden\u0027);\n    } else {\n      row.classList.add(\u0027hidden\u0027);\n    }\n  });\n}\n\nfunction filterModalInventory() {\n  var input \u003d document.getElementById(\u0027modal-search-input\u0027).value.toLowerCase();\n  var rows \u003d document.querySelectorAll(\u0027#modal-inventory-table-body tr\u0027);\n  \n  rows.forEach(function(row) {\n    var itemCode \u003d row.cells[0].textContent.toLowerCase();\n    var productDescription \u003d row.cells[1].textContent.toLowerCase();\n\n    if (itemCode.includes(input) || productDescription.includes(input)) {\n      row.classList.remove(\u0027hidden\u0027);\n    } else {\n      row.classList.add(\u0027hidden\u0027);\n    }\n  });\n}\n\nfunction drawOutStock() {\n  var dateInput \u003d document.getElementById(\u0027drawOutDate\u0027).value;\n  var formattedDate;\n  \n  if (dateInput) {\n    var [year, month, day] \u003d dateInput.split(\u0027-\u0027);\n    formattedDate \u003d `${day}/${month}/${year}`;\n  } else {\n    var today \u003d new Date();\n    formattedDate \u003d today.getDate().toString().padStart(2, \u00270\u0027) + \u0027/\u0027 +\n                    (today.getMonth() + 1).toString().padStart(2, \u00270\u0027) + \u0027/\u0027 +\n                    today.getFullYear();\n  }\n\n  var itemCode \u003d document.getElementById(\u0027selected-item-code\u0027).textContent.trim();\n  var productDescription \u003d document.getElementById(\u0027selected-product-description\u0027).textContent.trim();\n  var packing \u003d document.getElementById(\u0027selected-packing\u0027).textContent.trim();\n  var type \u003d document.getElementById(\u0027selected-type\u0027).textContent.trim();\n  var expiryBatchNo \u003d document.getElementById(\u0027selected-expiry-batch\u0027).textContent.trim();\n  var grn \u003d document.getElementById(\u0027selected-grn\u0027).textContent.trim();\n  var lineageItemCode \u003d document.getElementById(\u0027selected-lineage-item-code\u0027).textContent.trim();\n  var dateStored \u003d document.getElementById(\u0027selected-date-stored\u0027).textContent.trim();\n  var containerNo \u003d document.getElementById(\u0027selected-container-no\u0027).textContent.trim();\n  var quantity \u003d document.getElementById(\u0027input-quantity\u0027).value.trim();\n  var pallet \u003d document.getElementById(\u0027input-pallet\u0027).value.trim();\n\n  google.script.run\n    .withSuccessHandler(function(result) {\n      console.log(\"Success:\", result);\n      alert(result);\n      clearSelectedItem();\n      \n      // Call createInventorySummary first\n      google.script.run\n        .withSuccessHandler(function() {\n          console.log(\"Inventory Summary updated successfully\");\n          // Only after Inventory Summary is updated, refresh the inventory table\n          refreshInventoryTable();\n        })\n        .withFailureHandler(function(error) {\n          console.error(\"Error updating Inventory Summary:\", error);\n        })\n        .createInventorySummary();\n    })\n    .withFailureHandler(function(error) {\n      console.error(\"Error:\", error);\n      alert(\"Error: \" + error);\n    })\n    .updateGoogleSheet(formattedDate, itemCode, productDescription, packing, type, expiryBatchNo, grn, lineageItemCode, dateStored, containerNo, quantity, pallet);\n}\n\nfunction clearSelectedItem() {\n  document.getElementById(\u0027drawOutDate\u0027).value \u003d \u0027\u0027;\n  document.getElementById(\u0027selected-item-code\u0027).textContent \u003d \u0027\u0027;\n  document.getElementById(\u0027selected-product-description\u0027).textContent \u003d \u0027\u0027;\n  document.getElementById(\u0027selected-packing\u0027).textContent \u003d \u0027\u0027;\n  document.getElementById(\u0027selected-type\u0027).textContent \u003d \u0027\u0027;\n  document.getElementById(\u0027selected-expiry-batch\u0027).textContent \u003d \u0027\u0027;\n  document.getElementById(\u0027selected-grn\u0027).textContent \u003d \u0027\u0027;\n  document.getElementById(\u0027selected-lineage-item-code\u0027).textContent \u003d \u0027\u0027;\n  document.getElementById(\u0027selected-date-stored\u0027).textContent \u003d \u0027\u0027;\n  document.getElementById(\u0027selected-container-no\u0027).textContent \u003d \u0027\u0027;\n  document.getElementById(\u0027selected-bal-quantity\u0027).textContent \u003d \u0027\u0027;\n  document.getElementById(\u0027selected-bal-pallet\u0027).textContent \u003d \u0027\u0027;\n  document.getElementById(\u0027input-quantity\u0027).value \u003d \u0027\u0027;\n  document.getElementById(\u0027input-pallet\u0027).value \u003d \u0027\u0027;\n}\n\ndocument.addEventListener(\u0027DOMContentLoaded\u0027, function() {\n  refreshInventoryTable();\n});\n\n    // Lineage Stock In\n\n  function handlePaste(event) {\n  event.preventDefault();\n  var clipboardData \u003d event.clipboardData || window.clipboardData;\n  var pastedData \u003d clipboardData.getData(\u0027Text\u0027);\n  var rows \u003d pastedData.split(\u0027\\n\u0027);\n  var tableHtml \u003d \u0027\u003ctable border\u003d\"1\"\u003e\u0027;\n  tableHtml +\u003d `\n    \u003cthead\u003e\n      \u003ctr\u003e\n        \u003cth\u003eItem Code\u003c/th\u003e\n        \u003cth\u003eProduct Description\u003c/th\u003e\n        \u003cth\u003ePacking\u003c/th\u003e\n        \u003cth\u003eType\u003c/th\u003e\n        \u003cth\u003eExpiry Date/Batch No\u003c/th\u003e\n        \u003cth\u003eLineage Item Code\u003c/th\u003e\n        \u003cth\u003eQuantity\u003c/th\u003e\n        \u003cth\u003ePallet\u003c/th\u003e\n      \u003c/tr\u003e\n    \u003c/thead\u003e\n    \u003ctbody\u003e\n  `;\n  rows.forEach(function(row) {\n    tableHtml +\u003d \u0027\u003ctr\u003e\u0027;\n    var cells \u003d row.split(\u0027\\t\u0027);\n    cells.forEach(function(cell) {\n      tableHtml +\u003d \u0027\u003ctd\u003e\u0027 + cell + \u0027\u003c/td\u003e\u0027;\n    });\n    tableHtml +\u003d \u0027\u003c/tr\u003e\u0027;\n  });\n  tableHtml +\u003d \u0027\u003c/tbody\u003e\u003c/table\u003e\u0027;\n  document.getElementById(\u0027store-in-table-body\u0027).innerHTML \u003d tableHtml;\n}\n\n  function showSection(sectionId) {\n    document.querySelectorAll(\u0027section\u0027).forEach(section \u003d\u003e {\n      section.style.display \u003d \u0027none\u0027;\n    });\n    document.getElementById(sectionId).style.display \u003d \u0027block\u0027;\n  }\n\n  document.addEventListener(\u0027DOMContentLoaded\u0027, function() {\n    showSection(\u0027inventory\u0027);\n  });\n\nfunction storeInStock() {\n  var storedDate \u003d document.getElementById(\u0027stored-date\u0027).value;\n  var containerNumber \u003d document.getElementById(\u0027container-number\u0027).value;\n  var grn \u003d document.getElementById(\u0027grn\u0027).value;\n\n  var tableRows \u003d document.querySelectorAll(\u0027#store-in-table-body table tbody tr\u0027);\n\n  var data \u003d [];\n  tableRows.forEach(function(row) {\n    var cells \u003d row.querySelectorAll(\u0027td\u0027);\n    if (cells.length \u003c 8) {\n      console.warn(\u0027Row has fewer than expected cells, skipping...\u0027);\n      return; // skip this row\n    }\n    var rowData \u003d [\n      cells[0]?.innerText.trim() || \u0027\u0027,  // Item Code\n      cells[1]?.innerText.trim() || \u0027\u0027,  // Product Description\n      cells[2]?.innerText.trim() || \u0027\u0027,  // Packing\n      cells[3]?.innerText.trim() || \u0027\u0027,  // Type\n      cells[4]?.innerText.trim() || \u0027\u0027,  // Expiry Date/Batch No\n      cells[5]?.innerText.trim() || \u0027\u0027,  // Lineage Item Code\n      cells[6]?.innerText.trim() || \u0027\u0027,  // Quantity\n      cells[7]?.innerText.trim() || \u0027\u0027   // Pallet\n    ];\n    data.push(rowData);\n  });\n\n  if (data.length \u003d\u003d\u003d 0) {\n    console.error(\u0027No valid data to store\u0027);\n    // Optionally, provide user feedback\n    return;\n  }\n\n  // Call Google Apps Script function to append data to Google Sheet\n  google.script.run.withSuccessHandler(function() {\n    console.log(\u0027Data stored successfully!\u0027);\n    // Optionally, add UI feedback here\n  }).withFailureHandler(function(error) {\n    console.error(\u0027Error storing data:\u0027, error.message);\n    // Optionally, handle the error and provide user feedback\n  }).storeData(data, storedDate, containerNumber, grn);\n}\n\n\n\n\n\n\n\u003c/script\u003e\n"},{"id":"fe468a49-c17e-42e8-89c7-46ae261d6f5c","name":"Shipment","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n\u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n    \u003c?!\u003d include(\u0027CSS\u0027); ?\u003e\n    \u003cstyle\u003e\n        table {\n    width: 80%;\n    border-collapse: collapse;\n    margin: 0 auto;\n    table-layout: fixed;\n}\n\nth, td {\n    border: 1px solid #ddd;\n    padding: 8px;\n    text-align: left;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n/* Column widths */\nth:nth-child(1), td:nth-child(1) { width: 18%; }  /* Shipment No */\nth:nth-child(2), td:nth-child(2) { width: 5%; }   /* PO No */\nth:nth-child(3), td:nth-child(3) { width: 12%; }  /* Container Number */\nth:nth-child(4), td:nth-child(4) { width: 10%; }  /* ETA */\nth:nth-child(5), td:nth-child(5) { width: 10%; }  /* Trucking By */\nth:nth-child(6), td:nth-child(6) { width: 12%; }  /* Unloading Date */\nth:nth-child(7), td:nth-child(7) { width: 10%; }  /* Unloaded By */\nth:nth-child(8), td:nth-child(8) { width: 13%; }  /* Action */\n\n/* Specific styling for table input fields */\n.table-input-field {\n    width: 95%;              /* Changed from 30% to 95% to fill the cell */\n    padding: 4px;\n    border: 1px solid #ccc;\n    border-radius: 3px;\n    background-color: #ffffd0;\n    box-sizing: border-box;\n    margin: 0;              /* Added to remove any default margins */\n    display: block;         /* Added to ensure proper width behavior */\n}\n\nth {\n    background-color: #f2f2f2;\n    position: sticky;\n    top: 0;\n}\n\n.view-btn, .edit-btn {\n    padding: 6px 12px;\n    margin: 2px;\n    border-radius: 4px;\n    border: none;\n    cursor: pointer;\n    font-weight: 500;\n    font-size: 13px;\n    transition: all 0.2s ease;\n    display: inline-block;\n    min-width: 60px;\n    text-align: center;\n}\n\n/* Add styles for the action column to properly align buttons */\n.action {\n    white-space: nowrap;\n    text-align: center;\n    padding: 8px;\n}\n\n.view-btn {\n    background-color: #2c3e50; /* Dark blue that matches your theme */\n    color: white;\n}\n\n.edit-btn {\n    background-color: #3498db;\n    color: white;\n}\n\n.view-btn:hover {\n    background-color: #243442; /* Darker shade for hover */\n}\n\n.edit-btn:hover {\n    background-color: #1e88e5;\n}\n\n        .tab-container {\n            display: flex;\n            border-bottom: 1px solid #ccc;\n            margin-bottom: 20px;\n        }\n        .tab {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 10px 15px;\n            cursor: pointer;\n            border: 1px solid #ccc;\n            border-bottom: none;\n            background-color: #f0f0f0;\n            margin-right: 5px;\n            border-radius: 5px 5px 0 0;\n            position: relative;\n        }\n        .tab .tab-text {\n            margin-right: 15px;\n        }\n        .tab-content {\n            display: none;\n            padding: 20px;\n            background-color: #fff;\n            border: 1px solid #ccc;\n            border-radius: 5px;\n            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\n        }\n        .tab-content.active {\n            display: block;\n        }\n        .tab-content h2 {\n            font-size: 1.8em;\n            color: #333;\n            margin-bottom: 20px;\n            text-align: center;\n        }\n        .tab .close-tab {\n            position: absolute;\n            right: 5px;\n            top: 50%;\n            transform: translateY(-50%);\n            cursor: pointer;\n            font-weight: bold;\n            color: #888;\n            font-size: 18px;\n            line-height: 1;\n        }\n        .tab .close-tab:hover {\n            color: #000;\n        }\n\n        #upload {\n    padding: 20px;\n    background-color: #f9f9f9;\n    border-radius: 8px;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n}\n\n#upload button {\n    background-color: #4CAF50;\n    color: white;\n    padding: 10px 15px;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 16px;\n    margin-right: 10px;\n    transition: background-color 0.3s;\n}\n\n#upload button:hover {\n    background-color: #45a049;\n}\n\n#uploadForm {\n    margin-top: 20px;\n    display: flex;\n    align-items: center;\n}\n\n#shipmentFileInput {\n    margin-right: 10px;\n    padding: 8px;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n}\n\n/* Shipment Entry Form styles */\n#shipmentEntryForm {\n    background-color: #ffffff;\n    padding: 20px;\n    border-radius: 8px;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    max-width: 800px;\n    margin: 20px auto;\n}\n\n#shipmentEntryForm h3 {\n    color: #333;\n    margin-bottom: 20px;\n    text-align: center;\n}\n\n#shipmentEntryForm label {\n    display: inline-block;\n    width: 120px;\n    margin-bottom: 10px;\n    color: #555;\n}\n\n#shipmentEntryForm input[type\u003d\"text\"],\n#shipmentEntryForm input[type\u003d\"date\"],\n#shipmentEntryForm select {\n    width: calc(100% - 130px);\n    padding: 8px;\n    margin-bottom: 10px;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    box-sizing: border-box;\n}\n\n#shipmentEntryForm select {\n    height: 36px;\n}\n\n#shipmentEntryForm button[type\u003d\"button\"] {\n    background-color: #4CAF50;\n    color: white;\n    padding: 10px 15px;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 16px;\n    width: 100%;\n    margin-top: 20px;\n    transition: background-color 0.3s;\n}\n\n#shipmentEntryForm button[type\u003d\"button\"]:hover {\n    background-color: #45a049;\n}\n    \u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n    \u003cheader\u003e\n        \u003ch1\u003eInventory Management System\u003c/h1\u003e\n    \u003c/header\u003e\n    \u003cnav\u003e\n        {{NAVBAR}}\n    \u003c/nav\u003e\n    \u003cmain\u003e\n        \u003cdiv class\u003d\"tab-container\"\u003e\n            \u003cdiv class\u003d\"tab active\" onclick\u003d\"activateTab(this, \u0027shipmentListSection\u0027)\"\u003eShipment List\u003c/div\u003e\n            \u003cdiv class\u003d\"tab\" onclick\u003d\"activateTab(this, \u0027upload\u0027)\"\u003eUpload\u003c/div\u003e\n        \u003c/div\u003e\n        \u003cdiv id\u003d\"shipmentListSection\" class\u003d\"tab-content active\"\u003e\n          \u003ch2\u003eShipment List\u003c/h2\u003e\n            \u003cbr\u003e\u003cbr\u003e\n            \u003cdiv id\u003d\"shipmentList\"\u003e\u003c/div\u003e\n        \u003c/div\u003e\n\n        \u003cdiv id\u003d\"upload\" class\u003d\"tab-content\"\u003e\n    \n    \u003cform id\u003d\"uploadForm\"\u003e\n        \u003cinput type\u003d\"file\" name\u003d\"shipmentFileInput\" id\u003d\"shipmentFileInput\" accept\u003d\".xlsx, .xls\"\u003e\n        \u003cbutton type\u003d\"button\" onclick\u003d\"uploadShipmentFile()\"\u003eUpload Shipment\u003c/button\u003e\n        \u003cbutton type\u003d\"button\" onclick\u003d\"showShipmentEntryForm()\"\u003eShipment Entry\u003c/button\u003e\n    \u003c/form\u003e\n    \u003cbr\u003e\u003cbr\u003e\n    \u003cdiv id\u003d\"shipmentEntryForm\" style\u003d\"display: none;\"\u003e\n        \u003ch3\u003eShipment Entry\u003c/h3\u003e\n        \u003cform id\u003d\"shipmentEntryForm\" name\u003d\"shipmentEntryForm\"\u003e\n            \u003clabel for\u003d\"shipmentNo\"\u003eShipment No:\u003c/label\u003e\n            \u003cinput type\u003d\"text\" id\u003d\"shipmentNo\" name\u003d\"shipmentNo\" required\u003e\u003cbr\u003e\u003cbr\u003e\n            \n            \u003clabel for\u003d\"po\"\u003ePO:\u003c/label\u003e\n            \u003cinput type\u003d\"text\" id\u003d\"po\" name\u003d\"po\" required\u003e\u003cbr\u003e\u003cbr\u003e\n            \n            \u003clabel for\u003d\"containerNo\"\u003eContainer No:\u003c/label\u003e\n            \u003cinput type\u003d\"text\" id\u003d\"containerNo\" name\u003d\"containerNo\" required\u003e\u003cbr\u003e\u003cbr\u003e\n            \n            \u003clabel for\u003d\"eta\"\u003eETA:\u003c/label\u003e\n            \u003cinput type\u003d\"date\" id\u003d\"eta\" name\u003d\"eta\" required\u003e\u003cbr\u003e\u003cbr\u003e\n            \n            \u003clabel for\u003d\"truckingBy\"\u003eTrucking By:\u003c/label\u003e\n            \u003cinput type\u003d\"text\" id\u003d\"truckingBy\" name\u003d\"truckingBy\" required\u003e\u003cbr\u003e\u003cbr\u003e\n            \n            \u003clabel for\u003d\"unloadDate\"\u003eUnload Date:\u003c/label\u003e\n            \u003cinput type\u003d\"date\" id\u003d\"unloadDate\" name\u003d\"unloadDate\" required\u003e\u003cbr\u003e\u003cbr\u003e\n            \n            \u003clabel\u003eProducts:\u003c/label\u003e\n            \u003cselect id\u003d\"productSelector\" onchange\u003d\"addProductToTable()\"\u003e\n                \u003coption value\u003d\"\"\u003eSelect a product\u003c/option\u003e\n            \u003c/select\u003e\u003cbr\u003e\u003cbr\u003e\n            \n            \u003ctable id\u003d\"productTable\"\u003e\n                \u003cthead\u003e\n                    \u003ctr\u003e\n                        \u003cth\u003eItem Code\u003c/th\u003e\n                        \u003cth\u003eProduct Description\u003c/th\u003e\n                        \u003cth\u003ePacking\u003c/th\u003e\n                        \u003cth\u003eQuantity\u003c/th\u003e\n                    \u003c/tr\u003e\n                \u003c/thead\u003e\n                \u003ctbody id\u003d\"productTableBody\"\u003e\n                \u003c/tbody\u003e\n            \u003c/table\u003e\n            \n            \u003cbr\u003e\u003cbr\u003e\n            \u003cbutton type\u003d\"button\" onclick\u003d\"submitShipmentEntry()\"\u003eSubmit\u003c/button\u003e\n        \u003c/form\u003e\n    \u003c/div\u003e\n    \u003cdiv id\u003d\"shipmentList\"\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n    \u003c/main\u003e\n    \u003cfooter\u003e\n        \u003cp\u003e\u0026copy; 2024 Inventory Management System\u003c/p\u003e\n    \u003c/footer\u003e\n\n    \u003cscript\u003e\nfunction activateTab(tabElement, sectionId) {\n    document.querySelectorAll(\u0027.tab\u0027).forEach(tab \u003d\u003e tab.classList.remove(\u0027active\u0027));\n    document.querySelectorAll(\u0027.tab-content\u0027).forEach(content \u003d\u003e content.classList.remove(\u0027active\u0027));\n    \n    tabElement.classList.add(\u0027active\u0027);\n    document.getElementById(sectionId).classList.add(\u0027active\u0027);\n}\n\nfunction loadShipmentList() {\n    google.script.run.withSuccessHandler(displayShipmentList).ShipmentGetStoredData();\n}\n\nfunction displayShipmentList(shipments) {\n  if (!Array.isArray(shipments) || shipments.length \u003d\u003d\u003d 0) {\n    console.error(\u0027Invalid or empty shipments data:\u0027, shipments);\n    return;\n  }\n\n  shipments.reverse();\n\n  var listHtml \u003d \u0027\u003cdiv class\u003d\"container\"\u003e\u003ctable\u003e\u0027;\n  listHtml +\u003d \u0027\u003ctr\u003e\u003cth\u003eShipment No\u003c/th\u003e\u003cth\u003ePO No\u003c/th\u003e\u003cth\u003eContainer Number\u003c/th\u003e\u003cth\u003eETA\u003c/th\u003e\u003cth\u003eTrucking By\u003c/th\u003e\u003cth\u003eUnloading Date\u003c/th\u003e\u003cth\u003eUnloaded By\u003c/th\u003e\u003cth\u003eAction\u003c/th\u003e\u003c/tr\u003e\u0027;\n  for (var i \u003d 0; i \u003c shipments.length; i++) {\n    listHtml +\u003d \u0027\u003ctr\u003e\u0027;\n    for (var j \u003d 0; j \u003c 7; j++) {\n      var value \u003d shipments[i][j] || \u0027\u0027;\n      if (j \u003d\u003d\u003d 3) { // ETA Date\n        if (value instanceof Date) {\n          value \u003d Utilities.formatDate(value, Session.getScriptTimeZone(), \"dd/MM/yyyy\");\n        }\n      }\n      if (j \u003d\u003d\u003d 4 || j \u003d\u003d\u003d 5 || j \u003d\u003d\u003d 6) {\n        if (value) {\n            listHtml +\u003d \u0027\u003ctd\u003e\u0027 + value + \u0027\u003c/td\u003e\u0027;\n        } else {\n            listHtml +\u003d \u0027\u003ctd style\u003d\"padding: 0;\"\u003e\u0027; // Remove padding from cell\n            listHtml +\u003d \u0027\u003cinput type\u003d\"text\" class\u003d\"table-input-field\" style\u003d\"width: 80%; height: 100%;\" value\u003d\"\" \u0027 +\n                       \u0027data-shipment\u003d\"\u0027 + shipments[i][0] + \u0027\" data-field\u003d\"\u0027 + j + \u0027\"\u003e\u0027;\n            listHtml +\u003d \u0027\u003c/td\u003e\u0027;\n        }\n  \n      } else {\n        listHtml +\u003d \u0027\u003ctd\u003e\u0027 + value + \u0027\u003c/td\u003e\u0027;\n      }\n    }\n    listHtml +\u003d \u0027\u003ctd\u003e\u0027;\n    listHtml +\u003d \u0027\u003cbutton class\u003d\"view-btn\" onclick\u003d\"viewShipment(\\\u0027\u0027 + shipments[i][0] + \u0027\\\u0027, \\\u0027\u0027 + shipments[i][1] + \u0027\\\u0027)\"\u003eView\u003c/button\u003e \u0027;\n    var buttonText \u003d (shipments[i][4] || shipments[i][5] || shipments[i][6]) ? \u0027Edit\u0027 : \u0027Save\u0027;\n    listHtml +\u003d \u0027\u003cbutton class\u003d\"edit-btn\" onclick\u003d\"editOrSaveShipment(\\\u0027\u0027 + shipments[i][0] + \u0027\\\u0027, this)\"\u003e\u0027 + buttonText + \u0027\u003c/button\u003e\u0027;\n    listHtml +\u003d \u0027\u003c/td\u003e\u003c/tr\u003e\u0027;\n  }\n  listHtml +\u003d \u0027\u003c/table\u003e\u003c/div\u003e\u0027;\n  document.getElementById(\u0027shipmentList\u0027).innerHTML \u003d listHtml;\n}\n\nfunction editOrSaveShipment(shipmentNo, button) {\n    var row \u003d button.closest(\u0027tr\u0027);\n    var truckingByCell \u003d row.cells[4];\n    var unloadingDateCell \u003d row.cells[5];\n    var unloadedByCell \u003d row.cells[6]; // Add unloadedBy cell\n    \n    if (button.textContent \u003d\u003d\u003d \u0027Edit\u0027) {\n        // Make cells editable\n        makeEditable(truckingByCell);\n        makeEditable(unloadingDateCell);\n        makeEditable(unloadedByCell); // Make unloadedBy editable\n        button.textContent \u003d \u0027Save\u0027;\n    } else if (button.textContent \u003d\u003d\u003d \u0027Save\u0027) {\n        // Save the data\n        var truckingBy \u003d truckingByCell.querySelector(\u0027input\u0027) ? truckingByCell.querySelector(\u0027input\u0027).value : truckingByCell.textContent;\n        var unloadingDate \u003d unloadingDateCell.querySelector(\u0027input\u0027) ? unloadingDateCell.querySelector(\u0027input\u0027).value : unloadingDateCell.textContent;\n        var unloadedBy \u003d unloadedByCell.querySelector(\u0027input\u0027) ? unloadedByCell.querySelector(\u0027input\u0027).value : unloadedByCell.textContent;\n        \n        var data \u003d {\n            shipmentNo: shipmentNo,\n            truckingBy: truckingBy,\n            unloadingDate: unloadingDate,\n            unloadedBy: unloadedBy // Add unloadedBy to data object\n        };\n        \n        google.script.run.withSuccessHandler(function() {\n            loadShipmentList();\n        }).ShipmentUpdateData(data);\n    }\n}\n\nfunction makeEditable(cell) {\n    cell.style.padding \u003d \u00270\u0027;  // Remove cell padding\n    var currentValue \u003d cell.textContent.trim();\n    var input \u003d document.createElement(\u0027input\u0027);\n    input.type \u003d \u0027text\u0027;\n    input.value \u003d currentValue;\n    input.className \u003d \u0027table-input-field\u0027;\n    input.style.width \u003d \u002780%\u0027;  // Force 100% width\n    input.style.height \u003d \u002780%\u0027; // Force 100% height\n    cell.textContent \u003d \u0027\u0027;\n    cell.appendChild(input);\n    input.focus();  // Automatically focus the input\n}\nfunction viewShipment(shipmentNo, poNo) {\n    var tabContainer \u003d document.querySelector(\u0027.tab-container\u0027);\n    var existingTab \u003d document.getElementById(\u0027tab-\u0027 + shipmentNo);\n    \n    if (existingTab) {\n        activateTab(existingTab, \u0027shipmentDetails-\u0027 + shipmentNo);\n        return;\n    }\n\n    var newTab \u003d document.createElement(\u0027div\u0027);\n    newTab.className \u003d \u0027tab\u0027;\n    newTab.id \u003d \u0027tab-\u0027 + shipmentNo;\n    newTab.innerHTML \u003d \u0027\u003cspan class\u003d\"tab-text\"\u003e\u0027 + shipmentNo + \u0027\u003c/span\u003e\u0027 +\n                       \u0027\u003cspan class\u003d\"close-tab\" onclick\u003d\"closeTab(event, \\\u0027\u0027 + shipmentNo + \u0027\\\u0027)\"\u003e×\u003c/span\u003e\u0027;\n\n    newTab.onclick \u003d function(event) { \n        if (!event.target.classList.contains(\u0027close-tab\u0027)) {\n            activateTab(this, \u0027shipmentDetails-\u0027 + shipmentNo); \n        }\n    };\n\n    var newContent \u003d document.createElement(\u0027div\u0027);\n    newContent.id \u003d \u0027shipmentDetails-\u0027 + shipmentNo;\n    newContent.className \u003d \u0027tab-content\u0027;\n\n    tabContainer.appendChild(newTab);\n    document.querySelector(\u0027main\u0027).appendChild(newContent);\n\n    activateTab(newTab, \u0027shipmentDetails-\u0027 + shipmentNo);\n\n    google.script.run.withSuccessHandler(function(data) {\n        displayShipmentDetails(data, shipmentNo, poNo);\n    }).ShipmentGetShipmentDetails(shipmentNo);\n}\n\nfunction closeTab(event, shipmentNo) {\n    event.stopPropagation();\n    var tab \u003d document.getElementById(\u0027tab-\u0027 + shipmentNo);\n    var content \u003d document.getElementById(\u0027shipmentDetails-\u0027 + shipmentNo);\n    \n    if (tab \u0026\u0026 content) {\n        tab.remove();\n        content.remove();\n    }\n\n    if (tab.classList.contains(\u0027active\u0027)) {\n        var shipmentListTab \u003d document.querySelector(\u0027.tab-container .tab\u0027);\n        activateTab(shipmentListTab, \u0027shipmentListSection\u0027);\n    }\n}\n\nfunction displayShipmentDetails(data, shipmentNo, poNo) {\n    var contentDiv \u003d document.getElementById(\u0027shipmentDetails-\u0027 + shipmentNo);\n    \n    if (!data) {\n        contentDiv.innerHTML \u003d \"Shipment not found\";\n        return;\n    }\n\n    var tableHtml \u003d \u0027\u003ch2\u003e\u0027 + shipmentNo + \u0027 (\u0027 + poNo + \u0027)\u003c/h2\u003e\u0027;\n    \n    tableHtml +\u003d \u0027\u003ctable id\u003d\"detailsTable-\u0027 + shipmentNo + \u0027\"\u003e\u0027;\n    for (var i \u003d 0; i \u003c data.length; i++) {\n        tableHtml +\u003d \u0027\u003ctr\u003e\u0027;\n        for (var j \u003d 0; j \u003c data[i].length; j++) {\n            tableHtml +\u003d \u0027\u003ctd\u003e\u0027 + (data[i][j] || \u0027\u0027) + \u0027\u003c/td\u003e\u0027;\n        }\n        tableHtml +\u003d \u0027\u003c/tr\u003e\u0027;\n    }\n    tableHtml +\u003d \u0027\u003c/table\u003e\u0027;\n    contentDiv.innerHTML \u003d tableHtml;\n}\n\nfunction uploadShipmentFile() {\n    var form \u003d document.getElementById(\u0027uploadForm\u0027);\n    google.script.run.withSuccessHandler(function(result) {\n        loadShipmentList();\n        alert(\u0027File uploaded successfully\u0027);\n    }).withFailureHandler(function(error) {\n        alert(\u0027Error: \u0027 + error.message);\n    }).ShipmentProcessExcelFile(form);\n}\n\nfunction showShipmentEntryForm() {\n    document.getElementById(\u0027shipmentEntryForm\u0027).style.display \u003d \u0027block\u0027;\n    loadProductList();\n}\n\nfunction loadProductList() {\n    google.script.run.withSuccessHandler(function(products) {\n        var select \u003d document.getElementById(\u0027productSelector\u0027);\n        select.innerHTML \u003d \u0027\u003coption value\u003d\"\"\u003eSelect a product\u003c/option\u003e\u0027;\n        products.forEach(function(product) {\n            var option \u003d document.createElement(\u0027option\u0027);\n            option.value \u003d JSON.stringify(product);\n            option.textContent \u003d product.description;\n            select.appendChild(option);\n        });\n    }).getProductList();\n}\n\nfunction addProductToTable() {\n    var select \u003d document.getElementById(\u0027productSelector\u0027);\n    var selectedProduct \u003d JSON.parse(select.value);\n    var tableBody \u003d document.getElementById(\u0027productTableBody\u0027);\n    \n    var newRow \u003d tableBody.insertRow();\n    newRow.innerHTML \u003d `\n        \u003ctd\u003e${selectedProduct.itemCode}\u003c/td\u003e\n        \u003ctd\u003e${selectedProduct.description}\u003c/td\u003e\n        \u003ctd\u003e${selectedProduct.packingSize}\u003c/td\u003e\n        \u003ctd\u003e\u003cinput type\u003d\"number\" class\u003d\"quantity\" required\u003e\u003c/td\u003e\n    `;\n    \n    select.value \u003d \"\"; // Reset the selector\n}\n\n\n\nfunction submitShipmentEntry() {\n    var form \u003d document.forms[\u0027shipmentEntryForm\u0027];\n    var productTable \u003d document.getElementById(\u0027productTableBody\u0027);\n    var products \u003d [];\n    \n    for (var i \u003d 0; i \u003c productTable.rows.length; i++) {\n        var row \u003d productTable.rows[i];\n        products.push({\n    itemCode: row.cells[0].textContent,\n            description: row.cells[1].textContent,\n            packingSize: row.cells[2].textContent,\n            quantity: row.cells[3].querySelector(\u0027input\u0027).value\n        });\n    }\n    \n    var formData \u003d {\n        shipmentNo: form.shipmentNo.value,\n        po: form.po.value,\n        containerNo: form.containerNo.value,\n        eta: form.eta.value,\n        truckingBy: form.truckingBy.value,\n        unloadDate: form.unloadDate.value,\n        products: products\n    };\n\n    if (!formData.shipmentNo || !formData.containerNo || !formData.eta) {\n        alert(\u0027Please fill all required fields\u0027);\n        return;\n    }\n\n    google.script.run\n        .withSuccessHandler(function(result) {\n            alert(\u0027Shipment entry submitted successfully\u0027);\n            form.reset();\n            document.getElementById(\u0027productTableBody\u0027).innerHTML \u003d \u0027\u0027;\n            document.getElementById(\u0027shipmentEntryForm\u0027).style.display \u003d \u0027none\u0027;\n            loadShipmentList();\n        })\n        .withFailureHandler(function(error) {\n            alert(\u0027Error: \u0027 + error.message);\n        })\n        .submitShipmentEntry(formData);\n}\n\ndocument.addEventListener(\u0027DOMContentLoaded\u0027, loadShipmentList);\n    \u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e"},{"id":"aeeb39b5-0401-4ae1-8b9f-dfbacfc98b92","name":"Shipmentgs","type":"server_js","source":"const SHEET_ID \u003d \u00271485ut13dOQHzyosLWs7afhWVCve6asyeGSB0RI6vv4E\u0027;\n\nfunction ShipmentProcessExcelFile(formObject) {\n  if (!formObject || !formObject.shipmentFileInput) {\n    console.log(\"No file uploaded or formObject is invalid\");\n    return null;\n  }\n  \n  var fileBlob \u003d formObject.shipmentFileInput;\n  if (!fileBlob) {\n    throw new Error(\"No file uploaded\");\n  }\n  \n  var content \u003d fileBlob.getBytes();\n  var workbook \u003d XLSX.read(content, {type: \u0027array\u0027});\n  var sheetName \u003d workbook.SheetNames[0];\n  var sheet \u003d workbook.Sheets[sheetName];\n  var dataArray \u003d XLSX.utils.sheet_to_json(sheet, {header: 1});\n  \n  var data \u003d {\n    shipmentNo: getValueFromArray(dataArray, 1, 0),  // A2\n    poNo: getValueFromArray(dataArray, 4, 0),        // A5\n    containerNumber: getValueFromArray(dataArray, 1, 5),  // F2\n    eta: getValueFromArray(dataArray, 3, 5),         // F4\n    listData: getListDataUntilTotal(dataArray.slice(5))  // 从A6开始，只处理到F列\n  };\n  \n  ShipmentSaveDataToSheet(data);\n  return data;\n}\n\nfunction getValueFromArray(dataArray, row, col) {\n  if (dataArray[row] \u0026\u0026 dataArray[row][col] !\u003d\u003d undefined) {\n    return dataArray[row][col].toString();\n  }\n  return \"\";\n}\n\nfunction getListDataUntilTotal(data) {\n  var result \u003d [];\n  for (var i \u003d 0; i \u003c data.length; i++) {\n    // 修改点：只提取前6列(A-F列)\n    var row \u003d data[i].slice(0, 6);\n    row \u003d ensureRowLength(row, 6);\n    row \u003d formatColumnE(row);\n    \n    if (isTotalInColumnC(row)) {\n      console.log(`Stopped at row ${i + 6} (\u0027total\u0027 detected in column C)`);\n      break;\n    }\n    result.push(row);\n  }\n  console.log(`Retrieved ${result.length} rows of data`);\n  return result;\n}\n\n\nfunction ensureRowLength(row, minLength) {\n  while (row.length \u003c minLength) {\n    row.push(\"\");  // Add empty strings for missing columns\n  }\n  return row;\n}\n\nfunction formatColumnE(row) {\n  // Format column E (index 4) as text with leading zeros\n  if (row.length \u003e 4 \u0026\u0026 row[4] !\u003d\u003d \"\") {\n    var value \u003d String(row[4]).replace(/^\u0027/, \u0027\u0027).padStart(8, \u00270\u0027);\n    row[4] \u003d \"\u0027\" + value;  // Add a single quote to force text format\n  }\n  return row;\n}\n\nfunction isTotalInColumnC(row) {\n  // Check if the cell in column C (index 2) contains \u0027total\u0027\n  var cellValue \u003d row[2];\n  if (cellValue \u003d\u003d\u003d undefined || cellValue \u003d\u003d\u003d null || cellValue \u003d\u003d\u003d \"\") {\n    return false;\n  }\n  return String(cellValue).toLowerCase().includes(\u0027total\u0027);\n}\n\nfunction ShipmentSaveDataToSheet(data) {\n  console.log(\"Data received:\", JSON.stringify(data));\n  console.log(\"List data length:\", data.listData.length);\n  console.log(\"List data first row:\", JSON.stringify(data.listData[0]));\n  var ss \u003d SpreadsheetApp.openById(SHEET_ID);\n  var shipmentListSheet \u003d ss.getSheetByName(\"Shipment List\");\n  \n  // Append row with available data\n  var newRow \u003d [\n    data.shipmentNo || \"\",\n    data.poNo || \"\",\n    data.containerNumber || \"\",\n    data.eta || \"\"\n  ];\n  \n  try {\n    shipmentListSheet.appendRow(newRow);\n  } catch (error) {\n    console.error(\"Error appending row to Shipment List:\", error.message);\n  }\n  \n  // Create or get sheet for this shipment\u0027s table data\n  var tableSheet \u003d ss.getSheetByName(data.shipmentNo) || ss.insertSheet(data.shipmentNo);\n  tableSheet.clear();\n  \n  // Write table data\n  if (data.listData \u0026\u0026 data.listData.length \u003e 0) {\n    try {\n      var numColumns \u003d data.listData[0].length;\n      tableSheet.getRange(1, 1, data.listData.length, numColumns).setValues(data.listData);\n    } catch (error) {\n      console.error(\"Error writing table data:\", error.message);\n    }\n  }\n  \n  console.log(\"ShipmentSaveDataToSheet completed\");\n}\n\nfunction ShipmentGetStoredData() {\n  var ss \u003d SpreadsheetApp.openById(SHEET_ID);\n  var shipmentListSheet \u003d ss.getSheetByName(\"Shipment List\");\n\n  var lastRow \u003d shipmentListSheet.getLastRow();\n  var shipments \u003d shipmentListSheet.getRange(2, 1, Math.max(lastRow - 1, 1), 7).getValues(); // Changed to 7 columns\n\n  // Ensure each row has 7 columns and format the date\n  shipments \u003d shipments.map(row \u003d\u003e {\n    while (row.length \u003c 7) { // Changed to 7 columns\n      row.push(\"\");\n    }\n    // Format ETA date\n    if (row[3] instanceof Date) {\n      row[3] \u003d Utilities.formatDate(row[3], Session.getScriptTimeZone(), \"dd/MM/yyyy\");\n    } else if (typeof row[3] \u003d\u003d\u003d \u0027string\u0027) {\n      try {\n        var parsedDate \u003d parseDate(row[3]);\n        row[3] \u003d Utilities.formatDate(parsedDate, Session.getScriptTimeZone(), \"dd/MM/yyyy\");\n      } catch (e) {\n        console.log(\"Failed to parse date: \" + row[3]);\n      }\n    }\n    return row;\n  });\n\n  shipmentListSheet.getRange(2, 4, lastRow - 1, 1).setNumberFormat(\"DD/MM/YYYY\");\n\n  return shipments;\n}\n\nfunction parseDate(dateString) {\n  const [day, month, year] \u003d dateString.split(\u0027/\u0027);\n  return new Date(year, month - 1, day);\n}\n\nfunction ShipmentUpdateData(data) {\n  var ss \u003d SpreadsheetApp.openById(SHEET_ID);\n  var shipmentListSheet \u003d ss.getSheetByName(\"Shipment List\");\n  \n  var dataRange \u003d shipmentListSheet.getDataRange();\n  var values \u003d dataRange.getValues();\n  \n  for (var i \u003d 1; i \u003c values.length; i++) {\n    if (values[i][0] \u003d\u003d\u003d data.shipmentNo) {\n      shipmentListSheet.getRange(i + 1, 5).setValue(data.truckingBy);\n      shipmentListSheet.getRange(i + 1, 6).setValue(data.unloadingDate.toString());\n      shipmentListSheet.getRange(i + 1, 7).setValue(data.unloadedBy); // Add unloadedBy\n      \n      // Set format to plain text for all editable fields\n      shipmentListSheet.getRange(i + 1, 5, 1, 3).setNumberFormat(\u0027@STRING@\u0027);\n      break;\n    }\n  }\n  \n  return true;\n}\nfunction ShipmentGetShipmentDetails(shipmentNo) {\n  var ss \u003d SpreadsheetApp.openById(SHEET_ID);\n  var sheet \u003d ss.getSheetByName(shipmentNo);\n  \n  if (!sheet) {\n    return null;\n  }\n  \n  var data \u003d sheet.getDataRange().getValues();\n  return data;\n}\n\n\n\nfunction getProductList() {\n  var ss \u003d SpreadsheetApp.openById(\u00271HkPIjBIwxylJlMp1LfGDVw597EjIQ1SgknZ-ymyk57Y\u0027);\n  var sheet \u003d ss.getSheetByName(\u0027Surimi List\u0027);\n  var data \u003d sheet.getRange(\u0027A2:C\u0027 + sheet.getLastRow()).getValues();\n  \n  return data.map(function(row) {\n    return {\n      itemCode: row[0],\n      description: row[1],\n      packingSize: row[2]\n    };\n  });\n}\n\n\nfunction submitShipmentEntry(formData) {\n  var ss \u003d SpreadsheetApp.openById(\u00271485ut13dOQHzyosLWs7afhWVCve6asyeGSB0RI6vv4E\u0027);\n  var shipmentListSheet \u003d ss.getSheetByName(\u0027Shipment List\u0027);\n  \n  // Format dates to DD/MM/YYYY\n  var formatDate \u003d function(dateString) {\n    var date \u003d new Date(dateString);\n    return Utilities.formatDate(date, Session.getScriptTimeZone(), \"dd/MM/yyyy\");\n  };\n\n  // Prepare shipment details\n  var shipmentRow \u003d [\n    formData.shipmentNo,\n    formData.po,\n    formData.containerNo,\n    formatDate(formData.eta),\n    formData.truckingBy,\n    formatDate(formData.unloadDate) // Format unloadDate as DD/MM/YYYY\n  ];\n  \n  // Append shipment details to the \u0027Shipment List\u0027 sheet\n  shipmentListSheet.appendRow(shipmentRow);\n  \n  // Get the last row added to the sheet\n  var lastRow \u003d shipmentListSheet.getLastRow();\n  \n  // Set the format of the unload date cell to plain text\n  shipmentListSheet.getRange(lastRow, 6).setNumberFormat(\u0027@STRING@\u0027);\n  \n  // Create a new sheet for the product table\n  var newSheet \u003d ss.insertSheet(formData.shipmentNo);\n  \n  // Add header row to the new sheet\n  var headerRow \u003d [\u0027Item Code\u0027, \u0027Product Description\u0027, \u0027Packing\u0027, \u0027Quantity\u0027];\n  newSheet.getRange(1, 1, 1, headerRow.length).setValues([headerRow]);\n  \n  // Add product data to the new sheet\n  var productData \u003d formData.products.map(function(product) {\n    return [\n      product.itemCode,\n      product.description,\n      product.packingSize,\n      product.quantity\n    ];\n  });\n  \n  if (productData.length \u003e 0) {\n    newSheet.getRange(2, 1, productData.length, productData[0].length).setValues(productData);\n  }\n  \n  // Auto-resize columns for better readability\n  newSheet.autoResizeColumns(1, 4);\n  \n  return true;\n}\n"},{"id":"6586f3f3-f228-4c01-bf96-6e7171b74a23","name":"TempGS","type":"server_js","source":"function getTempRecordData() {\n  var ss \u003d SpreadsheetApp.openById(\u002715jj7ZQgL1fIPsHr-kl3s2Quy7TrLsjQ-sjV4-lcus8o\u0027);\n  var sheet \u003d ss.getSheetByName(\u0027Coldroom Temp Rcd\u0027);\n  var data \u003d sheet.getDataRange().getValues();\n  \n  // Remove header row\n  data.shift();\n  \n  // Group data by date and coldroom\n  var groupedTempData \u003d groupTempDataByDateAndColdroom(data);\n  \n  // Generate HTML table\n  var html \u003d generateTempRecordTable(groupedTempData);\n  \n  return html;\n}\n\nfunction groupTempDataByDateAndColdroom(data) {\n  var groupedData \u003d {};\n  data.forEach(function(row) {\n    var coldroom \u003d row[0];\n    var date \u003d Utilities.formatDate(new Date(row[1]), Session.getScriptTimeZone(), \u0027dd/MM/yyyy\u0027);\n    var time \u003d Utilities.formatDate(new Date(row[2]), Session.getScriptTimeZone(), \u0027HH:mm\u0027);\n    var temp \u003d row[3];\n    var checkBy \u003d row[4];\n    \n    // Parse the time and add 39 minutes\n    var timeDate \u003d new Date(\u00271970-01-01T\u0027 + time + \u0027:00\u0027);\n    timeDate.setMinutes(timeDate.getMinutes() + 39);\n    var newTime \u003d Utilities.formatDate(timeDate, Session.getScriptTimeZone(), \u0027HH:mm\u0027);\n    \n    if (!groupedData[date]) {\n      groupedData[date] \u003d {};\n    }\n    if (!groupedData[date][coldroom]) {\n      groupedData[date][coldroom] \u003d [];\n    }\n    groupedData[date][coldroom].push({time: newTime, temp: temp, checkBy: checkBy});\n  });\n\n  // Sort entries by time for each date and coldroom\n  Object.keys(groupedData).forEach(function(date) {\n    Object.keys(groupedData[date]).forEach(function(coldroom) {\n      groupedData[date][coldroom].sort(function(a, b) {\n        return a.time.localeCompare(b.time);\n      });\n    });\n  });\n\n  // Create a new object with sorted dates in descending order\n  var sortedGroupedData \u003d {};\n  Object.keys(groupedData).sort(function(a, b) {\n    return new Date(b.split(\u0027/\u0027).reverse().join(\u0027-\u0027)) - new Date(a.split(\u0027/\u0027).reverse().join(\u0027-\u0027));\n  }).forEach(function(date) {\n    sortedGroupedData[date] \u003d groupedData[date];\n  });\n\n  return sortedGroupedData;\n}\n\nfunction generateTempRecordTable(groupedTempData) {\n  var html \u003d \u0027\u003cdiv class\u003d\"table-container\"\u003e\u003ctable border\u003d\"1\"\u003e\u0027;\n  var coldrooms \u003d [\n    \u0027Blk 15\u0027, \u0027Blk 15 Chiller\u0027, \u0027Coldroom 6\u0027, \u0027Coldroom 6 Chiller\u0027, \u0027Coldroom 5c Chiller\u0027,\n    \u0027Coldroom 5 - 1\u0027, \u0027Coldroom 5 - 2\u0027, \u0027Coldroom 3B Chiller\u0027, \u0027Coldroom 3A Chiller\u0027,\n    \u0027Coldroom 3 Chiller\u0027, \u0027Coldroom 2\u0027, \u0027Coldroom 1\u0027\n  ];\n  \n  html +\u003d \u0027\u003cthead\u003e\u003ctr\u003e\u003cth class\u003d\"sticky-col\"\u003eDate\u003c/th\u003e\u0027;\n  coldrooms.forEach(function(coldroom, index) {\n    html +\u003d \u0027\u003cth colspan\u003d\"3\" class\u003d\"coldroom-header\"\u003e\u0027 + coldroom + \u0027\u003c/th\u003e\u0027;\n    if (index \u003c coldrooms.length - 1) {\n      html +\u003d \u0027\u003cth class\u003d\"padding-column\"\u003e\u003c/th\u003e\u0027;\n    }\n  });\n  html +\u003d \u0027\u003c/tr\u003e\u0027;\n  \n  html +\u003d \u0027\u003ctr\u003e\u003cth class\u003d\"sticky-col\"\u003e\u003c/th\u003e\u0027;\n  coldrooms.forEach(function(_, index) {\n    html +\u003d \u0027\u003cth\u003eTime\u003c/th\u003e\u003cth\u003eTemp\u003c/th\u003e\u003cth\u003eCheck By\u003c/th\u003e\u0027;\n    if (index \u003c coldrooms.length - 1) {\n      html +\u003d \u0027\u003cth class\u003d\"padding-column\"\u003e\u003c/th\u003e\u0027;\n    }\n  });\n  html +\u003d \u0027\u003c/tr\u003e\u003c/thead\u003e\u0027;\n  \n  html +\u003d \u0027\u003ctbody\u003e\u0027;\n  // This is the amended part for correct date sorting\n  var dates \u003d Object.keys(groupedTempData).sort(function(a, b) {\n    var dateA \u003d a.split(\u0027/\u0027).reverse().join(\u0027-\u0027);\n    var dateB \u003d b.split(\u0027/\u0027).reverse().join(\u0027-\u0027);\n    return new Date(dateB) - new Date(dateA);\n  });\n  \n  dates.forEach(function(date, dateIndex) {\n    var maxEntries \u003d 1;\n    coldrooms.forEach(function(coldroom) {\n      if (groupedTempData[date][coldroom]) {\n        maxEntries \u003d Math.max(maxEntries, groupedTempData[date][coldroom].length);\n      }\n    });\n    \n    for (var i \u003d 0; i \u003c maxEntries; i++) {\n      html +\u003d \u0027\u003ctr\u0027 + (i \u003d\u003d\u003d maxEntries - 1 ? \u0027 class\u003d\"last-row-in-date\"\u0027 : \u0027\u0027) + \u0027\u003e\u0027;\n      if (i \u003d\u003d\u003d 0) {\n        html +\u003d \u0027\u003ctd class\u003d\"sticky-col\" rowspan\u003d\"\u0027 + maxEntries + \u0027\"\u003e\u0027 + date + \u0027\u003c/td\u003e\u0027;\n      }\n      coldrooms.forEach(function(coldroom, index) {\n        if (groupedTempData[date][coldroom] \u0026\u0026 groupedTempData[date][coldroom][i]) {\n          var entry \u003d groupedTempData[date][coldroom][i];\n          html +\u003d \u0027\u003ctd\u003e\u0027 + entry.time + \u0027\u003c/td\u003e\u003ctd\u003e\u0027 + entry.temp + \u0027\u003c/td\u003e\u003ctd\u003e\u0027 + entry.checkBy + \u0027\u003c/td\u003e\u0027;\n        } else {\n          html +\u003d \u0027\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003e\u003c/td\u003e\u0027;\n        }\n        if (index \u003c coldrooms.length - 1) {\n          html +\u003d \u0027\u003ctd class\u003d\"padding-column\"\u003e\u003c/td\u003e\u0027;\n        }\n      });\n      html +\u003d \u0027\u003c/tr\u003e\u0027;\n    }\n    \n    // Add padding row between dates, except after the last date\n    if (dateIndex \u003c dates.length - 1) {\n      html +\u003d \u0027\u003ctr class\u003d\"date-padding-row\"\u003e\u003ctd colspan\u003d\"\u0027 + (coldrooms.length * 4) + \u0027\"\u003e\u003c/td\u003e\u003c/tr\u003e\u0027;\n    }\n  });\n  \n  html +\u003d \u0027\u003c/tbody\u003e\u003c/table\u003e\u003c/div\u003e\u0027;\n  return html;\n}"},{"id":"b0623ff2-689b-42e4-ab1a-47b0a4cb47e8","name":"TempRcd","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n    \u003c?!\u003d include(\u0027CSS\u0027); ?\u003e\n\n\u003cstyle\u003e\n  .table-container {\n    max-height: 650px;\n    overflow-y: auto;\n    overflow-x: auto;\n    cursor: grab;\n  }\n\n  .table-container:active {\n    cursor: grabbing;\n  }\n\n  table {\n    border-collapse: separate;\n    border-spacing: 0;\n    width: 100%;\n    user-select: none;\n  }\n\n  th, td {\n    padding: 8px;\n    text-align: left;\n    border: 1px solid #ddd;\n  }\n\n  th {\n    background-color: #f2f2f2;\n    position: sticky;\n    top: 0;\n    z-index: 10;\n  }\n\n  .sticky-col {\n    position: sticky;\n    left: 0;\n    background-color: #f2f2f2;\n    z-index: 11;\n  }\n\n  tbody tr:nth-child(even) {\n    background-color: #f9f9f9;\n  }\n\n  .coldroom-header {\n    padding-left: 50px;\n    padding-right: 50px;\n    background-color: #e6f2ff;\n    font-weight: bold;\n  }\n\n  .padding-column {\n    width: 20px;\n    border: none;\n    background-color: transparent;\n    border-right: 1px solid #ddd;\n  }\n\n  thead tr:nth-child(2) th {\n    position: sticky;\n    top: 38px;\n    background-color: #f2f2f2;\n    z-index: 10;\n  }\n\n  thead {\n    position: sticky;\n    top: 0;\n    z-index: 20;\n  }\n\n  thead tr:first-child th {\n    position: sticky;\n    top: 0;\n    z-index: 21;\n  }\n\n  tbody tr:hover {\n  background-color: #e6f7ff; /* Light blue color for hover */\n}\n.loader-container {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        min-height: 200px;\n      }\n\n      .loader {\n        width: 48px;\n        height: 48px;\n        border: 5px solid #f3f3f3;\n        border-radius: 50%;\n        border-top: 5px solid #3498db;\n        animation: spin 1s linear infinite;\n      }\n\n      @keyframes spin {\n        0% { transform: rotate(0deg); }\n        100% { transform: rotate(360deg); }\n      }\n\n      .hidden {\n        display: none;\n      }\n\n\u003c/style\u003e\n\n  \u003c/head\u003e\n  \u003cbody onload\u003d\"loadTempRecordData()\"\u003e\n\n    \u003cheader\u003e\n        \u003ch1\u003eInventory Management System\u003c/h1\u003e\n    \u003c/header\u003e\n        {{NAVBAR}}\n  \u003cmain\u003e\n    \u003ch2\u003eColdroom Temperature Record\u003c/h2\u003e\n    \u003cdiv id\u003d\"tempRecordTable\"\u003e\u003c/div\u003e\n     \u003cdiv id\u003d\"loader\" class\u003d\"loader-container\"\u003e\n        \u003cdiv class\u003d\"loader\"\u003e\u003c/div\u003e\n      \u003c/div\u003e\n  \u003c/main\u003e\n\n\u003cscript\u003e\n    function loadTempRecordData() {\n        // Show loader, hide table\n        document.getElementById(\u0027loader\u0027).classList.remove(\u0027hidden\u0027);\n        document.getElementById(\u0027tempRecordTable\u0027).classList.add(\u0027hidden\u0027);\n\n        google.script.run\n          .withSuccessHandler(function(data) {\n            updateTempTable(data);\n            initStickyHeader();\n            initDragToScroll();\n            \n            // Hide loader, show table\n            document.getElementById(\u0027loader\u0027).classList.add(\u0027hidden\u0027);\n            document.getElementById(\u0027tempRecordTable\u0027).classList.remove(\u0027hidden\u0027);\n          })\n          .withFailureHandler(function(error) {\n            // Handle errors\n            document.getElementById(\u0027loader\u0027).classList.add(\u0027hidden\u0027);\n            document.getElementById(\u0027tempRecordTable\u0027).innerHTML \u003d \n              \u0027\u003cdiv class\u003d\"error-message\"\u003eError loading data. Please try again.\u003c/div\u003e\u0027;\n            document.getElementById(\u0027tempRecordTable\u0027).classList.remove(\u0027hidden\u0027);\n          })\n          .getTempRecordData();\n      }\n\n    function updateTempTable(data) {\n      document.getElementById(\u0027tempRecordTable\u0027).innerHTML \u003d data;\n      \n      var rows \u003d document.querySelectorAll(\u0027tr\u0027);\n      rows.forEach(function(row) {\n        var firstCell \u003d row.querySelector(\u0027th:first-child, td:first-child\u0027);\n        if (firstCell) {\n          firstCell.classList.add(\u0027date-column\u0027);\n        }\n      });\n    }\n\n    function handleScroll() {\n      var container \u003d document.querySelector(\u0027.table-container\u0027);\n      var stickyElements \u003d document.querySelectorAll(\u0027.sticky-col:not(.date-column), .sticky-coldroom\u0027);\n      var scrollLeft \u003d container.scrollLeft;\n\n      stickyElements.forEach(function(el) {\n        el.style.transform \u003d \u0027translateX(\u0027 + scrollLeft + \u0027px)\u0027;\n      });\n    }\n\n    function initStickyHeader() {\n      var container \u003d document.querySelector(\u0027.table-container\u0027);\n      if (container) {\n        container.addEventListener(\u0027scroll\u0027, handleScroll);\n      }\n    }\n\n    function initDragToScroll() {\n      var container \u003d document.querySelector(\u0027.table-container\u0027);\n      var isMouseDown \u003d false;\n      var startX, scrollLeft;\n\n      container.addEventListener(\u0027mousedown\u0027, function(e) {\n        isMouseDown \u003d true;\n        startX \u003d e.pageX - container.offsetLeft;\n        scrollLeft \u003d container.scrollLeft;\n        container.style.cursor \u003d \u0027grabbing\u0027;\n      });\n\n      container.addEventListener(\u0027mouseleave\u0027, function() {\n        isMouseDown \u003d false;\n        container.style.cursor \u003d \u0027grab\u0027;\n      });\n\n      container.addEventListener(\u0027mouseup\u0027, function() {\n        isMouseDown \u003d false;\n        container.style.cursor \u003d \u0027grab\u0027;\n      });\n\n      container.addEventListener(\u0027mousemove\u0027, function(e) {\n        if (!isMouseDown) return;\n        e.preventDefault();\n        var x \u003d e.pageX - container.offsetLeft;\n        var walk \u003d (x - startX) * 2; // Adjust scrolling speed\n        container.scrollLeft \u003d scrollLeft - walk;\n      });\n    }\n\u003c/script\u003e   \n    \u003cfooter\u003e\n        \u003cp\u003e\u0026copy; 2024 Inventory Management System\u003c/p\u003e\n    \u003c/footer\u003e\n\u003c/body\u003e\n \n\u003c/html\u003e"},{"id":"9bd54f00-470d-45cd-aa6f-960472bce154","name":"TempRcdScrpit","type":"html","source":""},{"id":"630d3f1e-c85c-4c5c-b1a3-0877e51bfd5a","name":"Transaction","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n    \u003c?!\u003d include(\u0027CSS\u0027); ?\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n\n\n    \u003cheader\u003e\n        \u003ch1\u003eInventory Management System\u003c/h1\u003e\n    \u003c/header\u003e\n        {{NAVBAR}}\n  \u003cbody\u003e\n    \n  \u003c/body\u003e\n\n      \u003cfooter\u003e\n        \u003cp\u003e\u0026copy; 2024 Inventory Management System\u003c/p\u003e\n    \u003c/footer\u003e\n\u003c/html\u003e\n"}]}